import{r,j as e}from"./vendor-react-BuVtq312.js";import{u as x,t as g,C as m,z as p,A as C,E as h,a as b,G as B,B as j}from"./index-hzFfJlKH.js";import{O as Q,aD as f}from"./vendor-icons-CPPAmKDz.js";import"./vendor-data-DopHG4T0.js";import"./vendor-radix-DQBG9U-J.js";function I(){const[,l]=x(),[s,a]=r.useState("loading"),[u,c]=r.useState(""),k=g.quickbooks.handleCallback.useMutation({onSuccess:()=>{a("success"),setTimeout(()=>l("/settings"),2e3)},onError:t=>{a("error"),c(t.message)}});return r.useEffect(()=>{const t=new URLSearchParams(window.location.search),n=t.get("code"),i=t.get("realmId"),o=t.get("error"),d=localStorage.getItem("qb_oauth_state");if(o){a("error"),c(o==="access_denied"?"You denied access to QuickBooks":`QuickBooks error: ${o}`);return}if(!n||!i){a("error"),c("Missing authorization code or realm ID");return}if(!d){a("error"),c("Invalid session state. Please try connecting again.");return}localStorage.removeItem("qb_oauth_state"),k.mutate({code:n,realmId:i,state:d})},[]),e.jsx("div",{"data-loc":"client/src/pages/QuickBooksCallback.tsx:65",className:"min-h-screen flex items-center justify-center bg-background p-4",children:e.jsxs(m,{"data-loc":"client/src/pages/QuickBooksCallback.tsx:66",className:"w-full max-w-md",children:[e.jsxs(p,{"data-loc":"client/src/pages/QuickBooksCallback.tsx:67",className:"text-center",children:[e.jsx(C,{"data-loc":"client/src/pages/QuickBooksCallback.tsx:68",children:s==="loading"?"Connecting to QuickBooks...":s==="success"?"Connected!":"Connection Failed"}),e.jsx(h,{"data-loc":"client/src/pages/QuickBooksCallback.tsx:75",children:s==="loading"?"Please wait while we complete the connection":s==="success"?"Your QuickBooks account has been connected":"There was a problem connecting your account"})]}),e.jsxs(b,{"data-loc":"client/src/pages/QuickBooksCallback.tsx:83",className:"flex flex-col items-center gap-4",children:[s==="loading"&&e.jsx("div",{"data-loc":"client/src/pages/QuickBooksCallback.tsx:85",className:"opacity-70",children:e.jsx(B,{"data-loc":"client/src/pages/QuickBooksCallback.tsx:86",size:"sm"})}),s==="success"&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{"data-loc":"client/src/pages/QuickBooksCallback.tsx:91",className:"h-12 w-12 text-green-600"}),e.jsx("p",{"data-loc":"client/src/pages/QuickBooksCallback.tsx:92",className:"text-sm text-muted-foreground",children:"Redirecting to settings..."})]}),s==="error"&&e.jsxs(e.Fragment,{children:[e.jsx(f,{"data-loc":"client/src/pages/QuickBooksCallback.tsx:99",className:"h-12 w-12 text-destructive"}),e.jsx("p",{"data-loc":"client/src/pages/QuickBooksCallback.tsx:100",className:"text-sm text-destructive text-center",children:u}),e.jsx(j,{"data-loc":"client/src/pages/QuickBooksCallback.tsx:103",onClick:()=>l("/settings"),children:"Back to Settings"})]})]})]})})}export{I as default};
