import{r as l,j as e}from"./vendor-react-BuVtq312.js";import{D as ve,e as Be,f as je,h as Ie,i as fe,l as ye,I as X,n as Ne,B as x,b as _e,u as Je,w as Ke,t as u,G as Ze,g as et,C as A,a as F,L as O,z as Y,A as W,E as pe,j as me,k as h}from"./index-hzFfJlKH.js";import{L as v}from"./label-DJDGx5UM.js";import{T as Te}from"./textarea-CA7ezKjn.js";import{S as U,a as R,b as M,c as $,d as r}from"./select-BmfPitD4.js";import{N as ge}from"./Navigation-DKoTJDrW.js";import{C as ae}from"./typography-CdqW54LS.js";import{L as z,U as tt,z as ue,aQ as at,am as st,aq as ct,aD as lt,a1 as nt,X as it,a2 as ot,a8 as rt,d as dt}from"./vendor-icons-CPPAmKDz.js";import{U as ht}from"./UpgradeDialog-B7ES_VUA.js";import"./vendor-data-DopHG4T0.js";import"./vendor-radix-DQBG9U-J.js";import"./UserAvatar-DzPpP9tb.js";import"./vendor-date-B2OJh1lx.js";import"./subscription-B5lMhqL4.js";function xt({open:w,onOpenChange:d,onSave:b,lineItems:B,dueInDays:I,notes:p,isLoading:j=!1}){const[i,n]=l.useState(""),[f,L]=l.useState(""),[y,q]=l.useState("monthly"),N=async()=>{i.trim()&&(await b({name:i.trim(),description:f.trim(),frequency:y}),n(""),L(""),q("monthly"))},D=B.filter(m=>m.description&&m.rate>0);return e.jsx(ve,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:75",open:w,onOpenChange:d,children:e.jsxs(Be,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:76",className:"sm:max-w-[500px]",children:[e.jsxs(je,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:77",children:[e.jsx(Ie,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:78",children:"Save as Template"}),e.jsx(fe,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:79",children:"Save this batch configuration as a reusable template for future invoicing."})]}),e.jsxs(ye,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:85",children:[e.jsxs("div",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:86",className:"space-y-2",children:[e.jsx(v,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:87",htmlFor:"template-name",children:"Template Name *"}),e.jsx(X,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:88",id:"template-name",value:i,onChange:m=>n(m.target.value),placeholder:"e.g., Monthly Retainer, Quarterly Consulting"})]}),e.jsxs("div",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:96",className:"space-y-2",children:[e.jsx(v,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:97",htmlFor:"template-description",children:"Description (optional)"}),e.jsx(Te,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:98",id:"template-description",value:f,onChange:m=>L(m.target.value),placeholder:"Brief description of what this template is for",rows:2})]}),e.jsxs("div",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:107",className:"space-y-2",children:[e.jsx(v,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:108",htmlFor:"frequency",children:"Billing Frequency"}),e.jsxs(U,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:109",value:y,onValueChange:m=>q(m),children:[e.jsx(R,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:113",id:"frequency",children:e.jsx(M,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:114"})}),e.jsxs($,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:116",children:[e.jsx(r,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:117",value:"one-time",children:"One-time"}),e.jsx(r,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:118",value:"weekly",children:"Weekly"}),e.jsx(r,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:119",value:"monthly",children:"Monthly"}),e.jsx(r,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:120",value:"quarterly",children:"Quarterly"}),e.jsx(r,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:121",value:"yearly",children:"Yearly"})]})]})]}),e.jsxs("div",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:126",className:"rounded-lg border p-3 bg-muted/50",children:[e.jsx("p",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:127",className:"text-sm font-medium mb-2",children:"Template will include:"}),e.jsxs("ul",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:128",className:"text-sm text-muted-foreground space-y-1",children:[e.jsxs("li",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:129",children:["• ",D.length," line item",D.length!==1?"s":""]}),e.jsxs("li",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:133",children:["• Due in ",I," days"]}),p&&e.jsxs("li",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:135",children:['• Notes: "',p.substring(0,50),p.length>50?"...":"",'"']})]})]})]}),e.jsx(Ne,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:144",onClose:()=>d(!1),onSubmit:N,submitText:"Save Template",cancelText:"Cancel",isLoading:j,disabled:!i.trim()})]})})}function pt({open:w,onOpenChange:d,templates:b,onLoad:B,onDelete:I,isLoading:p=!1,deletingId:j=null}){const i={"one-time":"One-time",weekly:"Weekly",monthly:"Monthly",quarterly:"Quarterly",yearly:"Yearly"};return e.jsx(ve,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:195",open:w,onOpenChange:d,children:e.jsxs(Be,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:196",className:"sm:max-w-[600px]",children:[e.jsxs(je,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:197",children:[e.jsx(Ie,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:198",children:"Load Template"}),e.jsx(fe,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:199",children:"Select a saved template to populate the batch invoice form."})]}),e.jsx(ye,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:204",children:p?e.jsx("div",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:206",className:"flex items-center justify-center py-8",children:e.jsx(z,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:207",className:"h-6 w-6 animate-spin text-muted-foreground"})}):b.length===0?e.jsxs("div",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:210",className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:211",children:"No saved templates yet."}),e.jsx("p",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:212",className:"text-sm mt-1",children:"Create a batch invoice and save it as a template to get started."})]}):e.jsx("div",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:217",className:"space-y-2 max-h-[400px] overflow-y-auto",children:b.map(n=>e.jsxs("div",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:219",className:"flex items-center justify-between p-3 rounded-lg border hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:223",className:"flex-1 min-w-0",children:[e.jsxs("div",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:224",className:"flex items-center gap-2",children:[e.jsx("p",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:225",className:"font-medium truncate",children:n.name}),e.jsx("span",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:226",className:"text-xs px-2 py-0.5 rounded-full bg-primary/10 text-primary",children:i[n.frequency]})]}),n.description&&e.jsx("p",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:231",className:"text-sm text-muted-foreground truncate",children:n.description}),e.jsxs("p",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:235",className:"text-xs text-muted-foreground mt-1",children:["Due in ",n.dueInDays," days • Used"," ",n.usageCount," time",n.usageCount!==1?"s":""]})]}),e.jsxs("div",{"data-loc":"client/src/components/BatchTemplateDialog.tsx:241",className:"flex items-center gap-2 ml-4",children:[e.jsx(x,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:242",variant:"ghost",size:"sm",onClick:()=>I(n.id),disabled:j===n.id,className:"text-destructive hover:text-destructive",children:j===n.id?e.jsx(z,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:250",className:"h-4 w-4 animate-spin"}):"Delete"}),e.jsx(x,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:255",size:"sm",onClick:()=>{B(n.id),d(!1)},children:"Load"})]})]},n.id))})}),e.jsx(Ne,{"data-loc":"client/src/components/BatchTemplateDialog.tsx:271",onClose:()=>d(!1),cancelText:"Cancel"})]})})}function Lt(){const{loading:w,isAuthenticated:d}=_e();Je();const B=new URLSearchParams(Ke()).get("clients"),I=l.useMemo(()=>B?B.split(",").map(t=>parseInt(t)).filter(t=>!isNaN(t)):[],[B]),[p,j]=l.useState(I);l.useEffect(()=>{j(I)},[I]);const[i,n]=l.useState([{id:"1",description:"",quantity:1,rate:0}]),[f,L]=l.useState(30),[y,q]=l.useState(""),[N,D]=l.useState(null),[m,mt]=l.useState(!1),[se,De]=l.useState("draft"),[Q,ce]=l.useState(!1),[Ce,k]=l.useState([]),[Se,le]=l.useState(!1),[we,_]=l.useState(!1),[be,ne]=l.useState(!1),[Le,ie]=l.useState(!1),[qe,oe]=l.useState(null),[P,J]=l.useState(null),[ke,re]=l.useState(!1),[gt,Ae]=l.useState(0),{data:K}=u.clients.list.useQuery(void 0,{enabled:d}),{data:C}=u.templates.list.useQuery(void 0,{enabled:d}),{data:Z}=u.clients.listTags.useQuery(void 0,{enabled:d}),{data:Fe,refetch:de}=u.batchTemplates.list.useQuery(void 0,{enabled:d}),{data:S,isLoading:he}=u.clients.getClientsByTag.useQuery({tagId:P},{enabled:d&&P!==null}),Ue=u.invoices.create.useMutation(),Re=u.batchTemplates.create.useMutation(),Me=u.batchTemplates.delete.useMutation();u.batchTemplates.incrementUsage.useMutation();const $e=u.useUtils(),V={currency:"USD",taxRate:0},o=l.useMemo(()=>K?K.filter(t=>p.includes(t.id)):[],[K,p]),xe=l.useMemo(()=>i.reduce((t,a)=>t+a.quantity*a.rate,0),[i]),ze=xe*o.length;l.useEffect(()=>{if(C&&C.length>0&&!N){const t=C.find(a=>a.isDefault);D(t?.id||C[0].id)}},[C,N]);const Qe=()=>{n([...i,{id:Date.now().toString(),description:"",quantity:1,rate:0}])},Pe=t=>{i.length>1&&n(i.filter(a=>a.id!==t))},ee=(t,a,s)=>{n(i.map(c=>c.id===t?{...c,[a]:s}:c))},Ve=t=>{const a=new Date().getFullYear(),s=Date.now().toString().slice(-4);return`INV-${a}-BATCH-${s}-${(t+1).toString().padStart(3,"0")}`},Ee=t=>{if(t==="none"){J(null);return}J(parseInt(t))},Ge=()=>{if(!S||S.length===0)return;const t=S.map(c=>c.id),a=Array.from(new Set([...p,...t]));j(a);const s=a.length-p.length;s>0?h.success(`Added ${s} client${s!==1?"s":""} from tag`):h.info("All clients with this tag are already selected"),J(null)},He=t=>{j(p.filter(a=>a!==t))},Oe=async t=>{ie(!0);try{await Re.mutateAsync({name:t.name,description:t.description||void 0,frequency:t.frequency,dueInDays:f,notes:y||void 0,invoiceTemplateId:N||void 0,lineItems:i.filter(a=>a.description&&a.rate>0).map(a=>({description:a.description,quantity:a.quantity.toString(),rate:a.rate.toString()}))}),await de(),_(!1),h.success("Template saved successfully")}catch(a){const s=a;h.error(s.message||"Failed to save template")}finally{ie(!1)}},Ye=async t=>{try{const a=await $e.batchTemplates.get.fetch({id:t});if(!a){h.error("Template not found");return}const{template:s,lineItems:c}=a;L(s.dueInDays),q(s.notes||""),s.invoiceTemplateId&&D(s.invoiceTemplateId),c.length>0&&n(c.map((T,E)=>({id:`loaded-${E}-${Date.now()}`,description:T.description,quantity:parseFloat(T.quantity),rate:parseFloat(T.rate)}))),Ae(T=>T+1),h.success("Template loaded successfully")}catch(a){const s=a;h.error(s.message||"Failed to load template")}},We=async t=>{oe(t);try{await Me.mutateAsync({id:t}),await de(),h.success("Template deleted")}catch(a){const s=a;h.error(s.message||"Failed to delete template")}finally{oe(null)}},Xe=async()=>{if(o.length===0){h.error("No clients selected");return}if(i.every(c=>!c.description||c.rate===0)){h.error("Please add at least one line item with description and rate");return}ce(!0),le(!0);const t=o.map(c=>({clientId:c.id,clientName:c.name,status:"pending"}));k(t);const a=[...t];for(let c=0;c<o.length;c++){const T=o[c],E=Ve(c);try{const te=new Date,G=new Date;G.setDate(G.getDate()+f),await Ue.mutateAsync({clientId:T.id,invoiceNumber:E,issueDate:te,dueDate:G,status:m?"sent":se,notes:y,templateId:N||void 0,lineItems:i.filter(g=>g.description&&g.rate>0).map(g=>({description:g.description,quantity:g.quantity,rate:g.rate})),taxRate:V?.taxRate||0,discountType:"percentage",discountValue:0}),a[c]={...a[c],status:"success",invoiceNumber:E},k([...a])}catch(te){const g=te.message||"Failed to create invoice";if(g.includes("Monthly invoice limit reached")||g.includes("invoice limit")){re(!0);for(let H=c;H<o.length;H++)a[H]={...a[H],status:"error",error:"Invoice limit reached. Please upgrade to Pro."};k([...a]);break}a[c]={...a[c],status:"error",error:g},k([...a])}}ce(!1);const s=a.filter(c=>c.status==="success").length;s===o.length?h.success(`Successfully created ${s} invoices`):h.warning(`Created ${s} of ${o.length} invoices`)};return w?e.jsx("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:452",className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:453",className:"opacity-70",children:e.jsx(Ze,{"data-loc":"client/src/pages/BatchInvoice.tsx:454",size:"md"})})}):d?p.length===0&&!B?e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:468",className:"min-h-screen bg-background",children:[e.jsx(ge,{"data-loc":"client/src/pages/BatchInvoice.tsx:469"}),e.jsx("main",{"data-loc":"client/src/pages/BatchInvoice.tsx:470",className:"container mx-auto px-4 py-8 max-w-4xl",children:e.jsx(A,{"data-loc":"client/src/pages/BatchInvoice.tsx:471",children:e.jsxs(F,{"data-loc":"client/src/pages/BatchInvoice.tsx:472",className:"py-12 text-center",children:[e.jsx(tt,{"data-loc":"client/src/pages/BatchInvoice.tsx:473",className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h2",{"data-loc":"client/src/pages/BatchInvoice.tsx:474",className:"text-xl font-semibold mb-2",children:"No Clients Selected"}),e.jsx("p",{"data-loc":"client/src/pages/BatchInvoice.tsx:477",className:"text-muted-foreground mb-4",children:"Select clients from the Clients page to create batch invoices, or use tags to quickly select groups of clients."}),e.jsx("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:481",className:"flex gap-3 justify-center",children:e.jsx(O,{"data-loc":"client/src/pages/BatchInvoice.tsx:482",href:"/clients",children:e.jsxs(x,{"data-loc":"client/src/pages/BatchInvoice.tsx:483",children:[e.jsx(ue,{"data-loc":"client/src/pages/BatchInvoice.tsx:484",className:"h-4 w-4 mr-2"}),"Go to Clients"]})})})]})})})]}):e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:497",className:"min-h-screen bg-background",children:[e.jsx(ge,{"data-loc":"client/src/pages/BatchInvoice.tsx:498"}),e.jsxs("main",{"data-loc":"client/src/pages/BatchInvoice.tsx:499",className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:501",className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:502",className:"flex items-center gap-4",children:[e.jsx(O,{"data-loc":"client/src/pages/BatchInvoice.tsx:503",href:"/clients",children:e.jsx(x,{"data-loc":"client/src/pages/BatchInvoice.tsx:504",variant:"ghost",size:"icon","aria-label":"Go back to clients",children:e.jsx(ue,{"data-loc":"client/src/pages/BatchInvoice.tsx:505",className:"h-5 w-5"})})}),e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:508",children:[e.jsx("h1",{"data-loc":"client/src/pages/BatchInvoice.tsx:509",className:"text-2xl font-bold",children:"Create Batch Invoices"}),e.jsxs("p",{"data-loc":"client/src/pages/BatchInvoice.tsx:510",className:"text-muted-foreground",children:["Create invoices for ",o.length," selected client",o.length!==1?"s":""]})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:518",className:"flex gap-2",children:[e.jsxs(x,{"data-loc":"client/src/pages/BatchInvoice.tsx:519",variant:"outline",size:"sm",onClick:()=>ne(!0),children:[e.jsx(at,{"data-loc":"client/src/pages/BatchInvoice.tsx:524",className:"h-4 w-4 mr-2"}),"Load Template"]}),e.jsxs(x,{"data-loc":"client/src/pages/BatchInvoice.tsx:527",variant:"outline",size:"sm",onClick:()=>_(!0),children:[e.jsx(st,{"data-loc":"client/src/pages/BatchInvoice.tsx:532",className:"h-4 w-4 mr-2"}),"Save Template"]})]})]}),Se?e.jsxs(A,{"data-loc":"client/src/pages/BatchInvoice.tsx:540",children:[e.jsxs(Y,{"data-loc":"client/src/pages/BatchInvoice.tsx:541",children:[e.jsx(W,{"data-loc":"client/src/pages/BatchInvoice.tsx:542",children:"Batch Creation Results"}),e.jsx(pe,{"data-loc":"client/src/pages/BatchInvoice.tsx:543",children:Q?"Creating invoices...":"Invoice creation complete"})]}),e.jsxs(F,{"data-loc":"client/src/pages/BatchInvoice.tsx:549",children:[e.jsx("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:550",className:"space-y-3",children:Ce.map(t=>e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:552",className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:556",className:"flex items-center gap-3",children:[t.status==="pending"&&e.jsx(z,{"data-loc":"client/src/pages/BatchInvoice.tsx:558",className:"h-5 w-5 animate-spin text-muted-foreground"}),t.status==="success"&&e.jsx(ct,{"data-loc":"client/src/pages/BatchInvoice.tsx:561",className:"h-5 w-5 text-green-500"}),t.status==="error"&&e.jsx(lt,{"data-loc":"client/src/pages/BatchInvoice.tsx:564",className:"h-5 w-5 text-destructive"}),e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:566",children:[e.jsx("p",{"data-loc":"client/src/pages/BatchInvoice.tsx:567",className:"font-medium",children:t.clientName}),t.invoiceNumber&&e.jsx("p",{"data-loc":"client/src/pages/BatchInvoice.tsx:569",className:"text-sm text-muted-foreground",children:t.invoiceNumber}),t.error&&e.jsx("p",{"data-loc":"client/src/pages/BatchInvoice.tsx:574",className:"text-sm text-destructive",children:t.error})]})]}),e.jsx(me,{"data-loc":"client/src/pages/BatchInvoice.tsx:580",variant:t.status==="success"?"default":t.status==="error"?"destructive":"secondary",children:t.status==="pending"?"Creating...":t.status==="success"?"Created":"Failed"})]},t.clientId))}),!Q&&e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:600",className:"flex gap-3 mt-6",children:[e.jsx(O,{"data-loc":"client/src/pages/BatchInvoice.tsx:601",href:"/invoices",children:e.jsx(x,{"data-loc":"client/src/pages/BatchInvoice.tsx:602",children:"View All Invoices"})}),e.jsx(x,{"data-loc":"client/src/pages/BatchInvoice.tsx:604",variant:"outline",onClick:()=>{le(!1),k([])},children:"Create More"})]})]})]}):e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:619",className:"space-y-6",children:[e.jsxs(A,{"data-loc":"client/src/pages/BatchInvoice.tsx:621",children:[e.jsx(Y,{"data-loc":"client/src/pages/BatchInvoice.tsx:622",children:e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:623",className:"flex items-center justify-between",children:[e.jsx(W,{"data-loc":"client/src/pages/BatchInvoice.tsx:624",className:"text-lg",children:"Selected Clients"}),Z&&Z.length>0&&e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:628",className:"flex items-center gap-2",children:[e.jsxs(U,{"data-loc":"client/src/pages/BatchInvoice.tsx:629",value:P?.toString()||"none",onValueChange:Ee,children:[e.jsxs(R,{"data-loc":"client/src/pages/BatchInvoice.tsx:633",className:"w-full sm:w-[180px]",children:[e.jsx(nt,{"data-loc":"client/src/pages/BatchInvoice.tsx:634",className:"h-4 w-4 mr-2"}),e.jsx(M,{"data-loc":"client/src/pages/BatchInvoice.tsx:635",placeholder:"Add by tag"})]}),e.jsxs($,{"data-loc":"client/src/pages/BatchInvoice.tsx:637",children:[e.jsx(r,{"data-loc":"client/src/pages/BatchInvoice.tsx:638",value:"none",children:"Select a tag..."}),Z.map(t=>e.jsx(r,{"data-loc":"client/src/pages/BatchInvoice.tsx:640",value:t.id.toString(),children:e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:641",className:"flex items-center gap-2",children:[e.jsx("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:642",className:"w-3 h-3 rounded-full",style:{backgroundColor:t.color}}),t.name]})},t.id))]})]}),P&&e.jsx(x,{"data-loc":"client/src/pages/BatchInvoice.tsx:654",size:"sm",onClick:Ge,disabled:he||!S?.length,children:he?e.jsx(z,{"data-loc":"client/src/pages/BatchInvoice.tsx:662",className:"h-4 w-4 animate-spin"}):e.jsxs(e.Fragment,{children:["Add ",S?.length||0," Client",(S?.length||0)!==1?"s":""]})})]})]})}),e.jsxs(F,{"data-loc":"client/src/pages/BatchInvoice.tsx:675",children:[e.jsx("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:676",className:"flex flex-wrap gap-2",children:o.map(t=>e.jsxs(me,{"data-loc":"client/src/pages/BatchInvoice.tsx:678",variant:"secondary",className:"text-sm pr-1 flex items-center gap-1",children:[t.name,e.jsx("button",{"data-loc":"client/src/pages/BatchInvoice.tsx:684",onClick:()=>He(t.id),className:"ml-1 hover:bg-muted rounded-full p-0.5",children:e.jsx(it,{"data-loc":"client/src/pages/BatchInvoice.tsx:688",className:"h-3 w-3"})})]},t.id))}),o.length===0&&e.jsx("p",{"data-loc":"client/src/pages/BatchInvoice.tsx:694",className:"text-sm text-muted-foreground",children:"No clients selected. Use the tag filter above to add clients."})]})]}),e.jsxs(A,{"data-loc":"client/src/pages/BatchInvoice.tsx:703",children:[e.jsxs(Y,{"data-loc":"client/src/pages/BatchInvoice.tsx:704",children:[e.jsx(W,{"data-loc":"client/src/pages/BatchInvoice.tsx:705",className:"text-lg",children:"Line Items"}),e.jsxs(pe,{"data-loc":"client/src/pages/BatchInvoice.tsx:706",children:["These items will be added to all ",o.length," ","invoices"]})]}),e.jsxs(F,{"data-loc":"client/src/pages/BatchInvoice.tsx:711",className:"space-y-4",children:[i.map((t,a)=>e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:713",className:"grid grid-cols-12 gap-3 items-end",children:[e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:717",className:"col-span-5",children:[a===0&&e.jsx(v,{"data-loc":"client/src/pages/BatchInvoice.tsx:719",className:"text-xs text-muted-foreground",children:"Description"}),e.jsx(X,{"data-loc":"client/src/pages/BatchInvoice.tsx:723",value:t.description,onChange:s=>ee(t.id,"description",s.target.value),placeholder:"Service or product description"})]}),e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:731",className:"col-span-2",children:[a===0&&e.jsx(v,{"data-loc":"client/src/pages/BatchInvoice.tsx:733",className:"text-xs text-muted-foreground",children:"Qty"}),e.jsx(X,{"data-loc":"client/src/pages/BatchInvoice.tsx:737",type:"number",min:"1",value:t.quantity,onChange:s=>ee(t.id,"quantity",parseInt(s.target.value)||1)})]}),e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:750",className:"col-span-3",children:[a===0&&e.jsx(v,{"data-loc":"client/src/pages/BatchInvoice.tsx:752",className:"text-xs text-muted-foreground",children:"Rate"}),e.jsx(X,{"data-loc":"client/src/pages/BatchInvoice.tsx:756",type:"number",min:"0",step:"0.01",value:t.rate,onChange:s=>ee(t.id,"rate",parseFloat(s.target.value)||0),placeholder:"0.00"})]}),e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:771",className:"col-span-2 flex items-center justify-between",children:[e.jsx("span",{"data-loc":"client/src/pages/BatchInvoice.tsx:772",className:"text-sm font-medium",children:e.jsx(ae,{"data-loc":"client/src/pages/BatchInvoice.tsx:773",amount:t.quantity*t.rate,currency:V?.currency})}),i.length>1&&e.jsx(x,{"data-loc":"client/src/pages/BatchInvoice.tsx:779",variant:"ghost",size:"icon",onClick:()=>Pe(t.id),className:"h-8 w-8","aria-label":`Remove line item: ${t.description||"Item "+(a+1)}`,children:e.jsx(ot,{"data-loc":"client/src/pages/BatchInvoice.tsx:786",className:"h-4 w-4"})})]})]},t.id)),e.jsxs(x,{"data-loc":"client/src/pages/BatchInvoice.tsx:793",variant:"outline",onClick:Qe,className:"w-full","aria-label":"Add new line item",children:[e.jsx(rt,{"data-loc":"client/src/pages/BatchInvoice.tsx:799",className:"h-4 w-4 mr-2"}),"Add Line Item"]}),e.jsx("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:803",className:"flex justify-end pt-4 border-t",children:e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:804",className:"text-right",children:[e.jsx("p",{"data-loc":"client/src/pages/BatchInvoice.tsx:805",className:"text-sm text-muted-foreground",children:"Per Invoice Total"}),e.jsx("p",{"data-loc":"client/src/pages/BatchInvoice.tsx:808",className:"text-xl font-bold",children:e.jsx(ae,{"data-loc":"client/src/pages/BatchInvoice.tsx:809",amount:xe,currency:V?.currency})}),e.jsxs("p",{"data-loc":"client/src/pages/BatchInvoice.tsx:814",className:"text-sm text-muted-foreground mt-2",children:["Total for ",o.length," invoices:"," ",e.jsx("span",{"data-loc":"client/src/pages/BatchInvoice.tsx:816",className:"font-semibold text-foreground",children:e.jsx(ae,{"data-loc":"client/src/pages/BatchInvoice.tsx:817",amount:ze,currency:V?.currency})})]})]})})]})]}),e.jsxs(A,{"data-loc":"client/src/pages/BatchInvoice.tsx:829",children:[e.jsx(Y,{"data-loc":"client/src/pages/BatchInvoice.tsx:830",children:e.jsx(W,{"data-loc":"client/src/pages/BatchInvoice.tsx:831",className:"text-lg",children:"Invoice Settings"})}),e.jsxs(F,{"data-loc":"client/src/pages/BatchInvoice.tsx:833",className:"space-y-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:834",className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:835",className:"space-y-2",children:[e.jsx(v,{"data-loc":"client/src/pages/BatchInvoice.tsx:836",children:"Due In"}),e.jsxs(U,{"data-loc":"client/src/pages/BatchInvoice.tsx:837",value:f.toString(),onValueChange:t=>L(parseInt(t)),children:[e.jsx(R,{"data-loc":"client/src/pages/BatchInvoice.tsx:841",children:e.jsx(M,{"data-loc":"client/src/pages/BatchInvoice.tsx:842"})}),e.jsxs($,{"data-loc":"client/src/pages/BatchInvoice.tsx:844",children:[e.jsx(r,{"data-loc":"client/src/pages/BatchInvoice.tsx:845",value:"7",children:"7 days"}),e.jsx(r,{"data-loc":"client/src/pages/BatchInvoice.tsx:846",value:"14",children:"14 days"}),e.jsx(r,{"data-loc":"client/src/pages/BatchInvoice.tsx:847",value:"30",children:"30 days"}),e.jsx(r,{"data-loc":"client/src/pages/BatchInvoice.tsx:848",value:"45",children:"45 days"}),e.jsx(r,{"data-loc":"client/src/pages/BatchInvoice.tsx:849",value:"60",children:"60 days"}),e.jsx(r,{"data-loc":"client/src/pages/BatchInvoice.tsx:850",value:"90",children:"90 days"})]})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:855",className:"space-y-2",children:[e.jsx(v,{"data-loc":"client/src/pages/BatchInvoice.tsx:856",children:"Template"}),e.jsxs(U,{"data-loc":"client/src/pages/BatchInvoice.tsx:857",value:N?.toString()||"",onValueChange:t=>D(parseInt(t)),children:[e.jsx(R,{"data-loc":"client/src/pages/BatchInvoice.tsx:861",children:e.jsx(M,{"data-loc":"client/src/pages/BatchInvoice.tsx:862",placeholder:"Select template"})}),e.jsx($,{"data-loc":"client/src/pages/BatchInvoice.tsx:864",children:C?.map(t=>e.jsxs(r,{"data-loc":"client/src/pages/BatchInvoice.tsx:866",value:t.id.toString(),children:[t.name," ",t.isDefault&&"(Default)"]},t.id))})]})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:878",className:"space-y-2",children:[e.jsx(v,{"data-loc":"client/src/pages/BatchInvoice.tsx:879",children:"Status"}),e.jsxs(U,{"data-loc":"client/src/pages/BatchInvoice.tsx:880",value:se,onValueChange:t=>De(t),children:[e.jsx(R,{"data-loc":"client/src/pages/BatchInvoice.tsx:884",children:e.jsx(M,{"data-loc":"client/src/pages/BatchInvoice.tsx:885"})}),e.jsxs($,{"data-loc":"client/src/pages/BatchInvoice.tsx:887",children:[e.jsx(r,{"data-loc":"client/src/pages/BatchInvoice.tsx:888",value:"draft",children:"Draft"}),e.jsx(r,{"data-loc":"client/src/pages/BatchInvoice.tsx:889",value:"sent",children:"Sent"})]})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:894",className:"space-y-2",children:[e.jsx(v,{"data-loc":"client/src/pages/BatchInvoice.tsx:895",children:"Notes (optional)"}),e.jsx(Te,{"data-loc":"client/src/pages/BatchInvoice.tsx:896",value:y,onChange:t=>q(t.target.value),placeholder:"Notes to include on all invoices",rows:3})]})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/BatchInvoice.tsx:907",className:"flex justify-end gap-3",children:[e.jsx(O,{"data-loc":"client/src/pages/BatchInvoice.tsx:908",href:"/clients",children:e.jsx(x,{"data-loc":"client/src/pages/BatchInvoice.tsx:909",variant:"outline",children:"Cancel"})}),e.jsx(x,{"data-loc":"client/src/pages/BatchInvoice.tsx:911",onClick:Xe,disabled:Q||o.length===0,children:Q?e.jsxs(e.Fragment,{children:[e.jsx(z,{"data-loc":"client/src/pages/BatchInvoice.tsx:917",className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(dt,{"data-loc":"client/src/pages/BatchInvoice.tsx:922",className:"h-4 w-4 mr-2"}),"Create ",o.length," Invoice",o.length!==1?"s":""]})})]})]})]}),e.jsx(xt,{"data-loc":"client/src/pages/BatchInvoice.tsx:934",open:we,onOpenChange:_,onSave:Oe,lineItems:i,dueInDays:f,notes:y,isLoading:Le}),e.jsx(pt,{"data-loc":"client/src/pages/BatchInvoice.tsx:944",open:be,onOpenChange:ne,templates:(Fe||[]).map(t=>({id:t.id,name:t.name,description:t.description,frequency:t.frequency,dueInDays:t.dueInDays,usageCount:t.usageCount,lastUsedAt:t.lastUsedAt})),onLoad:Ye,onDelete:We,deletingId:qe}),e.jsx(ht,{"data-loc":"client/src/pages/BatchInvoice.tsx:967",open:ke,onOpenChange:re,reason:"invoice_limit"})]}):(window.location.href=et(),null)}export{Lt as default};
