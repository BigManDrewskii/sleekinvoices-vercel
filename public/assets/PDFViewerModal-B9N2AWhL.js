var ta=a=>{throw TypeError(a)};var Or=(a,e,t)=>e.has(a)||ta("Cannot "+t);var bn=(a,e,t)=>(Or(a,e,"read from private field"),t?t.call(a):e.get(a)),li=(a,e,t)=>e.has(a)?ta("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t),Ei=(a,e,t,n)=>(Or(a,e,"write to private field"),n?n.call(a,t):e.set(a,t),t),Yi=(a,e,t)=>(Or(a,e,"access private method"),t);var na=(a,e,t,n)=>({set _(r){Ei(a,e,r,t)},get _(){return bn(a,e,n)}});import{g as Nl,d as Kt,f as Bl,r as Nr,j as St}from"./vendor-react-BuVtq312.js";import{D as zl,e as Hl,f as jl,h as Vl,i as Wl,l as $l}from"./index-hzFfJlKH.js";import{d as ia,L as Gl}from"./vendor-icons-CPPAmKDz.js";var Br={exports:{}},zr={},Fi={};Fi.d=(a,e)=>{for(var t in e)Fi.o(e,t)&&!Fi.o(a,t)&&Object.defineProperty(a,t,{enumerable:!0,get:e[t]})};Fi.o=(a,e)=>Object.prototype.hasOwnProperty.call(a,e);var Oe=globalThis.pdfjsLib={};Fi.d(Oe,{AbortException:()=>zn,AnnotationEditorLayer:()=>Tn,AnnotationEditorParamsType:()=>Xe,AnnotationEditorType:()=>ze,AnnotationEditorUIManager:()=>Hn,AnnotationLayer:()=>Hu,AnnotationMode:()=>Nn,ColorPicker:()=>mn,DOMSVGFactory:()=>Ls,DrawLayer:()=>tn,FeatureTest:()=>rn,GlobalWorkerOptions:()=>Ni,ImageKind:()=>rr,InvalidPDFException:()=>ps,MissingPDFException:()=>Bi,OPS:()=>_n,OutputScale:()=>gs,PDFDataRangeTransport:()=>Co,PDFDateString:()=>lo,PDFWorker:()=>fi,PasswordResponses:()=>Kl,PermissionFlag:()=>Xl,PixelsPerInch:()=>mi,RenderingCancelledException:()=>Ss,TextLayer:()=>nn,TouchManager:()=>mr,UnexpectedResponseException:()=>or,Util:()=>Ee,VerbosityLevel:()=>ur,XfaLayer:()=>ko,build:()=>wu,createValidAbsoluteUrl:()=>Ql,fetchData:()=>pr,getDocument:()=>hu,getFilenameFromUrl:()=>lc,getPdfFilenameFromUrl:()=>cc,getXfaPageViewport:()=>uc,isDataScheme:()=>gr,isPdfFile:()=>As,noContextMenu:()=>wn,normalizeUnicode:()=>sc,setLayerDimensions:()=>Yn,shadow:()=>We,stopEvent:()=>dn,version:()=>_u});const en=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),ao=[1,0,0,1,0,0],fs=[.001,0,0,.001,0,0],Ul=1e7,Hr=1.35,hn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Nn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},ql="pdfjs_internal_editor_",ze={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Xe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},Xl={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Jt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},rr={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},$t={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Si={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},ur={ERRORS:0,WARNINGS:1,INFOS:5},_n={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},Kl={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let hr=ur.WARNINGS;function Yl(a){Number.isInteger(a)&&(hr=a)}function Zl(){return hr}function dr(a){hr>=ur.INFOS&&console.log(`Info: ${a}`)}function He(a){hr>=ur.WARNINGS&&console.log(`Warning: ${a}`)}function dt(a){throw new Error(a)}function Vt(a,e){a||dt(e)}function Jl(a){switch(a?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Ql(a,e=null,t=null){if(!a)return null;try{if(t&&typeof a=="string"&&(t.addDefaultProtocol&&a.startsWith("www.")&&a.match(/\./g)?.length>=2&&(a=`http://${a}`),t.tryConvertEncoding))try{a=rc(a)}catch{}const n=e?new URL(a,e):new URL(a);if(Jl(n))return n}catch{}return null}function We(a,e,t,n=!1){return Object.defineProperty(a,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const jn=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class ra extends jn{constructor(e,t){super(e,"PasswordException"),this.code=t}}class jr extends jn{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class ps extends jn{constructor(e){super(e,"InvalidPDFException")}}class Bi extends jn{constructor(e){super(e,"MissingPDFException")}}class or extends jn{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class ec extends jn{constructor(e){super(e,"FormatError")}}class zn extends jn{constructor(e){super(e,"AbortException")}}function oo(a){(typeof a!="object"||a?.length===void 0)&&dt("Invalid argument for bytesToString");const e=a.length,t=8192;if(e<t)return String.fromCharCode.apply(null,a);const n=[];for(let r=0;r<e;r+=t){const i=Math.min(r+t,e),s=a.subarray(r,i);n.push(String.fromCharCode.apply(null,s))}return n.join("")}function fr(a){typeof a!="string"&&dt("Invalid argument for stringToBytes");const e=a.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=a.charCodeAt(n)&255;return t}function tc(a){return String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255)}function ys(a){const e=Object.create(null);for(const[t,n]of a)e[t]=n;return e}function nc(){const a=new Uint8Array(4);return a[0]=1,new Uint32Array(a.buffer,0,1)[0]===1}function ic(){try{return new Function(""),!0}catch{return!1}}class rn{static get isLittleEndian(){return We(this,"isLittleEndian",nc())}static get isEvalSupported(){return We(this,"isEvalSupported",ic())}static get isOffscreenCanvasSupported(){return We(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return We(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?We(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):We(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return We(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Vr=Array.from(Array(256).keys(),a=>a.toString(16).padStart(2,"0"));class Ee{static makeHexColor(e,t,n){return`#${Vr[e]}${Vr[t]}${Vr[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const n=e[0]*t[0]+e[1]*t[2]+t[4],r=e[0]*t[1]+e[1]*t[3]+t[5];return[n,r]}static applyInverseTransform(e,t){const n=t[0]*t[3]-t[1]*t[2],r=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,i=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n;return[r,i]}static getAxialAlignedBoundingBox(e,t){const n=this.applyTransform(e,t),r=this.applyTransform(e.slice(2,4),t),i=this.applyTransform([e[0],e[3]],t),s=this.applyTransform([e[2],e[1]],t);return[Math.min(n[0],r[0],i[0],s[0]),Math.min(n[1],r[1],i[1],s[1]),Math.max(n[0],r[0],i[0],s[0]),Math.max(n[1],r[1],i[1],s[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],r=e[0]*t[1]+e[1]*t[3],i=e[2]*t[0]+e[3]*t[2],s=e[2]*t[1]+e[3]*t[3],o=(n+s)/2,l=Math.sqrt((n+s)**2-4*(n*s-i*r))/2,u=o+l||1,c=o-l||1;return[Math.sqrt(u),Math.sqrt(c)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>r)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),s=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>s?null:[n,i,r,s]}static#e(e,t,n,r,i,s,o,l,u,c){if(u<=0||u>=1)return;const d=1-u,f=u*u,p=f*u,g=d*(d*(d*e+3*u*t)+3*f*n)+p*r,h=d*(d*(d*i+3*u*s)+3*f*o)+p*l;c[0]=Math.min(c[0],g),c[1]=Math.min(c[1],h),c[2]=Math.max(c[2],g),c[3]=Math.max(c[3],h)}static#t(e,t,n,r,i,s,o,l,u,c,d,f){if(Math.abs(u)<1e-12){Math.abs(c)>=1e-12&&this.#e(e,t,n,r,i,s,o,l,-d/c,f);return}const p=c**2-4*d*u;if(p<0)return;const g=Math.sqrt(p),h=2*u;this.#e(e,t,n,r,i,s,o,l,(-c+g)/h,f),this.#e(e,t,n,r,i,s,o,l,(-c-g)/h,f)}static bezierBoundingBox(e,t,n,r,i,s,o,l,u){return u?(u[0]=Math.min(u[0],e,o),u[1]=Math.min(u[1],t,l),u[2]=Math.max(u[2],e,o),u[3]=Math.max(u[3],t,l)):u=[Math.min(e,o),Math.min(t,l),Math.max(e,o),Math.max(t,l)],this.#t(e,n,i,o,t,r,s,l,3*(-e+3*(n-i)+o),6*(e-2*n+i),3*(n-e),u),this.#t(e,n,i,o,t,r,s,l,3*(-t+3*(r-s)+l),6*(t-2*r+s),3*(r-t),u),u}}function rc(a){return decodeURIComponent(escape(a))}let Wr=null,sa=null;function sc(a){return Wr||(Wr=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,sa=new Map([["ﬅ","ſt"]])),a.replaceAll(Wr,(e,t,n)=>t?t.normalize("NFKC"):sa.get(n))}function ac(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const a=new Uint8Array(32);return crypto.getRandomValues(a),oo(a)}const Es="pdfjs_internal_id_";function oc(a){return Uint8Array.prototype.toBase64?a.toBase64():btoa(oo(a))}typeof Promise.try!="function"&&(Promise.try=function(a,...e){return new Promise(t=>{t(a(...e))})});const Mn="http://www.w3.org/2000/svg";class mi{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function pr(a,e="text"){if(Ii(a,document.baseURI)){const t=await fetch(a);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const r=new XMLHttpRequest;r.open("GET",a,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}n(new Error(r.statusText))}},r.send(null)})}class Hi{constructor({viewBox:e,userUnit:t,scale:n,rotation:r,offsetX:i=0,offsetY:s=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=r,this.offsetX=i,this.offsetY=s,n*=t;const l=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let c,d,f,p;switch(r%=360,r<0&&(r+=360),r){case 180:c=-1,d=0,f=0,p=1;break;case 90:c=0,d=1,f=1,p=0;break;case 270:c=0,d=-1,f=-1,p=0;break;case 0:c=1,d=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(f=-f,p=-p);let g,h,v,b;c===0?(g=Math.abs(u-e[1])*n+i,h=Math.abs(l-e[0])*n+s,v=(e[3]-e[1])*n,b=(e[2]-e[0])*n):(g=Math.abs(l-e[0])*n+i,h=Math.abs(u-e[1])*n+s,v=(e[2]-e[0])*n,b=(e[3]-e[1])*n),this.transform=[c*n,d*n,f*n,p*n,g-c*n*l-f*n*u,h-d*n*l-p*n*u],this.width=v,this.height=b}get rawDims(){const{userUnit:e,viewBox:t}=this,n=t.map(r=>r*e);return We(this,"rawDims",{pageWidth:n[2]-n[0],pageHeight:n[3]-n[1],pageX:n[0],pageY:n[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:r=this.offsetY,dontFlip:i=!1}={}){return new Hi({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:i})}convertToViewportPoint(e,t){return Ee.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=Ee.applyTransform([e[0],e[1]],this.transform),n=Ee.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){return Ee.applyInverseTransform([e,t],this.transform)}}class Ss extends jn{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function gr(a){const e=a.length;let t=0;for(;t<e&&a[t].trim()==="";)t++;return a.substring(t,t+5).toLowerCase()==="data:"}function As(a){return typeof a=="string"&&/\.pdf$/i.test(a)}function lc(a){return[a]=a.split(/[#?]/,1),a.substring(a.lastIndexOf("/")+1)}function cc(a,e="document.pdf"){if(typeof a!="string")return e;if(gr(a))return He('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=t.exec(a);let i=n.exec(r[1])||n.exec(r[2])||n.exec(r[3]);if(i&&(i=i[0],i.includes("%")))try{i=n.exec(decodeURIComponent(i))[0]}catch{}return i||e}class aa{started=Object.create(null);times=[];time(e){e in this.started&&He(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||He(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:r,end:i}of this.times)e.push(`${n.padEnd(t)} ${i-r}ms
`);return e.join("")}}function Ii(a,e){try{const{protocol:t}=e?new URL(a,e):new URL(a);return t==="http:"||t==="https:"}catch{return!1}}function wn(a){a.preventDefault()}function dn(a){a.preventDefault(),a.stopPropagation()}class lo{static#e;static toDateObject(e){if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const n=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let s=parseInt(t[4],10);s=s>=0&&s<=23?s:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const u=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,u==="-"?(s+=c,o+=d):u==="+"&&(s-=c,o-=d),new Date(Date.UTC(n,r,i,s,o,l))}}function uc(a,{scale:e=1,rotation:t=0}){const{width:n,height:r}=a.attributes.style,i=[0,0,parseInt(n),parseInt(r)];return new Hi({viewBox:i,userUnit:1,scale:e,rotation:t})}function Cs(a){if(a.startsWith("#")){const e=parseInt(a.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return a.startsWith("rgb(")?a.slice(4,-1).split(",").map(e=>parseInt(e)):a.startsWith("rgba(")?a.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(He(`Not a valid color format: "${a}"`),[0,0,0])}function hc(a){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of a.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;a.set(t,Cs(n))}e.remove()}function Ct(a){const{a:e,b:t,c:n,d:r,e:i,f:s}=a.getTransform();return[e,t,n,r,i,s]}function Sn(a){const{a:e,b:t,c:n,d:r,e:i,f:s}=a.getTransform().invertSelf();return[e,t,n,r,i,s]}function Yn(a,e,t=!1,n=!0){if(e instanceof Hi){const{pageWidth:r,pageHeight:i}=e.rawDims,{style:s}=a,o=rn.isCSSRoundSupported,l=`var(--scale-factor) * ${r}px`,u=`var(--scale-factor) * ${i}px`,c=o?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,d=o?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!t||e.rotation%180===0?(s.width=c,s.height=d):(s.width=d,s.height=c)}n&&a.setAttribute("data-main-rotation",e.rotation)}class gs{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}class Oi{#e=null;#t=null;#n;#i=null;#s=null;static#r=null;constructor(e){this.#n=e,Oi.#r||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#n._uiManager._signal;e.addEventListener("contextmenu",wn,{signal:t}),e.addEventListener("pointerdown",Oi.#l,{signal:t});const n=this.#i=document.createElement("div");n.className="buttons",e.append(n);const r=this.#n.toolbarPosition;if(r){const{style:i}=e,s=this.#n._uiManager.direction==="ltr"?1-r[0]:r[0];i.insetInlineEnd=`${100*s}%`,i.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return this.#d(),e}get div(){return this.#e}static#l(e){e.stopPropagation()}#o(e){this.#n._focusEventsAllowed=!1,dn(e)}#u(e){this.#n._focusEventsAllowed=!0,dn(e)}#c(e){const t=this.#n._uiManager._signal;e.addEventListener("focusin",this.#o.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",wn,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#s?.shown()}#d(){const{editorType:e,_uiManager:t}=this.#n,n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",Oi.#r[e]),this.#c(n),n.addEventListener("click",r=>{t.delete()},{signal:t._signal}),this.#i.append(n)}get#h(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#c(t),this.#i.prepend(t,this.#h),this.#s=e}addColorPicker(e){this.#t=e;const t=e.renderButton();this.#c(t),this.#i.prepend(t,this.#h)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class dc{#e=null;#t=null;#n;constructor(e){this.#n=e}#i(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",wn,{signal:this.#n._signal});const t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#r(),e}#s(e,t){let n=0,r=0;for(const i of e){const s=i.y+i.height;if(s<n)continue;const o=i.x+(t?i.width:0);if(s>n){r=o,n=s;continue}t?o>r&&(r=o):o<r&&(r=o)}return[t?1-r:r,n]}show(e,t,n){const[r,i]=this.#s(t,n),{style:s}=this.#t||=this.#i();e.append(this.#t),s.insetInlineEnd=`${100*r}%`,s.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#r(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=this.#n._signal;e.addEventListener("contextmenu",wn,{signal:n}),e.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:n}),this.#e.append(e)}}function lr(a,e,t){for(const n of t)e.addEventListener(n,a[n].bind(a))}class fc{#e=0;get id(){return`${ql}${this.#e++}`}}class Ps{#e=ac();#t=0;#n=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;const i=r.decode().then(()=>(n.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return We(this,"_isSVGFittingCanvas",i)}async#i(e,t){this.#n||=new Map;let n=this.#n.get(e);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let r;if(typeof t=="string"?(n.url=t,r=await pr(t,"blob")):t instanceof File?r=n.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){const i=Ps._isSVGFittingCanvas,s=new FileReader,o=new Image,l=new Promise((u,c)=>{o.onload=()=>{n.bitmap=o,n.isSvg=!0,u()},s.onload=async()=>{const d=n.svgUrl=s.result;o.src=await i?`${d}#svgView(preserveAspectRatio(none))`:d},o.onerror=s.onerror=c});s.readAsDataURL(r),await l}else n.bitmap=await createImageBitmap(r);n.refCounter=1}catch(r){He(r),n=null}return this.#n.set(e,n),n&&this.#n.set(n.id,n),n}async getFromFile(e){const{lastModified:t,name:n,size:r,type:i}=e;return this.#i(`${t}_${n}_${r}_${i}`,e)}async getFromUrl(e){return this.#i(e,e)}async getFromBlob(e,t){const n=await t;return this.#i(e,n)}async getFromId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#n||=new Map;let n=this.#n.get(e);if(n?.bitmap)return n.refCounter+=1,n;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),n={bitmap:r.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#n.set(e,n),this.#n.set(n.id,n),n}getSvgUrl(e){const t=this.#n.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(n.width,n.height);r.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=r.convertToBlob()}n.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class pc{#e=[];#t=!1;#n;#i=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:t,post:n,mustExec:r,type:i=NaN,overwriteIfSameType:s=!1,keepUndo:o=!1}){if(r&&e(),this.#t)return;const l={cmd:e,undo:t,post:n,type:i};if(this.#i===-1){this.#e.length>0&&(this.#e.length=0),this.#i=0,this.#e.push(l);return}if(s&&this.#e[this.#i].type===i){o&&(l.undo=this.#e[this.#i].undo),this.#e[this.#i]=l;return}const u=this.#i+1;u===this.#n?this.#e.splice(0,1):(this.#i=u,u<this.#e.length&&this.#e.splice(u)),this.#e.push(l)}undo(){if(this.#i===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#i];e(),t?.(),this.#t=!1,this.#i-=1}redo(){if(this.#i<this.#e.length-1){this.#i+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#i];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#e.length-1}cleanType(e){if(this.#i!==-1){for(let t=this.#i;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#i-t),this.#i=t;return}this.#e.length=0,this.#i=-1}}destroy(){this.#e=null}}class ji{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=rn.platform;for(const[n,r,i={}]of e)for(const s of n){const o=s.startsWith("mac+");t&&o?(this.callbacks.set(s.slice(4),{callback:r,options:i}),this.allKeys.add(s.split("+").at(-1))):!t&&!o&&(this.callbacks.set(s,{callback:r,options:i}),this.allKeys.add(s.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(this.#e(t));if(!n)return;const{callback:r,options:{bubbles:i=!1,args:s=[],checker:o=null}}=n;o&&!o(e,t)||(r.bind(e,...s,t)(),i||dn(t))}}class ks{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return hc(e),We(this,"_colors",e)}convert(e){const t=Cs(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,r]of this._colors)if(r.every((i,s)=>i===t[s]))return ks._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?Ee.makeHexColor(...t):e}}class Hn{#e=new AbortController;#t=null;#n=new Map;#i=new Map;#s=null;#r=null;#l=null;#o=new pc;#u=null;#c=null;#d=0;#h=new Set;#f=null;#a=null;#p=new Set;_editorUndoBar=null;#m=!1;#g=!1;#v=!1;#w=null;#b=null;#y=null;#S=null;#C=!1;#k=null;#M=new fc;#E=!1;#x=!1;#P=null;#R=null;#D=null;#O=null;#A=ze.NONE;#_=new Set;#I=null;#j=null;#V=null;#W={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#N=[0,0];#F=null;#B=null;#$=null;#L=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=Hn.prototype,t=s=>s.#B.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&s.hasSomethingToControl(),n=(s,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},r=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return We(this,"_keyboardManager",new ji([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(s,{target:o})=>!(o instanceof HTMLButtonElement)&&s.#B.contains(o)&&!s.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(s,{target:o})=>!(o instanceof HTMLButtonElement)&&s.#B.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}constructor(e,t,n,r,i,s,o,l,u,c,d,f,p){const g=this._signal=this.#e.signal;this.#B=e,this.#$=t,this.#s=n,this._eventBus=r,r._on("editingaction",this.onEditingAction.bind(this),{signal:g}),r._on("pagechanging",this.onPageChanging.bind(this),{signal:g}),r._on("scalechanging",this.onScaleChanging.bind(this),{signal:g}),r._on("rotationchanging",this.onRotationChanging.bind(this),{signal:g}),r._on("setpreference",this.onSetPreference.bind(this),{signal:g}),r._on("switchannotationeditorparams",h=>this.updateParams(h.type,h.value),{signal:g}),this.#te(),this.#se(),this.#X(),this.#r=i.annotationStorage,this.#w=i.filterFactory,this.#j=s,this.#S=o||null,this.#m=l,this.#g=u,this.#v=c,this.#O=d||null,this.viewParameters={realScale:mi.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=f||null,this._supportsPinchToZoom=p!==!1}destroy(){this.#L?.resolve(),this.#L=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#i.values())e.destroy();this.#i.clear(),this.#n.clear(),this.#p.clear(),this.#t=null,this.#_.clear(),this.#o.destroy(),this.#s?.destroy(),this.#k?.hide(),this.#k=null,this.#b&&(clearTimeout(this.#b),this.#b=null),this.#F&&(clearTimeout(this.#F),this.#F=null),this._editorUndoBar?.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#O}get useNewAltTextFlow(){return this.#g}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return We(this,"hcmFilter",this.#j?this.#w.addHCMFilter(this.#j.foreground,this.#j.background):"none")}get direction(){return We(this,"direction",getComputedStyle(this.#B).direction)}get highlightColors(){return We(this,"highlightColors",this.#S?new Map(this.#S.split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return We(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#c=e}setMainHighlightColorPicker(e){this.#D=e}editAltText(e,t=!1){this.#s?.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#v=t;break}}onPageChanging({pageNumber:e}){this.#d=e-1}focusMainContainer(){this.#B.focus()}findParent(e,t){for(const n of this.#i.values()){const{x:r,y:i,width:s,height:o}=n.div.getBoundingClientRect();if(e>=r&&e<=r+s&&t>=i&&t<=i+o)return n}return null}disableUserSelect(e=!1){this.#$.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*mi.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#c?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#z({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#q(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of this.#i.values())if(n.hasTextLayer(e))return n;return null}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:s}=t,o=t.toString(),u=this.#z(t).closest(".textLayer"),c=this.getSelectionBoxes(u);if(!c)return;t.empty();const d=this.#q(u),f=this.#A===ze.NONE,p=()=>{d?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:c,anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:s,text:o}),f&&this.showAllEditors("highlight",!0,!0)};if(f){this.switchToMode(ze.HIGHLIGHT,p);return}p()}#Q(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=this.#z(e).closest(".textLayer"),r=this.getSelectionBoxes(n);r&&(this.#k||=new dc(this),this.#k.show(n,r,this.direction==="ltr"))}addToAnnotationStorage(e){!e.isEmpty()&&this.#r&&!this.#r.has(e.id)&&this.#r.setValue(e.id,e)}#ee(){const e=document.getSelection();if(!e||e.isCollapsed){this.#I&&(this.#k?.hide(),this.#I=null,this.#T({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#I)return;const r=this.#z(e).closest(".textLayer");if(!r){this.#I&&(this.#k?.hide(),this.#I=null,this.#T({hasSelectedText:!1}));return}if(this.#k?.hide(),this.#I=t,this.#T({hasSelectedText:!0}),!(this.#A!==ze.HIGHLIGHT&&this.#A!==ze.NONE)&&(this.#A===ze.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#C=this.isShiftKeyDown,!this.isShiftKeyDown)){const i=this.#A===ze.HIGHLIGHT?this.#q(r):null;i?.toggleDrawing();const s=new AbortController,o=this.combinedSignal(s),l=u=>{u.type==="pointerup"&&u.button!==0||(s.abort(),i?.toggleDrawing(!0),u.type==="pointerup"&&this.#U("main_toolbar"))};window.addEventListener("pointerup",l,{signal:o}),window.addEventListener("blur",l,{signal:o})}}#U(e=""){this.#A===ze.HIGHLIGHT?this.highlightSelection(e):this.#m&&this.#Q()}#te(){document.addEventListener("selectionchange",this.#ee.bind(this),{signal:this._signal})}#ne(){if(this.#y)return;this.#y=new AbortController;const e=this.combinedSignal(this.#y);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#ie(){this.#y?.abort(),this.#y=null}blur(){if(this.isShiftKeyDown=!1,this.#C&&(this.#C=!1,this.#U("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#_)if(t.div.contains(e)){this.#R=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#R)return;const[e,t]=this.#R;this.#R=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#X(){if(this.#P)return;this.#P=new AbortController;const e=this.combinedSignal(this.#P);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#re(){this.#P?.abort(),this.#P=null}#K(){if(this.#u)return;this.#u=new AbortController;const e=this.combinedSignal(this.#u);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#Y(){this.#u?.abort(),this.#u=null}#se(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#X(),this.#K()}removeEditListeners(){this.#re(),this.#Y()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of this.#a)if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of this.#a)if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const n of this.#_){const r=n.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const s of this.#a)if(s.isHandlingMimeForPasting(i.type)){s.paste(i,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(i){He(`paste: "${i.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const r=this.currentLayer;try{const i=[];for(const l of n){const u=await r.deserialize(l);if(!u)return;i.push(u)}const s=()=>{for(const l of i)this.#Z(l);this.#J(i)},o=()=>{for(const l of i)l.remove()};this.addCommands({cmd:s,undo:o,mustExec:!0})}catch(i){He(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#A!==ze.NONE&&!this.isEditorHandlingKeyboard&&Hn._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#C&&(this.#C=!1,this.#U("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#T(e){Object.entries(e).some(([n,r])=>this.#W[n]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#W,e)}),this.#A===ze.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#H([[Xe.HIGHLIGHT_FREE,!0]]))}#H(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#ne(),this.#K(),this.#T({isEditing:this.#A!==ze.NONE,isEmpty:this.#G(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ie(),this.#Y(),this.#T({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#a){this.#a=e;for(const t of this.#a)this.#H(t.defaultPropertiesToUpdate)}}getId(){return this.#M.id}get currentLayer(){return this.#i.get(this.#d)}getLayer(e){return this.#i.get(e)}get currentPageIndex(){return this.#d}addLayer(e){this.#i.set(e.pageIndex,e),this.#E?e.enable():e.disable()}removeLayer(e){this.#i.delete(e.pageIndex)}async updateMode(e,t=null,n=!1){if(this.#A!==e&&!(this.#L&&(await this.#L.promise,!this.#L))){if(this.#L=Promise.withResolvers(),this.#A=e,e===ze.NONE){this.setEditingState(!1),this.#oe(),this._editorUndoBar?.hide(),this.#L.resolve();return}this.setEditingState(!0),await this.#ae(),this.unselectAll();for(const r of this.#i.values())r.updateMode(e);if(!t){n&&this.addNewEditorFromKeyboard(),this.#L.resolve();return}for(const r of this.#n.values())r.annotationElementId===t?(this.setSelected(r),r.enterInEditMode()):r.unselect();this.#L.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==this.#A&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){if(this.#a){switch(e){case Xe.CREATE:this.currentLayer.addNewEditor();return;case Xe.HIGHLIGHT_DEFAULT_COLOR:this.#D?.updateColor(t);break;case Xe.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#V||=new Map).set(e,t),this.showAllEditors("highlight",t);break}for(const n of this.#_)n.updateParams(e,t);for(const n of this.#a)n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){for(const i of this.#n.values())i.editorType===e&&i.show(t);(this.#V?.get(Xe.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#H([[Xe.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#x!==e){this.#x=e;for(const t of this.#i.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#ae(){if(!this.#E){this.#E=!0;const e=[];for(const t of this.#i.values())e.push(t.enable());await Promise.all(e);for(const t of this.#n.values())t.enable()}}#oe(){if(this.unselectAll(),this.#E){this.#E=!1;for(const e of this.#i.values())e.disable();for(const e of this.#n.values())e.disable()}}getEditors(e){const t=[];for(const n of this.#n.values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return this.#n.get(e)}addEditor(e){this.#n.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.focusMainContainer(),this.#b=null},0)),this.#n.delete(e.id),this.unselect(e),(!e.annotationElementId||!this.#h.has(e.annotationElementId))&&this.#r?.remove(e.id)}addDeletedAnnotationElement(e){this.#h.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#h.has(e)}removeDeletedAnnotationElement(e){this.#h.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#Z(e){const t=this.#i.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#H(e.propertiesToUpdate))}get#le(){let e=null;for(e of this.#_);return e}updateUI(e){this.#le===e&&this.#H(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#H(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#_.has(e)){this.#_.delete(e),e.unselect(),this.#T({hasSelectedEditor:this.hasSelection});return}this.#_.add(e),e.select(),this.#H(e.propertiesToUpdate),this.#T({hasSelectedEditor:!0})}setSelected(e){this.#c?.commitOrRemove();for(const t of this.#_)t!==e&&t.unselect();this.#_.clear(),this.#_.add(e),e.select(),this.#H(e.propertiesToUpdate),this.#T({hasSelectedEditor:!0})}isSelected(e){return this.#_.has(e)}get firstSelectedEditor(){return this.#_.values().next().value}unselect(e){e.unselect(),this.#_.delete(e),this.#T({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#_.size!==0}get isEnterHandled(){return this.#_.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#o.undo(),this.#T({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#G()}),this._editorUndoBar?.hide()}redo(){this.#o.redo(),this.#T({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#G()})}addCommands(e){this.#o.add(e),this.#T({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#G()})}cleanUndoStack(e){this.#o.cleanType(e)}#G(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const e of this.#n.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#_],n=()=>{this._editorUndoBar?.show(r,t.length===1?t[0].editorType:t.length);for(const i of t)i.remove()},r=()=>{for(const i of t)this.#Z(i)};this.addCommands({cmd:n,undo:r,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#J(e){for(const t of this.#_)t.unselect();this.#_.clear();for(const t of e)t.isEmpty()||(this.#_.add(t),t.select());this.#T({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#_)e.commit();this.#J(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#A!==ze.NONE))&&!this.#c?.commitOrRemove()&&this.hasSelection){for(const e of this.#_)e.unselect();this.#_.clear(),this.#T({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#N[0]+=e,this.#N[1]+=t;const[r,i]=this.#N,s=[...this.#_],o=1e3;this.#F&&clearTimeout(this.#F),this.#F=setTimeout(()=>{this.#F=null,this.#N[0]=this.#N[1]=0,this.addCommands({cmd:()=>{for(const l of s)this.#n.has(l.id)&&l.translateInPage(r,i)},undo:()=>{for(const l of s)this.#n.has(l.id)&&l.translateInPage(-r,-i)},mustExec:!1})},o);for(const l of s)l.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#f=new Map;for(const e of this.#_)this.#f.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#f)return!1;this.disableUserSelect(!1);const e=this.#f;this.#f=null;let t=!1;for(const[{x:r,y:i,pageIndex:s},o]of e)o.newX=r,o.newY=i,o.newPageIndex=s,t||=r!==o.savedX||i!==o.savedY||s!==o.savedPageIndex;if(!t)return!1;const n=(r,i,s,o)=>{if(this.#n.has(r.id)){const l=this.#i.get(o);l?r._setParentAndPosition(l,i,s):(r.pageIndex=o,r.x=i,r.y=s)}};return this.addCommands({cmd:()=>{for(const[r,{newX:i,newY:s,newPageIndex:o}]of e)n(r,i,s,o)},undo:()=>{for(const[r,{savedX:i,savedY:s,savedPageIndex:o}]of e)n(r,i,s,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#f)for(const n of this.#f.keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#_.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#A}get imageManager(){return We(this,"imageManager",new Ps)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,c=t.rangeCount;u<c;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:n,y:r,width:i,height:s}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(u,c,d,f)=>({x:(c-r)/s,y:1-(u+d-n)/i,width:f/s,height:d/i});break;case"180":o=(u,c,d,f)=>({x:1-(u+d-n)/i,y:1-(c+f-r)/s,width:d/i,height:f/s});break;case"270":o=(u,c,d,f)=>({x:1-(c+f-r)/s,y:(u-n)/i,width:f/s,height:d/i});break;default:o=(u,c,d,f)=>({x:(u-n)/i,y:(c-r)/s,width:d/i,height:f/s});break}const l=[];for(let u=0,c=t.rangeCount;u<c;u++){const d=t.getRangeAt(u);if(!d.collapsed)for(const{x:f,y:p,width:g,height:h}of d.getClientRects())g===0||h===0||l.push(o(f,p,g,h))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#l||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#l?.delete(e)}renderAnnotationElement(e){const t=this.#l?.get(e.data.id);if(!t)return;const n=this.#r.getRawValue(t);n&&(this.#A===ze.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}}class Cn{#e=null;#t=!1;#n=null;#i=null;#s=null;#r=null;#l=!1;#o=null;#u=null;#c=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(e){this.#u=e,this.#h=e._uiManager.useNewAltTextFlow,Cn.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){Cn._l10n??=e}async render(){const e=this.#n=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#i=document.createElement("span");e.append(t),this.#h?(e.classList.add("new"),e.setAttribute("data-l10n-id",Cn.#f.missing),t.setAttribute("data-l10n-id",Cn.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#u._uiManager._signal;e.addEventListener("contextmenu",wn,{signal:n}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:n});const r=i=>{i.preventDefault(),this.#u._uiManager.editAltText(this.#u),this.#h&&this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#a}})};return e.addEventListener("click",r,{capture:!0,signal:n}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(this.#l=!0,r(i))},{signal:n}),await this.#p(),e}get#a(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#h?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#h?this.#e!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(e){this.#e===null&&(this.#c=e,this.#d=await Cn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#p())}toggleAltTextBadge(e=!1){if(!this.#h||this.#e){this.#o?.remove(),this.#o=null;return}if(!this.#o){const t=this.#o=document.createElement("div");t.className="noAltTextBadge",this.#u.div.append(t)}this.#o.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#c===t&&(t=this.#d),{altText:t,decorative:this.#t,guessedText:this.#c,textWithDisclaimer:this.#d}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:r,cancel:i=!1}){n&&(this.#c=n,this.#d=r),!(this.#e===e&&this.#t===t)&&(i||(this.#e=e,this.#t=t),this.#p())}toggle(e=!1){this.#n&&(!e&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#n.disabled=!e)}shown(){this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#a}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#s=null,this.#o?.remove(),this.#o=null}async#p(){const e=this.#n;if(!e)return;if(this.#h){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",Cn.#f[this.#a]),this.#i?.setAttribute("data-l10n-id",Cn.#f[`${this.#a}-label`]),!this.#e){this.#s?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#s?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#s;if(!t){this.#s=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#u.id}`;const r=100,i=this.#u._uiManager._signal;i.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#s.classList.add("show"),this.#u._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:i}),e.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#s?.classList.remove("show")},{signal:i})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#u.getImageForAltText()?.setAttribute("aria-describedby",t.id)}}class mr{#e;#t=!1;#n=null;#i;#s;#r;#l;#o;#u=null;#c;#d=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:r=null,onPinching:i=null,onPinchEnd:s=null,signal:o}){this.#e=e,this.#n=n,this.#i=t,this.#s=r,this.#r=i,this.#l=s,this.#c=new AbortController,this.#o=AbortSignal.any([o,this.#c.signal]),e.addEventListener("touchstart",this.#h.bind(this),{passive:!1,signal:this.#o})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return We(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}#h(e){if(this.#i?.()||e.touches.length<2)return;if(!this.#d){this.#d=new AbortController;const r=AbortSignal.any([this.#o,this.#d.signal]),i=this.#e,s={signal:r,passive:!1};i.addEventListener("touchmove",this.#f.bind(this),s),i.addEventListener("touchend",this.#a.bind(this),s),i.addEventListener("touchcancel",this.#a.bind(this),s),this.#s?.()}if(dn(e),e.touches.length!==2||this.#n?.()){this.#u=null;return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),this.#u={touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#f(e){if(!this.#u||e.touches.length!==2)return;let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:r,screenY:i}=t,{screenX:s,screenY:o}=n,l=this.#u,{touch0X:u,touch0Y:c,touch1X:d,touch1Y:f}=l,p=d-u,g=f-c,h=s-r,v=o-i,b=Math.hypot(h,v)||1,_=Math.hypot(p,g)||1;if(!this.#t&&Math.abs(_-b)<=mr.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=r,l.touch0Y=i,l.touch1X=s,l.touch1Y=o,e.preventDefault(),!this.#t){this.#t=!0;return}const C=[(r+s)/2,(i+o)/2];this.#r?.(C,_,b)}#a(e){this.#d.abort(),this.#d=null,this.#l?.(),this.#u&&(e.preventDefault(),this.#u=null,this.#t=!1)}destroy(){this.#c?.abort(),this.#c=null}}class Le{#e=null;#t=null;#n=null;#i=!1;#s=null;#r="";#l=!1;#o=null;#u=null;#c=null;#d=null;#h="";#f=!1;#a=null;#p=!1;#m=!1;#g=!1;#v=null;#w=0;#b=0;#y=null;#S=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#C=!1;#k=Le._zIndex++;static _borderLineWidth=-1;static _colorManager=new ks;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=Le.prototype._resizeWithKeyboard,t=Hn.TRANSLATE_SMALL,n=Hn.TRANSLATE_BIG;return We(this,"_resizerKeyboardManager",new ji([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],Le.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:r,pageX:i,pageY:s}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,r],this.pageTranslation=[i,s];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return We(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new gc({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Le._l10n??=e,Le._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Le._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Le._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){dt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#C}set _isDraggable(e){this.#C=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#k}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#z(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#f?this.#f=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,r){const[i,s]=this.parentDimensions;[n,r]=this.screenToPageTranslation(n,r),this.x=(e+n)/i,this.y=(t+r)/s,this.fixAndSetPosition()}#M([e,t],n,r){[n,r]=this.screenToPageTranslation(n,r),this.x+=n/e,this.y+=r/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#M(this.parentDimensions,e,t)}translateInPage(e,t){this.#a||=[this.x,this.y,this.width,this.height],this.#M(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#a||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[r,i]}=this;if(this.x+=e/r,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:o}=this;const[l,u]=this.getBaseTranslation();s+=l,o+=u;const{style:c}=n;c.left=`${(100*s).toFixed(2)}%`,c.top=`${(100*o).toFixed(2)}%`,this._onTranslating(s,o),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#a&&(this.#a[0]!==this.x||this.#a[1]!==this.y)}get _hasBeenResized(){return!!this.#a&&(this.#a[2]!==this.width||this.#a[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=Le,r=n/e,i=n/t;switch(this.rotation){case 90:return[-r,i];case 180:return[r,i];case 270:return[r,-i];default:return[-r,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,r]}=this;let{x:i,y:s,width:o,height:l}=this;if(o*=n,l*=r,i*=n,s*=r,this._mustFixPosition)switch(e){case 0:i=Math.max(0,Math.min(n-o,i)),s=Math.max(0,Math.min(r-l,s));break;case 90:i=Math.max(0,Math.min(n-l,i)),s=Math.min(r,Math.max(o,s));break;case 180:i=Math.min(n,Math.max(o,i)),s=Math.min(r,Math.max(l,s));break;case 270:i=Math.min(n,Math.max(l,i)),s=Math.max(0,Math.min(r-o,s));break}this.x=i/=n,this.y=s/=r;const[u,c]=this.getBaseTranslation();i+=u,s+=c,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*s).toFixed(2)}%`,this.moveInDOM()}static#E(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return Le.#E(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return Le.#E(e,t,360-this.parentRotation)}#x(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(e,t){const[n,r]=this.parentDimensions,{style:i}=this.div;i.width=`${(100*e/n).toFixed(2)}%`,this.#l||(i.height=`${(100*t/r).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,r=n.endsWith("%"),i=!this.#l&&t.endsWith("%");if(r&&i)return;const[s,o]=this.parentDimensions;r||(e.width=`${(100*parseFloat(n)/s).toFixed(2)}%`),!this.#l&&!i&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#P(){if(this.#o)return;this.#o=document.createElement("div"),this.#o.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const r=document.createElement("div");this.#o.append(r),r.classList.add("resizer",n),r.setAttribute("data-resizer-name",n),r.addEventListener("pointerdown",this.#R.bind(this,n),{signal:t}),r.addEventListener("contextmenu",wn,{signal:t}),r.tabIndex=-1}this.div.prepend(this.#o)}#R(e,t){t.preventDefault();const{isMac:n}=rn.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#n?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#u=[t.screenX,t.screenY];const i=new AbortController,s=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#A.bind(this,e),{passive:!0,capture:!0,signal:s}),window.addEventListener("touchmove",dn,{passive:!1,signal:s}),window.addEventListener("contextmenu",wn,{signal:s}),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{i.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=o,this.div.style.cursor=l,this.#O()};window.addEventListener("pointerup",u,{signal:s}),window.addEventListener("blur",u,{signal:s})}#D(e,t,n,r){this.width=n,this.height=r,this.x=e,this.y=t;const[i,s]=this.parentDimensions;this.setDims(i*n,s*r),this.fixAndSetPosition(),this._onResized()}_onResized(){}#O(){if(!this.#c)return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:r}=this.#c;this.#c=null;const i=this.x,s=this.y,o=this.width,l=this.height;i===e&&s===t&&o===n&&l===r||this.addCommands({cmd:this.#D.bind(this,i,s,o,l),undo:this.#D.bind(this,e,t,n,r),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#A(e,t){const[n,r]=this.parentDimensions,i=this.x,s=this.y,o=this.width,l=this.height,u=Le.MIN_SIZE/n,c=Le.MIN_SIZE/r,d=this.#x(this.rotation),f=(M,x)=>[d[0]*M+d[2]*x,d[1]*M+d[3]*x],p=this.#x(360-this.rotation),g=(M,x)=>[p[0]*M+p[2]*x,p[1]*M+p[3]*x];let h,v,b=!1,_=!1;switch(e){case"topLeft":b=!0,h=(M,x)=>[0,0],v=(M,x)=>[M,x];break;case"topMiddle":h=(M,x)=>[M/2,0],v=(M,x)=>[M/2,x];break;case"topRight":b=!0,h=(M,x)=>[M,0],v=(M,x)=>[0,x];break;case"middleRight":_=!0,h=(M,x)=>[M,x/2],v=(M,x)=>[0,x/2];break;case"bottomRight":b=!0,h=(M,x)=>[M,x],v=(M,x)=>[0,0];break;case"bottomMiddle":h=(M,x)=>[M/2,x],v=(M,x)=>[M/2,0];break;case"bottomLeft":b=!0,h=(M,x)=>[0,x],v=(M,x)=>[M,0];break;case"middleLeft":_=!0,h=(M,x)=>[0,x/2],v=(M,x)=>[M,x/2];break}const C=h(o,l),E=v(o,l);let k=f(...E);const H=Le._round(i+k[0]),T=Le._round(s+k[1]);let A=1,B=1,z,y;if(t.fromKeyboard)({deltaX:z,deltaY:y}=t);else{const{screenX:M,screenY:x}=t,[j,U]=this.#u;[z,y]=this.screenToPageTranslation(M-j,x-U),this.#u[0]=M,this.#u[1]=x}if([z,y]=g(z/n,y/r),b){const M=Math.hypot(o,l);A=B=Math.max(Math.min(Math.hypot(E[0]-C[0]-z,E[1]-C[1]-y)/M,1/o,1/l),u/o,c/l)}else _?A=Math.max(u,Math.min(1,Math.abs(E[0]-C[0]-z)))/o:B=Math.max(c,Math.min(1,Math.abs(E[1]-C[1]-y)))/l;const S=Le._round(o*A),L=Le._round(l*B);k=f(...v(S,L));const N=H-k[0],D=T-k[1];this.#a||=[this.x,this.y,this.width,this.height],this.width=S,this.height=L,this.x=N,this.y=D,this.setDims(n*S,r*L),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}async addEditToolbar(){return this._editToolbar||this.#m?this._editToolbar:(this._editToolbar=new Oi(this),this.div.append(this._editToolbar.render()),this.#n&&await this._editToolbar.addAltText(this.#n),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#n||(Cn.initialize(Le._l10n),this.#n=new Cn(this),this.#e&&(this.#n.data=this.#e,this.#e=null),await this.addEditToolbar())}get altTextData(){return this.#n?.data}set altTextData(e){this.#n&&(this.#n.data=e)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(e){await this.#n?.setGuessedText(e)}serializeAltText(e){return this.#n?.serialize(e)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#i?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#N();const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[n,r]=this.getInitialTranslation();return this.translate(n,r),lr(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#S||=new mr({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#_.bind(this),onPinching:this.#I.bind(this),onPinchEnd:this.#j.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),this.div}#_(){this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#I(e,t,n){let i=.7*(n/t)+1-.7;if(i===1)return;const s=this.#x(this.rotation),o=(H,T)=>[s[0]*H+s[2]*T,s[1]*H+s[3]*T],[l,u]=this.parentDimensions,c=this.x,d=this.y,f=this.width,p=this.height,g=Le.MIN_SIZE/l,h=Le.MIN_SIZE/u;i=Math.max(Math.min(i,1/f,1/p),g/f,h/p);const v=Le._round(f*i),b=Le._round(p*i);if(v===f&&b===p)return;this.#a||=[c,d,f,p];const _=o(f/2,p/2),C=Le._round(c+_[0]),E=Le._round(d+_[1]),k=o(v/2,b/2);this.x=C-k[0],this.y=E-k[1],this.width=v,this.height=b,this.setDims(l*v,u*b),this.fixAndSetPosition(),this._onResizing()}#j(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#O()}pointerdown(e){const{isMac:t}=rn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#f=!0,this._isDraggable){this.#W(e);return}this.#V(e)}get isSelected(){return this._uiManager.isSelected(this)}#V(e){const{isMac:t}=rn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#W(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const r=new AbortController,i=this._uiManager.combinedSignal(r),s={capture:!0,passive:!1,signal:i},o=u=>{r.abort(),this.#s=null,this.#f=!1,this._uiManager.endDragSession()||this.#V(u),n&&this._onStopDragging()};t&&(this.#w=e.clientX,this.#b=e.clientY,this.#s=e.pointerId,this.#r=e.pointerType,window.addEventListener("pointermove",u=>{n||(n=!0,this._onStartDragging());const{clientX:c,clientY:d,pointerId:f}=u;if(f!==this.#s){dn(u);return}const[p,g]=this.screenToPageTranslation(c-this.#w,d-this.#b);this.#w=c,this.#b=d,this._uiManager.dragSelectedEditors(p,g)},s),window.addEventListener("touchmove",dn,s),window.addEventListener("pointerdown",u=>{u.pointerType===this.#r&&(this.#S||u.isPrimary)&&o(u),dn(u)},s));const l=u=>{if(!this.#s||this.#s===u.pointerId){o(u);return}dn(u)};window.addEventListener("pointerup",l,{signal:i}),window.addEventListener("blur",l,{signal:i})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const r=this.parentScale,[i,s]=this.pageDimensions,[o,l]=this.pageTranslation,u=e/r,c=t/r,d=this.x*i,f=this.y*s,p=this.width*i,g=this.height*s;switch(n){case 0:return[d+u+o,s-f-c-g+l,d+u+p+o,s-f-c+l];case 90:return[d+c+o,s-f+u+l,d+c+g+o,s-f+u+p+l];case 180:return[d-u-p+o,s-f+c+l,d-u+o,s-f+c+g+l];case 270:return[d-c-g+o,s-f-u-p+l,d-c+o,s-f-u+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,r,i,s]=e,o=i-n,l=s-r;switch(this.rotation){case 0:return[n,t-s,o,l];case 90:return[n,t-r,l,o];case 180:return[i,t-r,o,l];case 270:return[i,t-s,l,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){this.#m=!0}disableEditMode(){this.#m=!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#g}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:r}=this.getClientDimensions(),{innerHeight:i,innerWidth:s}=window;return t<s&&r>0&&e<i&&n>0}#N(){if(this.#d||!this.div)return;this.#d=new AbortController;const e=this._uiManager.combinedSignal(this.#d);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#N()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){dt("An editor must be serializable")}static async deserialize(e,t,n){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n});r.rotation=e.rotation,r.#e=e.accessibilityData;const[i,s]=r.pageDimensions,[o,l,u,c]=r.getRectInCurrentCoords(e.rect,s);return r.x=o/i,r.y=l/s,r.width=u/i,r.height=c/s,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#d?.abort(),this.#d=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#z(),this.removeEditToolbar(),this.#y){for(const e of this.#y.values())clearTimeout(e);this.#y=null}this.parent=null,this.#S?.destroy(),this.#S=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#P(),this.#o.classList.remove("hidden"),lr(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#o.children;if(!this.#t){this.#t=Array.from(t);const s=this.#F.bind(this),o=this.#B.bind(this),l=this._uiManager._signal;for(const u of this.#t){const c=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",s,{signal:l}),u.addEventListener("blur",o,{signal:l}),u.addEventListener("focus",this.#$.bind(this,c),{signal:l}),u.setAttribute("data-l10n-id",Le._l10nResizer[c])}}const n=this.#t[0];let r=0;for(const s of t){if(s===n)break;r++}const i=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(i!==r){if(i<r)for(let o=0;o<r-i;o++)this.#o.append(this.#o.firstChild);else if(i>r)for(let o=0;o<i-r;o++)this.#o.firstChild.before(this.#o.lastChild);let s=0;for(const o of t){const u=this.#t[s++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",Le._l10nResizer[u])}}this.#L(0),this.#g=!0,this.#o.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#F(e){Le._resizerKeyboardManager.exec(this,e)}#B(e){this.#g&&e.relatedTarget?.parentNode!==this.#o&&this.#z()}#$(e){this.#h=this.#g?e:""}#L(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#g&&this.#A(this.#h,{deltaX:e,deltaY:t,fromKeyboard:!0})}#z(){this.#g=!1,this.#L(-1),this.#O()}_stopResizingWithKeyboard(){this.#z(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}unselect(){this.#o?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#l=!0;const n=e/t,{style:r}=this.div;r.aspectRatio=n,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#y||=new Map;const{action:n}=e;let r=this.#y.get(n);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),this.#y.delete(n),this.#y.size===0&&(this.#y=null)},Le._telemetryTimeout),this.#y.set(n,r);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#i=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#i=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class gc extends Le{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const oa=3285377520,gn=4294901760,An=65535;class co{constructor(e){this.h1=e?e&4294967295:oa,this.h2=e?e&4294967295:oa}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let h=0,v=e.length;h<v;h++){const b=e.charCodeAt(h);b<=255?t[n++]=b:(t[n++]=b>>>8,t[n++]=b&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=n>>2,i=n-r*4,s=new Uint32Array(t.buffer,0,r);let o=0,l=0,u=this.h1,c=this.h2;const d=3432918353,f=461845907,p=d&An,g=f&An;for(let h=0;h<r;h++)h&1?(o=s[h],o=o*d&gn|o*p&An,o=o<<15|o>>>17,o=o*f&gn|o*g&An,u^=o,u=u<<13|u>>>19,u=u*5+3864292196):(l=s[h],l=l*d&gn|l*p&An,l=l<<15|l>>>17,l=l*f&gn|l*g&An,c^=l,c=c<<13|c>>>19,c=c*5+3864292196);switch(o=0,i){case 3:o^=t[r*4+2]<<16;case 2:o^=t[r*4+1]<<8;case 1:o^=t[r*4],o=o*d&gn|o*p&An,o=o<<15|o>>>17,o=o*f&gn|o*g&An,r&1?u^=o:c^=o}this.h1=u,this.h2=c}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&gn|e*36045&An,t=t*4283543511&gn|((t<<16|e>>>16)*2950163797&gn)>>>16,e^=t>>>1,e=e*444984403&gn|e*60499&An,t=t*3301882366&gn|((t<<16|e>>>16)*3120437893&gn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const ms=Object.freeze({map:null,hash:"",transfer:void 0});class xs{#e=!1;#t=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=this.#n.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#n.get(e)}remove(e){if(this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this.#n.values())if(t instanceof Le)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=this.#n.get(e);let r=!1;if(n!==void 0)for(const[i,s]of Object.entries(t))n[i]!==s&&(r=!0,n[i]=s);else r=!0,this.#n.set(e,t);r&&this.#i(),t instanceof Le&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#n.has(e)}getAll(){return this.#n.size>0?ys(this.#n):null}setAll(e){for(const[t,n]of Object.entries(e))this.setValue(t,n)}get size(){return this.#n.size}#i(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new uo(this)}get serializable(){if(this.#n.size===0)return ms;const e=new Map,t=new co,n=[],r=Object.create(null);let i=!1;for(const[s,o]of this.#n){const l=o instanceof Le?o.serialize(!1,r):o;l&&(e.set(s,l),t.update(`${s}:${JSON.stringify(l)}`),i||=!!l.bitmap)}if(i)for(const s of e.values())s.bitmap&&n.push(s.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:ms}get editorStats(){let e=null;const t=new Map;for(const n of this.#n.values()){if(!(n instanceof Le))continue;const r=n.telemetryFinalData;if(!r)continue;const{type:i}=r;t.has(i)||t.set(i,Object.getPrototypeOf(n).constructor),e||=Object.create(null);const s=e[i]||=new Map;for(const[o,l]of Object.entries(r)){if(o==="type")continue;let u=s.get(o);u||(u=new Map,s.set(o,u));const c=u.get(l)??0;u.set(l,c+1)}}for(const[n,r]of t)e[n]=r.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;const e=[];for(const t of this.#n.values())!(t instanceof Le)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}}class uo extends xs{#e;constructor(e){super();const{map:t,hash:n,transfer:r}=e.serializable,i=structuredClone(t,r?{transfer:r}:null);this.#e={map:i,hash:n,transfer:r}}get print(){dt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return We(this,"modifiedIds",{ids:new Set,hash:""})}}class mc{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||this.#e.has(e.loadedName))){if(Vt(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:r,style:i}=e,s=new FontFace(n,r,i);this.addNativeFontFace(s);try{await s.load(),this.#e.add(n),t?.(e)}catch{He(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(s)}return}dt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(r){throw He(`Failed to load font '${n.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const r=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,r)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return We(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(en||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),We(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Vt(!r.done,"completeRequest() cannot be called twice."),r.done=!0;n.length>0&&n[0].done;){const i=n.shift();setTimeout(i.callback,0)}}const{loadingRequests:n}=this,r={done:!1,complete:t,callback:e};return n.push(r),r}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return We(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(E,k){return E.charCodeAt(k)<<24|E.charCodeAt(k+1)<<16|E.charCodeAt(k+2)<<8|E.charCodeAt(k+3)&255}function r(E,k,H,T){const A=E.substring(0,k),B=E.substring(k+H);return A+T+B}let i,s;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let u=0;function c(E,k){if(++u>30){He("Load test font never loaded."),k();return}if(l.font="30px "+E,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){k();return}setTimeout(c.bind(null,E,k))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=r(f,976,d.length,d);const g=16,h=1482184792;let v=n(f,g);for(i=0,s=d.length-3;i<s;i+=4)v=v-h+n(d,i)|0;i<d.length&&(v=v-h+n(d+"XXX",i)|0),f=r(f,g,4,tc(v));const b=`url(data:font/opentype;base64,${btoa(f)});`,_=`@font-face {font-family:"${d}";src:${b}}`;this.insertRule(_);const C=this._document.createElement("div");C.style.visibility="hidden",C.style.width=C.style.height="10px",C.style.position="absolute",C.style.top=C.style.left="0px";for(const E of[e.loadedName,d]){const k=this._document.createElement("span");k.textContent="Hi",k.style.fontFamily=E,C.append(k)}this._document.body.append(C),c(d,()=>{C.remove(),t.complete()})}}class vc{constructor(e,{disableFontFace:t=!1,fontExtraProperties:n=!1,inspectFont:r=null}){this.compiledGlyphs=Object.create(null);for(const i in e)this[i]=e[i];this.disableFontFace=t===!0,this.fontExtraProperties=n===!0,this._inspectFont=r}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${oc(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let r;try{r=e.get(n)}catch(s){He(`getPathGenerator - ignoring character: "${s}".`)}const i=new Path2D(r||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=i}}const Zi={DATA:1,ERROR:2},jt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function la(){}function on(a){if(a instanceof zn||a instanceof ps||a instanceof Bi||a instanceof ra||a instanceof or||a instanceof jr)return a;switch(a instanceof Error||typeof a=="object"&&a!==null||dt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),a.name){case"AbortException":return new zn(a.message);case"InvalidPDFException":return new ps(a.message);case"MissingPDFException":return new Bi(a.message);case"PasswordException":return new ra(a.message,a.code);case"UnexpectedResponseException":return new or(a.message,a.status);case"UnknownErrorException":return new jr(a.message,a.details)}return new jr(a.message,a.toString())}class Di{#e=new AbortController;constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#i(e);return}if(e.callback){const n=e.callbackId,r=this.callbackCapabilities[n];if(!r)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===Zi.DATA)r.resolve(e.data);else if(e.callback===Zi.ERROR)r.reject(on(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,r=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(s){i.postMessage({sourceName:n,targetName:r,callback:Zi.DATA,callbackId:e.callbackId,data:s})},function(s){i.postMessage({sourceName:n,targetName:r,callback:Zi.ERROR,callbackId:e.callbackId,reason:on(s)})});return}if(e.streamId){this.#n(e);return}t(e.data)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const r=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[r]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},n)}catch(s){i.reject(s)}return i.promise}sendWithStream(e,t,n,r){const i=this.streamId++,s=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:u=>{const c=Promise.withResolvers();return this.streamControllers[i]={controller:u,startCall:c,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:s,targetName:o,action:e,streamId:i,data:t,desiredSize:u.desiredSize},r),c.promise},pull:u=>{const c=Promise.withResolvers();return this.streamControllers[i].pullCall=c,l.postMessage({sourceName:s,targetName:o,stream:jt.PULL,streamId:i,desiredSize:u.desiredSize}),c.promise},cancel:u=>{Vt(u instanceof Error,"cancel must have a valid reason");const c=Promise.withResolvers();return this.streamControllers[i].cancelCall=c,this.streamControllers[i].isClosed=!0,l.postMessage({sourceName:s,targetName:o,stream:jt.CANCEL,streamId:i,reason:on(u)}),c.promise}},n)}#n(e){const t=e.streamId,n=this.sourceName,r=e.sourceName,i=this.comObj,s=this,o=this.actionHandler[e.action],l={enqueue(u,c=1,d){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=c,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:n,targetName:r,stream:jt.ENQUEUE,streamId:t,chunk:u},d)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:r,stream:jt.CLOSE,streamId:t}),delete s.streamSinks[t])},error(u){Vt(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:r,stream:jt.ERROR,streamId:t,reason:on(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){i.postMessage({sourceName:n,targetName:r,stream:jt.START_COMPLETE,streamId:t,success:!0})},function(u){i.postMessage({sourceName:n,targetName:r,stream:jt.START_COMPLETE,streamId:t,reason:on(u)})})}#i(e){const t=e.streamId,n=this.sourceName,r=e.sourceName,i=this.comObj,s=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case jt.START_COMPLETE:e.success?s.startCall.resolve():s.startCall.reject(on(e.reason));break;case jt.PULL_COMPLETE:e.success?s.pullCall.resolve():s.pullCall.reject(on(e.reason));break;case jt.PULL:if(!o){i.postMessage({sourceName:n,targetName:r,stream:jt.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||la).then(function(){i.postMessage({sourceName:n,targetName:r,stream:jt.PULL_COMPLETE,streamId:t,success:!0})},function(u){i.postMessage({sourceName:n,targetName:r,stream:jt.PULL_COMPLETE,streamId:t,reason:on(u)})});break;case jt.ENQUEUE:if(Vt(s,"enqueue should have stream controller"),s.isClosed)break;s.controller.enqueue(e.chunk);break;case jt.CLOSE:if(Vt(s,"close should have stream controller"),s.isClosed)break;s.isClosed=!0,s.controller.close(),this.#s(s,t);break;case jt.ERROR:Vt(s,"error should have stream controller"),s.controller.error(on(e.reason)),this.#s(s,t);break;case jt.CANCEL_COMPLETE:e.success?s.cancelCall.resolve():s.cancelCall.reject(on(e.reason)),this.#s(s,t);break;case jt.CANCEL:if(!o)break;const l=on(e.reason);Promise.try(o.onCancel||la,l).then(function(){i.postMessage({sourceName:n,targetName:r,stream:jt.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){i.postMessage({sourceName:n,targetName:r,stream:jt.CANCEL_COMPLETE,streamId:t,reason:on(u)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#s(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class ho{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){dt("Abstract method `_createCanvas` called.")}}class bc extends ho{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class fo{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){dt("Abstract method `_fetch` called.")}}class po extends fo{async _fetch(e){const t=await pr(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):fr(t)}}class go{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,r,i){return"none"}destroy(e=!1){}}class _c extends go{#e;#t;#n;#i;#s;#r;#l=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#i=e,this.#s=t}get#o(){return this.#t||=new Map}get#u(){return this.#r||=new Map}get#c(){if(!this.#n){const e=this.#s.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const n=this.#s.createElementNS(Mn,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#n=this.#s.createElementNS(Mn,"defs"),e.append(n),n.append(this.#n),this.#s.body.append(e)}return this.#n}#d(e){if(e.length===1){const l=e[0],u=new Array(256);for(let d=0;d<256;d++)u[d]=l[d]/255;const c=u.join(",");return[c,c,c]}const[t,n,r]=e,i=new Array(256),s=new Array(256),o=new Array(256);for(let l=0;l<256;l++)i[l]=t[l]/255,s[l]=n[l]/255,o[l]=r[l]/255;return[i.join(","),s.join(","),o.join(",")]}#h(e){if(this.#e===void 0){this.#e="";const t=this.#s.URL;t!==this.#s.baseURI&&(gr(t)?He('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=t.split("#",1)[0])}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;const[n,r,i]=this.#d(e),s=e.length===1?n:`${n}${r}${i}`;if(t=this.#o.get(s),t)return this.#o.set(e,t),t;const o=`g_${this.#i}_transfer_map_${this.#l++}`,l=this.#h(o);this.#o.set(e,l),this.#o.set(s,l);const u=this.#p(o);return this.#g(n,r,i,u),l}addHCMFilter(e,t){const n=`${e}-${t}`,r="base";let i=this.#u.get(r);if(i?.key===n||(i?(i.filter?.remove(),i.key=n,i.url="none",i.filter=null):(i={key:n,url:"none",filter:null},this.#u.set(r,i)),!e||!t))return i.url;const s=this.#w(e);e=Ee.makeHexColor(...s);const o=this.#w(t);if(t=Ee.makeHexColor(...o),this.#c.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return i.url;const l=new Array(256);for(let p=0;p<=255;p++){const g=p/255;l[p]=g<=.03928?g/12.92:((g+.055)/1.055)**2.4}const u=l.join(","),c=`g_${this.#i}_hcm_filter`,d=i.filter=this.#p(c);this.#g(u,u,u,d),this.#a(d);const f=(p,g)=>{const h=s[p]/255,v=o[p]/255,b=new Array(g+1);for(let _=0;_<=g;_++)b[_]=h+_/g*(v-h);return b.join(",")};return this.#g(f(0,5),f(1,5),f(2,5),d),i.url=this.#h(c),i.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;const[n]=this.#d([e]),r=`alpha_${n}`;if(t=this.#o.get(r),t)return this.#o.set(e,t),t;const i=`g_${this.#i}_alpha_map_${this.#l++}`,s=this.#h(i);this.#o.set(e,s),this.#o.set(r,s);const o=this.#p(i);return this.#v(n,o),s}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let n,r;if(e?([n]=this.#d([e]),r=`luminosity_${n}`):r="luminosity",t=this.#o.get(r),t)return this.#o.set(e,t),t;const i=`g_${this.#i}_luminosity_map_${this.#l++}`,s=this.#h(i);this.#o.set(e,s),this.#o.set(r,s);const o=this.#p(i);return this.#f(o),e&&this.#v(n,o),s}addHighlightHCMFilter(e,t,n,r,i){const s=`${t}-${n}-${r}-${i}`;let o=this.#u.get(e);if(o?.key===s||(o?(o.filter?.remove(),o.key=s,o.url="none",o.filter=null):(o={key:s,url:"none",filter:null},this.#u.set(e,o)),!t||!n))return o.url;const[l,u]=[t,n].map(this.#w.bind(this));let c=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[f,p]=[r,i].map(this.#w.bind(this));d<c&&([c,d,f,p]=[d,c,p,f]),this.#c.style.color="";const g=(b,_,C)=>{const E=new Array(256),k=(d-c)/C,H=b/255,T=(_-b)/(255*C);let A=0;for(let B=0;B<=C;B++){const z=Math.round(c+B*k),y=H+B*T;for(let S=A;S<=z;S++)E[S]=y;A=z+1}for(let B=A;B<256;B++)E[B]=E[A-1];return E.join(",")},h=`g_${this.#i}_hcm_${e}_filter`,v=o.filter=this.#p(h);return this.#a(v),this.#g(g(f[0],p[0],5),g(f[1],p[1],5),g(f[2],p[2],5),v),o.url=this.#h(h),o.url}destroy(e=!1){e&&this.#r?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#t?.clear(),this.#t=null,this.#r?.clear(),this.#r=null,this.#l=0)}#f(e){const t=this.#s.createElementNS(Mn,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#a(e){const t=this.#s.createElementNS(Mn,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#p(e){const t=this.#s.createElementNS(Mn,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#c.append(t),t}#m(e,t,n){const r=this.#s.createElementNS(Mn,t);r.setAttribute("type","discrete"),r.setAttribute("tableValues",n),e.append(r)}#g(e,t,n,r){const i=this.#s.createElementNS(Mn,"feComponentTransfer");r.append(i),this.#m(i,"feFuncR",e),this.#m(i,"feFuncG",t),this.#m(i,"feFuncB",n)}#v(e,t){const n=this.#s.createElementNS(Mn,"feComponentTransfer");t.append(n),this.#m(n,"feFuncA",e)}#w(e){return this.#c.style.color=e,Cs(getComputedStyle(this.#c).getPropertyValue("color"))}}class mo{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){dt("Abstract method `_fetch` called.")}}class vo extends mo{async _fetch(e){const t=await pr(e,"arraybuffer");return new Uint8Array(t)}}en&&He("Please use the `legacy` build in Node.js environments.");async function bo(a){const t=await process.getBuiltinModule("fs").promises.readFile(a);return new Uint8Array(t)}class wc extends go{}class yc extends ho{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class Ec extends fo{async _fetch(e){return bo(e)}}class Sc extends mo{async _fetch(e){return bo(e)}}const Qt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function vs(a,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,n),a.clip(r)}class Ms{getPattern(){dt("Abstract method `getPattern` called.")}}class Ac extends Ms{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,r){let i;if(r===Qt.STROKE||r===Qt.FILL){const s=t.current.getClippedPathBoundingBox(r,Ct(e))||[0,0,0,0],o=Math.ceil(s[2]-s[0])||1,l=Math.ceil(s[3]-s[1])||1,u=t.cachedCanvases.getCanvas("pattern",o,l),c=u.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-s[0],-s[1]),n=Ee.transform(n,[1,0,0,1,s[0],s[1]]),c.transform(...t.baseTransform),this.matrix&&c.transform(...this.matrix),vs(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),i=e.createPattern(u.canvas,"no-repeat");const d=new DOMMatrix(n);i.setTransform(d)}else vs(e,this._bbox),i=this._createGradient(e);return i}}function $r(a,e,t,n,r,i,s,o){const l=e.coords,u=e.colors,c=a.data,d=a.width*4;let f;l[t+1]>l[n+1]&&(f=t,t=n,n=f,f=i,i=s,s=f),l[n+1]>l[r+1]&&(f=n,n=r,r=f,f=s,s=o,o=f),l[t+1]>l[n+1]&&(f=t,t=n,n=f,f=i,i=s,s=f);const p=(l[t]+e.offsetX)*e.scaleX,g=(l[t+1]+e.offsetY)*e.scaleY,h=(l[n]+e.offsetX)*e.scaleX,v=(l[n+1]+e.offsetY)*e.scaleY,b=(l[r]+e.offsetX)*e.scaleX,_=(l[r+1]+e.offsetY)*e.scaleY;if(g>=_)return;const C=u[i],E=u[i+1],k=u[i+2],H=u[s],T=u[s+1],A=u[s+2],B=u[o],z=u[o+1],y=u[o+2],S=Math.round(g),L=Math.round(_);let N,D,M,x,j,U,J,Q;for(let X=S;X<=L;X++){if(X<v){const te=X<g?0:(g-X)/(g-v);N=p-(p-h)*te,D=C-(C-H)*te,M=E-(E-T)*te,x=k-(k-A)*te}else{let te;X>_?te=1:v===_?te=0:te=(v-X)/(v-_),N=h-(h-b)*te,D=H-(H-B)*te,M=T-(T-z)*te,x=A-(A-y)*te}let q;X<g?q=0:X>_?q=1:q=(g-X)/(g-_),j=p-(p-b)*q,U=C-(C-B)*q,J=E-(E-z)*q,Q=k-(k-y)*q;const re=Math.round(Math.min(N,j)),oe=Math.round(Math.max(N,j));let Ae=d*X+re*4;for(let te=re;te<=oe;te++)q=(N-te)/(N-j),q<0?q=0:q>1&&(q=1),c[Ae++]=D-(D-U)*q|0,c[Ae++]=M-(M-J)*q|0,c[Ae++]=x-(x-Q)*q|0,c[Ae++]=255}}function Cc(a,e,t){const n=e.coords,r=e.colors;let i,s;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(n.length/o)-1,u=o-1;for(i=0;i<l;i++){let c=i*o;for(let d=0;d<u;d++,c++)$r(a,t,n[c],n[c+1],n[c+o],r[c],r[c+1],r[c+o]),$r(a,t,n[c+o+1],n[c+1],n[c+o],r[c+o+1],r[c+1],r[c+o])}break;case"triangles":for(i=0,s=n.length;i<s;i+=3)$r(a,t,n[i],n[i+1],n[i+2],r[i],r[i+1],r[i+2]);break;default:throw new Error("illegal figure")}}class Pc extends Ms{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,n){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,c=Math.ceil(this._bounds[3])-l,d=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(c*e[1]*1.1)),3e3),p=u/d,g=c/f,h={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/p,scaleY:1/g},v=d+4,b=f+4,_=n.getCanvas("mesh",v,b),C=_.context,E=C.createImageData(d,f);if(t){const H=E.data;for(let T=0,A=H.length;T<A;T+=4)H[T]=t[0],H[T+1]=t[1],H[T+2]=t[2],H[T+3]=255}for(const H of this._figures)Cc(E,H,h);return C.putImageData(E,2,2),{canvas:_.canvas,offsetX:o-2*p,offsetY:l-2*g,scaleX:p,scaleY:g}}getPattern(e,t,n,r){vs(e,this._bbox);let i;if(r===Qt.SHADING)i=Ee.singularValueDecompose2dScale(Ct(e));else if(i=Ee.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=Ee.singularValueDecompose2dScale(this.matrix);i=[i[0]*o[0],i[1]*o[1]]}const s=this._createMeshCanvas(i,r===Qt.SHADING?null:this._background,t.cachedCanvases);return r!==Qt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(s.offsetX,s.offsetY),e.scale(s.scaleX,s.scaleY),e.createPattern(s.canvas,"no-repeat")}}class kc extends Ms{getPattern(){return"hotpink"}}function xc(a){switch(a[0]){case"RadialAxial":return new Ac(a);case"Mesh":return new Pc(a);case"Dummy":return new kc}throw new Error(`Unknown IR type: ${a[0]}`)}const ca={COLORED:1,UNCOLORED:2};class Ts{static MAX_PATTERN_SIZE=3e3;constructor(e,t,n,r,i){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=n,this.canvasGraphicsFactory=r,this.baseTransform=i}createPatternCanvas(e){const{bbox:t,operatorList:n,paintType:r,tilingType:i,color:s,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:u}=this;l=Math.abs(l),u=Math.abs(u),dr("TilingType: "+i);const c=t[0],d=t[1],f=t[2],p=t[3],g=f-c,h=p-d,v=Ee.singularValueDecompose2dScale(this.matrix),b=Ee.singularValueDecompose2dScale(this.baseTransform),_=v[0]*b[0],C=v[1]*b[1];let E=g,k=h,H=!1,T=!1;const A=Math.ceil(l*_),B=Math.ceil(u*C),z=Math.ceil(g*_),y=Math.ceil(h*C);A>=z?E=l:H=!0,B>=y?k=u:T=!0;const S=this.getSizeAndScale(E,this.ctx.canvas.width,_),L=this.getSizeAndScale(k,this.ctx.canvas.height,C),N=e.cachedCanvases.getCanvas("pattern",S.size,L.size),D=N.context,M=o.createCanvasGraphics(D);if(M.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(M,r,s),D.translate(-S.scale*c,-L.scale*d),M.transform(S.scale,0,0,L.scale,0,0),D.save(),this.clipBbox(M,c,d,f,p),M.baseTransform=Ct(M.ctx),M.executeOperatorList(n),M.endDrawing(),D.restore(),H||T){const x=N.canvas;H&&(E=l),T&&(k=u);const j=this.getSizeAndScale(E,this.ctx.canvas.width,_),U=this.getSizeAndScale(k,this.ctx.canvas.height,C),J=j.size,Q=U.size,X=e.cachedCanvases.getCanvas("pattern-workaround",J,Q),q=X.context,re=H?Math.floor(g/l):0,oe=T?Math.floor(h/u):0;for(let Ae=0;Ae<=re;Ae++)for(let te=0;te<=oe;te++)q.drawImage(x,J*Ae,Q*te,J,Q,0,0,J,Q);return{canvas:X.canvas,scaleX:j.scale,scaleY:U.scale,offsetX:c,offsetY:d}}return{canvas:N.canvas,scaleX:S.scale,scaleY:L.scale,offsetX:c,offsetY:d}}getSizeAndScale(e,t,n){const r=Math.max(Ts.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*n);return i>=r?i=r:n=i/e,{scale:n,size:i}}clipBbox(e,t,n,r,i){const s=r-t,o=i-n;e.ctx.rect(t,n,s,o),e.current.updateRectMinMax(Ct(e.ctx),[t,n,r,i]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const r=e.ctx,i=e.current;switch(t){case ca.COLORED:const s=this.ctx;r.fillStyle=s.fillStyle,r.strokeStyle=s.strokeStyle,i.fillColor=s.fillStyle,i.strokeColor=s.strokeStyle;break;case ca.UNCOLORED:const o=Ee.makeHexColor(n[0],n[1],n[2]);r.fillStyle=o,r.strokeStyle=o,i.fillColor=o,i.strokeColor=o;break;default:throw new ec(`Unsupported paint type: ${t}`)}}getPattern(e,t,n,r){let i=n;r!==Qt.SHADING&&(i=Ee.transform(i,t.baseTransform),this.matrix&&(i=Ee.transform(i,this.matrix)));const s=this.createPatternCanvas(t);let o=new DOMMatrix(i);o=o.translate(s.offsetX,s.offsetY),o=o.scale(1/s.scaleX,1/s.scaleY);const l=e.createPattern(s.canvas,"repeat");return l.setTransform(o),l}}function Mc({src:a,srcPos:e=0,dest:t,width:n,height:r,nonBlackColor:i=4294967295,inverseDecode:s=!1}){const o=rn.isLittleEndian?4278190080:255,[l,u]=s?[i,o]:[o,i],c=n>>3,d=n&7,f=a.length;t=new Uint32Array(t.buffer);let p=0;for(let g=0;g<r;g++){for(const v=e+c;e<v;e++){const b=e<f?a[e]:255;t[p++]=b&128?u:l,t[p++]=b&64?u:l,t[p++]=b&32?u:l,t[p++]=b&16?u:l,t[p++]=b&8?u:l,t[p++]=b&4?u:l,t[p++]=b&2?u:l,t[p++]=b&1?u:l}if(d===0)continue;const h=e<f?a[e++]:255;for(let v=0;v<d;v++)t[p++]=h&1<<7-v?u:l}return{srcPos:e,destPos:p}}const ua=16,ha=100,Tc=15,da=10,fa=1e3,ln=16;function Rc(a,e){if(a._removeMirroring)throw new Error("Context is already forwarding operations.");a.__originalSave=a.save,a.__originalRestore=a.restore,a.__originalRotate=a.rotate,a.__originalScale=a.scale,a.__originalTranslate=a.translate,a.__originalTransform=a.transform,a.__originalSetTransform=a.setTransform,a.__originalResetTransform=a.resetTransform,a.__originalClip=a.clip,a.__originalMoveTo=a.moveTo,a.__originalLineTo=a.lineTo,a.__originalBezierCurveTo=a.bezierCurveTo,a.__originalRect=a.rect,a.__originalClosePath=a.closePath,a.__originalBeginPath=a.beginPath,a._removeMirroring=()=>{a.save=a.__originalSave,a.restore=a.__originalRestore,a.rotate=a.__originalRotate,a.scale=a.__originalScale,a.translate=a.__originalTranslate,a.transform=a.__originalTransform,a.setTransform=a.__originalSetTransform,a.resetTransform=a.__originalResetTransform,a.clip=a.__originalClip,a.moveTo=a.__originalMoveTo,a.lineTo=a.__originalLineTo,a.bezierCurveTo=a.__originalBezierCurveTo,a.rect=a.__originalRect,a.closePath=a.__originalClosePath,a.beginPath=a.__originalBeginPath,delete a._removeMirroring},a.save=function(){e.save(),this.__originalSave()},a.restore=function(){e.restore(),this.__originalRestore()},a.translate=function(n,r){e.translate(n,r),this.__originalTranslate(n,r)},a.scale=function(n,r){e.scale(n,r),this.__originalScale(n,r)},a.transform=function(n,r,i,s,o,l){e.transform(n,r,i,s,o,l),this.__originalTransform(n,r,i,s,o,l)},a.setTransform=function(n,r,i,s,o,l){e.setTransform(n,r,i,s,o,l),this.__originalSetTransform(n,r,i,s,o,l)},a.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},a.rotate=function(n){e.rotate(n),this.__originalRotate(n)},a.clip=function(n){e.clip(n),this.__originalClip(n)},a.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},a.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},a.bezierCurveTo=function(t,n,r,i,s,o){e.bezierCurveTo(t,n,r,i,s,o),this.__originalBezierCurveTo(t,n,r,i,s,o)},a.rect=function(t,n,r,i){e.rect(t,n,r,i),this.__originalRect(t,n,r,i)},a.closePath=function(){e.closePath(),this.__originalClosePath()},a.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Lc{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,n)):(r=this.canvasFactory.create(t,n),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Ji(a,e,t,n,r,i,s,o,l,u){const[c,d,f,p,g,h]=Ct(a);if(d===0&&f===0){const _=s*c+g,C=Math.round(_),E=o*p+h,k=Math.round(E),H=(s+l)*c+g,T=Math.abs(Math.round(H)-C)||1,A=(o+u)*p+h,B=Math.abs(Math.round(A)-k)||1;return a.setTransform(Math.sign(c),0,0,Math.sign(p),C,k),a.drawImage(e,t,n,r,i,0,0,T,B),a.setTransform(c,d,f,p,g,h),[T,B]}if(c===0&&p===0){const _=o*f+g,C=Math.round(_),E=s*d+h,k=Math.round(E),H=(o+u)*f+g,T=Math.abs(Math.round(H)-C)||1,A=(s+l)*d+h,B=Math.abs(Math.round(A)-k)||1;return a.setTransform(0,Math.sign(d),Math.sign(f),0,C,k),a.drawImage(e,t,n,r,i,0,0,B,T),a.setTransform(c,d,f,p,g,h),[B,T]}a.drawImage(e,t,n,r,i,s,o,l,u);const v=Math.hypot(c,d),b=Math.hypot(f,p);return[v*l,b*u]}function Ic(a){const{width:e,height:t}=a;if(e>fa||t>fa)return null;const n=1e3,r=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),i=e+1;let s=new Uint8Array(i*(t+1)),o,l,u;const c=e+7&-8;let d=new Uint8Array(c*t),f=0;for(const b of a.data){let _=128;for(;_>0;)d[f++]=b&_?0:255,_>>=1}let p=0;for(f=0,d[f]!==0&&(s[0]=1,++p),l=1;l<e;l++)d[f]!==d[f+1]&&(s[l]=d[f]?2:1,++p),f++;for(d[f]!==0&&(s[l]=2,++p),o=1;o<t;o++){f=o*c,u=o*i,d[f-c]!==d[f]&&(s[u]=d[f]?1:8,++p);let b=(d[f]?4:0)+(d[f-c]?8:0);for(l=1;l<e;l++)b=(b>>2)+(d[f+1]?4:0)+(d[f-c+1]?8:0),r[b]&&(s[u+l]=r[b],++p),f++;if(d[f-c]!==d[f]&&(s[u+l]=d[f]?2:4,++p),p>n)return null}for(f=c*(t-1),u=o*i,d[f]!==0&&(s[u]=8,++p),l=1;l<e;l++)d[f]!==d[f+1]&&(s[u+l]=d[f]?4:8,++p),f++;if(d[f]!==0&&(s[u+l]=4,++p),p>n)return null;const g=new Int32Array([0,i,-1,0,-i,0,0,0,1]),h=new Path2D;for(o=0;p&&o<=t;o++){let b=o*i;const _=b+e;for(;b<_&&!s[b];)b++;if(b===_)continue;h.moveTo(b%i,o);const C=b;let E=s[b];do{const k=g[E];do b+=k;while(!s[b]);const H=s[b];H!==5&&H!==10?(E=H,s[b]=0):(E=H&51*E>>4,s[b]&=E>>2|E<<2),h.lineTo(b%i,b/i|0),s[b]||--p}while(C!==b);--o}return d=null,s=null,function(b){b.save(),b.scale(1/e,-1/t),b.translate(0,-t),b.fill(h),b.beginPath(),b.restore()}}class pa{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=ao,this.textMatrixScale=1,this.fontMatrix=fs,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Jt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,n){[t,n]=Ee.applyTransform([t,n],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(e,t){const n=Ee.applyTransform(t,e),r=Ee.applyTransform(t.slice(2),e),i=Ee.applyTransform([t[0],t[3]],e),s=Ee.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,n[0],r[0],i[0],s[0]),this.minY=Math.min(this.minY,n[1],r[1],i[1],s[1]),this.maxX=Math.max(this.maxX,n[0],r[0],i[0],s[0]),this.maxY=Math.max(this.maxY,n[1],r[1],i[1],s[1])}updateScalingPathMinMax(e,t){Ee.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,n,r,i,s,o,l,u,c){const d=Ee.bezierBoundingBox(t,n,r,i,s,o,l,u,c);c||this.updateRectMinMax(e,d)}getPathBoundingBox(e=Qt.FILL,t=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(e===Qt.STROKE){t||dt("Stroke bounding box must include transform.");const r=Ee.singularValueDecompose2dScale(t),i=r[0]*this.lineWidth/2,s=r[1]*this.lineWidth/2;n[0]-=i,n[1]-=s,n[2]+=i,n[3]+=s}return n}updateClipFromPath(){const e=Ee.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Qt.FILL,t=null){return Ee.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function ga(a,e){if(e instanceof ImageData){a.putImageData(e,0,0);return}const t=e.height,n=e.width,r=t%ln,i=(t-r)/ln,s=r===0?i:i+1,o=a.createImageData(n,ln);let l=0,u;const c=e.data,d=o.data;let f,p,g,h;if(e.kind===rr.GRAYSCALE_1BPP){const v=c.byteLength,b=new Uint32Array(d.buffer,0,d.byteLength>>2),_=b.length,C=n+7>>3,E=4294967295,k=rn.isLittleEndian?4278190080:255;for(f=0;f<s;f++){for(g=f<i?ln:r,u=0,p=0;p<g;p++){const H=v-l;let T=0;const A=H>C?n:H*8-7,B=A&-8;let z=0,y=0;for(;T<B;T+=8)y=c[l++],b[u++]=y&128?E:k,b[u++]=y&64?E:k,b[u++]=y&32?E:k,b[u++]=y&16?E:k,b[u++]=y&8?E:k,b[u++]=y&4?E:k,b[u++]=y&2?E:k,b[u++]=y&1?E:k;for(;T<A;T++)z===0&&(y=c[l++],z=128),b[u++]=y&z?E:k,z>>=1}for(;u<_;)b[u++]=0;a.putImageData(o,0,f*ln)}}else if(e.kind===rr.RGBA_32BPP){for(p=0,h=n*ln*4,f=0;f<i;f++)d.set(c.subarray(l,l+h)),l+=h,a.putImageData(o,0,p),p+=ln;f<s&&(h=n*r*4,d.set(c.subarray(l,l+h)),a.putImageData(o,0,p))}else if(e.kind===rr.RGB_24BPP)for(g=ln,h=n*g,f=0;f<s;f++){for(f>=i&&(g=r,h=n*g),u=0,p=h;p--;)d[u++]=c[l++],d[u++]=c[l++],d[u++]=c[l++],d[u++]=255;a.putImageData(o,0,f*ln)}else throw new Error(`bad image kind: ${e.kind}`)}function ma(a,e){if(e.bitmap){a.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,r=t%ln,i=(t-r)/ln,s=r===0?i:i+1,o=a.createImageData(n,ln);let l=0;const u=e.data,c=o.data;for(let d=0;d<s;d++){const f=d<i?ln:r;({srcPos:l}=Mc({src:u,srcPos:l,dest:c,width:n,height:f,nonBlackColor:0})),a.putImageData(o,0,d*ln)}}function Ai(a,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)a[n]!==void 0&&(e[n]=a[n]);a.setLineDash!==void 0&&(e.setLineDash(a.getLineDash()),e.lineDashOffset=a.lineDashOffset)}function Qi(a){if(a.strokeStyle=a.fillStyle="#000000",a.fillRule="nonzero",a.globalAlpha=1,a.lineWidth=1,a.lineCap="butt",a.lineJoin="miter",a.miterLimit=10,a.globalCompositeOperation="source-over",a.font="10px sans-serif",a.setLineDash!==void 0&&(a.setLineDash([]),a.lineDashOffset=0),!en){const{filter:e}=a;e!=="none"&&e!==""&&(a.filter="none")}}function va(a,e){if(e)return!0;const t=Ee.singularValueDecompose2dScale(a);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const n=Math.fround((globalThis.devicePixelRatio||1)*mi.PDF_TO_CSS_UNITS);return t[0]<=n&&t[1]<=n}const Dc=["butt","round","square"],Fc=["miter","round","bevel"],Oc={},ba={};class di{constructor(e,t,n,r,i,{optionalContentConfig:s,markedContentStack:o=null},l,u){this.ctx=e,this.current=new pa(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=r,this.filterFactory=i,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=s,this.cachedCanvases=new Lc(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:r=null}){const i=this.ctx.canvas.width,s=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,i,s),this.ctx.fillStyle=o,n){const l=this.cachedCanvases.getCanvas("transparent",i,s);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Ct(this.compositeCtx))}this.ctx.save(),Qi(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Ct(this.ctx)}executeOperatorList(e,t,n,r){const i=e.argsArray,s=e.fnArray;let o=t||0;const l=i.length;if(l===o)return o;const u=l-o>da&&typeof n=="function",c=u?Date.now()+Tc:0;let d=0;const f=this.commonObjs,p=this.objs;let g;for(;;){if(r!==void 0&&o===r.nextBreakPoint)return r.breakIt(o,n),o;if(g=s[o],g!==_n.dependency)this[g].apply(this,i[o]);else for(const h of i[o]){const v=h.startsWith("g_")?f:p;if(!v.has(h))return v.get(h,n),o}if(o++,o===l)return o;if(u&&++d>da){if(Date.now()>c)return n(),o;d=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const n=e.width??e.displayWidth,r=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),s=Math.max(Math.hypot(t[2],t[3]),1),o=n,l=r,u="prescale1",c,d;for(;i>2&&o>1||s>2&&l>1;){let f=o,p=l;i>2&&o>1&&(f=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),i/=o/f),s>2&&l>1&&(p=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,s/=l/p),c=this.cachedCanvases.getCanvas(u,f,p),d=c.context,d.clearRect(0,0,f,p),d.drawImage(e,0,0,o,l,0,0,f,p),e=c.canvas,o=f,l=p,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:n,height:r}=e,i=this.current.fillColor,s=this.current.patternFill,o=Ct(t);let l,u,c,d;if((e.bitmap||e.data)&&e.count>1){const A=e.bitmap||e.data.buffer;u=JSON.stringify(s?o:[o.slice(0,4),i]),l=this._cachedBitmapsMap.get(A),l||(l=new Map,this._cachedBitmapsMap.set(A,l));const B=l.get(u);if(B&&!s){const z=Math.round(Math.min(o[0],o[2])+o[4]),y=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:B,offsetX:z,offsetY:y}}c=B}c||(d=this.cachedCanvases.getCanvas("maskCanvas",n,r),ma(d.context,e));let f=Ee.transform(o,[1/n,0,0,-1/r,0,0]);f=Ee.transform(f,[1,0,0,1,0,-r]);const[p,g,h,v]=Ee.getAxialAlignedBoundingBox([0,0,n,r],f),b=Math.round(h-p)||1,_=Math.round(v-g)||1,C=this.cachedCanvases.getCanvas("fillCanvas",b,_),E=C.context,k=p,H=g;E.translate(-k,-H),E.transform(...f),c||(c=this._scaleImage(d.canvas,Sn(E)),c=c.img,l&&s&&l.set(u,c)),E.imageSmoothingEnabled=va(Ct(E),e.interpolate),Ji(E,c,0,0,c.width,c.height,0,0,n,r),E.globalCompositeOperation="source-in";const T=Ee.transform(Sn(E),[1,0,0,1,-k,-H]);return E.fillStyle=s?i.getPattern(t,this,T,Qt.FILL):i,E.fillRect(0,0,n,r),l&&!s&&(this.cachedCanvases.delete("fillCanvas"),l.set(u,C.canvas)),{canvas:C.canvas,offsetX:Math.round(k),offsetY:Math.round(H)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=Dc[e]}setLineJoin(e){this.ctx.lineJoin=Fc[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx,this.ctx=r.context;const i=this.ctx;i.setTransform(...Ct(this.suspendedCtx)),Ai(this.suspendedCtx,i),Rc(i,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Ai(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,r){const i=r[0],s=r[1],o=r[2]-i,l=r[3]-s;o===0||l===0||(this.genericComposeSMask(t.context,n,o,l,t.subtype,t.backdrop,t.transferMap,i,s,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,r,i,s,o,l,u,c,d){let f=e.canvas,p=l-c,g=u-d;if(s){const v=Ee.makeHexColor(...s);if(p<0||g<0||p+n>f.width||g+r>f.height){const b=this.cachedCanvases.getCanvas("maskExtension",n,r),_=b.context;_.drawImage(f,-p,-g),_.globalCompositeOperation="destination-atop",_.fillStyle=v,_.fillRect(0,0,n,r),_.globalCompositeOperation="source-over",f=b.canvas,p=g=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const b=new Path2D;b.rect(p,g,n,r),e.clip(b),e.globalCompositeOperation="destination-atop",e.fillStyle=v,e.fillRect(p,g,n,r),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const h=new Path2D;h.rect(l,u,n,r),t.clip(h),t.globalCompositeOperation="destination-in",t.drawImage(f,p,g,n,r,l,u,n,r),t.restore()}save(){this.inSMaskMode?(Ai(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Ai(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,n,r,i,s){this.ctx.transform(e,t,n,r,i,s),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){const r=this.ctx,i=this.current;let s=i.x,o=i.y,l,u;const c=Ct(r),d=c[0]===0&&c[3]===0||c[1]===0&&c[2]===0,f=d?n.slice(0):null;for(let p=0,g=0,h=e.length;p<h;p++)switch(e[p]|0){case _n.rectangle:s=t[g++],o=t[g++];const v=t[g++],b=t[g++],_=s+v,C=o+b;r.moveTo(s,o),v===0||b===0?r.lineTo(_,C):(r.lineTo(_,o),r.lineTo(_,C),r.lineTo(s,C)),d||i.updateRectMinMax(c,[s,o,_,C]),r.closePath();break;case _n.moveTo:s=t[g++],o=t[g++],r.moveTo(s,o),d||i.updatePathMinMax(c,s,o);break;case _n.lineTo:s=t[g++],o=t[g++],r.lineTo(s,o),d||i.updatePathMinMax(c,s,o);break;case _n.curveTo:l=s,u=o,s=t[g+4],o=t[g+5],r.bezierCurveTo(t[g],t[g+1],t[g+2],t[g+3],s,o),i.updateCurvePathMinMax(c,l,u,t[g],t[g+1],t[g+2],t[g+3],s,o,f),g+=6;break;case _n.curveTo2:l=s,u=o,r.bezierCurveTo(s,o,t[g],t[g+1],t[g+2],t[g+3]),i.updateCurvePathMinMax(c,l,u,s,o,t[g],t[g+1],t[g+2],t[g+3],f),s=t[g+2],o=t[g+3],g+=4;break;case _n.curveTo3:l=s,u=o,s=t[g+2],o=t[g+3],r.bezierCurveTo(t[g],t[g+1],s,o,s,o),i.updateCurvePathMinMax(c,l,u,t[g],t[g+1],s,o,s,o,f),g+=4;break;case _n.closePath:r.closePath();break}d&&i.updateScalingPathMinMax(c,f),i.setCurrentPoint(s,o)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,n=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof n=="object"&&n?.getPattern?(t.save(),t.strokeStyle=n.getPattern(t,this,Sn(t),Qt.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,n=this.current.fillColor,r=this.current.patternFill;let i=!1;r&&(t.save(),t.fillStyle=n.getPattern(t,this,Sn(t),Qt.FILL),i=!0);const s=this.current.getClippedPathBoundingBox();this.contentVisible&&s!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),i&&t.restore(),e&&this.consumePath(s)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Oc}eoClip(){this.pendingClip=ba}beginText(){this.current.textMatrix=ao,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const n=new Path2D,r=t.getTransform().invertSelf();for(const{transform:i,x:s,y:o,fontSize:l,path:u}of e)n.addPath(u,new DOMMatrix(i).preMultiplySelf(r).translate(s,o).scale(l,-l));t.clip(n),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const n=this.commonObjs.get(e),r=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=n.fontMatrix||fs,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&He("Invalid font matrix for font "+e),t<0?(t=-t,r.fontDirection=-1):r.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;const i=n.loadedName||"sans-serif",s=n.systemFontInfo?.css||`"${i}", ${n.fallbackName}`;let o="normal";n.black?o="900":n.bold&&(o="bold");const l=n.italic?"italic":"normal";let u=t;t<ua?u=ua:t>ha&&(u=ha),this.current.fontSizeScale=t/u,this.ctx.font=`${l} ${o} ${u}px ${s}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,n,r,i,s){this.current.textMatrix=[e,t,n,r,i,s],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#n(e,t,n){const r=new Path2D;return r.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),r}paintChar(e,t,n,r,i){const s=this.ctx,o=this.current,l=o.font,u=o.textRenderingMode,c=o.fontSize/o.fontSizeScale,d=u&Jt.FILL_STROKE_MASK,f=!!(u&Jt.ADD_TO_PATH_FLAG),p=o.patternFill&&!l.missingFile,g=o.patternStroke&&!l.missingFile;let h;if((l.disableFontFace||f||p||g)&&(h=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||p||g){if(s.save(),s.translate(t,n),s.scale(c,-c),d===Jt.FILL||d===Jt.FILL_STROKE)if(r){const v=s.getTransform();s.setTransform(...r),s.fill(this.#n(h,v,r))}else s.fill(h);if(d===Jt.STROKE||d===Jt.FILL_STROKE)if(i){const v=s.getTransform();s.setTransform(...i),s.stroke(this.#n(h,v,i))}else s.lineWidth/=c,s.stroke(h);s.restore()}else(d===Jt.FILL||d===Jt.FILL_STROKE)&&s.fillText(e,t,n),(d===Jt.STROKE||d===Jt.FILL_STROKE)&&s.strokeText(e,t,n);f&&(this.pendingTextPaths||=[]).push({transform:Ct(s),x:t,y:n,fontSize:c,path:h})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){n=!0;break}return We(this,"isFontSubpixelAAEnabled",n)}showText(e){const t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);const r=t.fontSize;if(r===0)return;const i=this.ctx,s=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,u=t.fontDirection,c=t.textHScale*u,d=e.length,f=n.vertical,p=f?1:-1,g=n.defaultVMetrics,h=r*t.fontMatrix[0],v=t.textRenderingMode===Jt.FILL&&!n.disableFontFace&&!t.patternFill;i.save(),i.transform(...t.textMatrix),i.translate(t.x,t.y+t.textRise),u>0?i.scale(c,-1):i.scale(c,1);let b,_;if(t.patternFill){i.save();const T=t.fillColor.getPattern(i,this,Sn(i),Qt.FILL);b=Ct(i),i.restore(),i.fillStyle=T}if(t.patternStroke){i.save();const T=t.strokeColor.getPattern(i,this,Sn(i),Qt.STROKE);_=Ct(i),i.restore(),i.strokeStyle=T}let C=t.lineWidth;const E=t.textMatrixScale;if(E===0||C===0){const T=t.textRenderingMode&Jt.FILL_STROKE_MASK;(T===Jt.STROKE||T===Jt.FILL_STROKE)&&(C=this.getSinglePixelWidth())}else C/=E;if(s!==1&&(i.scale(s,s),C/=s),i.lineWidth=C,n.isInvalidPDFjsFont){const T=[];let A=0;for(const B of e)T.push(B.unicode),A+=B.width;i.fillText(T.join(""),0,0),t.x+=A*h*c,i.restore(),this.compose();return}let k=0,H;for(H=0;H<d;++H){const T=e[H];if(typeof T=="number"){k+=p*T*r/1e3;continue}let A=!1;const B=(T.isSpace?l:0)+o,z=T.fontChar,y=T.accent;let S,L,N=T.width;if(f){const M=T.vmetric||g,x=-(T.vmetric?M[1]:N*.5)*h,j=M[2]*h;N=M?-M[0]:N,S=x/s,L=(k+j)/s}else S=k/s,L=0;if(n.remeasure&&N>0){const M=i.measureText(z).width*1e3/r*s;if(N<M&&this.isFontSubpixelAAEnabled){const x=N/M;A=!0,i.save(),i.scale(x,1),S/=x}else N!==M&&(S+=(N-M)/2e3*r/s)}if(this.contentVisible&&(T.isInFont||n.missingFile)){if(v&&!y)i.fillText(z,S,L);else if(this.paintChar(z,S,L,b,_),y){const M=S+r*y.offset.x/s,x=L-r*y.offset.y/s;this.paintChar(y.fontChar,M,x,b,_)}}const D=f?N*h-B*u:N*h+B*u;k+=D,A&&i.restore()}f?t.y-=k:t.x+=k*c,i.restore(),this.compose()}showType3Text(e){const t=this.ctx,n=this.current,r=n.font,i=n.fontSize,s=n.fontDirection,o=r.vertical?1:-1,l=n.charSpacing,u=n.wordSpacing,c=n.textHScale*s,d=n.fontMatrix||fs,f=e.length,p=n.textRenderingMode===Jt.INVISIBLE;let g,h,v,b;if(!(p||i===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...n.textMatrix),t.translate(n.x,n.y),t.scale(c,s),g=0;g<f;++g){if(h=e[g],typeof h=="number"){b=o*h*i/1e3,this.ctx.translate(b,0),n.x+=b*c;continue}const _=(h.isSpace?u:0)+l,C=r.charProcOperatorList[h.operatorListId];if(!C){He(`Type3 character "${h.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=h,this.save(),t.scale(i,i),t.transform(...d),this.executeOperatorList(C),this.restore()),v=Ee.applyTransform([h.width,0],d)[0]*i+_,t.translate(v,0),n.x+=v*c}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,r,i,s){this.ctx.rect(n,r,i-n,s-r),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const n=e[1],r=this.baseTransform||Ct(this.ctx),i={createCanvasGraphics:s=>new di(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new Ts(e,n,this.ctx,i,r)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,n){this.ctx.strokeStyle=this.current.strokeColor=Ee.makeHexColor(e,t,n),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,n){this.ctx.fillStyle=this.current.fillColor=Ee.makeHexColor(e,t,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=xc(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,Sn(t),Qt.SHADING);const r=Sn(t);if(r){const{width:i,height:s}=t.canvas,[o,l,u,c]=Ee.getAxialAlignedBoundingBox([0,0,i,s],r);this.ctx.fillRect(o,l,u-o,c-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){dt("Should not call beginInlineImage")}beginImageData(){dt("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Ct(this.ctx),t)){const n=t[2]-t[0],r=t[3]-t[1];this.ctx.rect(t[0],t[1],n,r),this.current.updateRectMinMax(Ct(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||dr("TODO: Support non-isolated groups."),e.knockout&&He("Knockout groups not supported.");const n=Ct(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=Ee.getAxialAlignedBoundingBox(e.bbox,Ct(t));const i=[0,0,t.canvas.width,t.canvas.height];r=Ee.intersect(r,i)||[0,0,0,0];const s=Math.floor(r[0]),o=Math.floor(r[1]),l=Math.max(Math.ceil(r[2])-s,1),u=Math.max(Math.ceil(r[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,u]);let c="groupAt"+this.groupLevel;e.smask&&(c+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(c,l,u),f=d.context;f.translate(-s,-o),f.transform(...n),e.smask?this.smaskStack.push({canvas:d.canvas,context:f,offsetX:s,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(s,o),t.save()),Ai(t,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const r=Ct(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...r);const i=Ee.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],r);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(i)}}beginAnnotation(e,t,n,r,i){if(this.#e(),Qi(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const s=t[2]-t[0],o=t[3]-t[1];if(i&&this.annotationCanvasMap){n=n.slice(),n[4]-=t[0],n[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=s,t[3]=o;const[l,u]=Ee.singularValueDecompose2dScale(Ct(this.ctx)),{viewportScale:c}=this,d=Math.ceil(s*this.outputScaleX*c),f=Math.ceil(o*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(d,f);const{canvas:p,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(e,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(l,0,0,-u,0,o*u),Qi(this.ctx)}else Qi(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],s,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new pa(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const n=this.ctx,r=this.processingType3;if(r&&(r.compiled===void 0&&(r.compiled=Ic(e)),r.compiled)){r.compiled(n);return}const i=this._createMaskCanvas(e),s=i.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(s,i.offsetX,i.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,r=0,i,s){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const l=Ct(o);o.transform(t,n,r,i,0,0);const u=this._createMaskCanvas(e);o.setTransform(1,0,0,1,u.offsetX-l[4],u.offsetY-l[5]);for(let c=0,d=s.length;c<d;c+=2){const f=Ee.transform(l,[t,n,r,i,s[c],s[c+1]]),[p,g]=Ee.applyTransform([0,0],f);o.drawImage(u.canvas,p,g)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,n=this.current.fillColor,r=this.current.patternFill;for(const i of e){const{data:s,width:o,height:l,transform:u}=i,c=this.cachedCanvases.getCanvas("maskCanvas",o,l),d=c.context;d.save();const f=this.getObject(s,i);ma(d,f),d.globalCompositeOperation="source-in",d.fillStyle=r?n.getPattern(d,this,Sn(t),Qt.FILL):n,d.fillRect(0,0,o,l),d.restore(),t.save(),t.transform(...u),t.scale(1,-1),Ji(t,c.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){He("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,n,r){if(!this.contentVisible)return;const i=this.getObject(e);if(!i){He("Dependent image isn't ready yet");return}const s=i.width,o=i.height,l=[];for(let u=0,c=r.length;u<c;u+=2)l.push({transform:[t,0,0,n,r[u],r[u+1]],x:0,y:0,w:s,h:o});this.paintInlineImageXObjectGroup(i,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:r}=e,i=this.cachedCanvases.getCanvas("inlineImage",n,r),s=i.context;return s.filter=this.current.transferMaps,s.drawImage(t,0,0),s.filter="none",i.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,n=e.height,r=this.ctx;if(this.save(),!en){const{filter:o}=r;o!=="none"&&o!==""&&(r.filter="none")}r.scale(1/t,-1/n);let i;if(e.bitmap)i=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)i=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",t,n).context;ga(l,e),i=this.applyTransferMapsToCanvas(l)}const s=this._scaleImage(i,Sn(r));r.imageSmoothingEnabled=va(Ct(r),e.interpolate),Ji(r,s.img,0,0,s.paintWidth,s.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const i=e.width,s=e.height,l=this.cachedCanvases.getCanvas("inlineImage",i,s).context;ga(l,e),r=this.applyTransferMapsToCanvas(l)}for(const i of t)n.save(),n.transform(...i.transform),n.scale(1,-1),Ji(n,r,i.x,i.y,i.w,i.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const n=this.ctx;this.pendingClip&&(t||(this.pendingClip===ba?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Ct(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:r,d:i}=this.ctx.getTransform();let s,o;if(n===0&&r===0){const l=Math.abs(t),u=Math.abs(i);if(l===u)if(e===0)s=o=1/l;else{const c=l*e;s=o=c<1?1/c:1}else if(e===0)s=1/l,o=1/u;else{const c=l*e,d=u*e;s=c<1?1/c:1,o=d<1?1/d:1}}else{const l=Math.abs(t*i-n*r),u=Math.hypot(t,n),c=Math.hypot(r,i);if(e===0)s=c/l,o=u/l;else{const d=e*l;s=c>d?c/d:1,o=u>d?u/d:1}}this._cachedScaleForStroking[0]=s,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:n}=this.current,[r,i]=this.getScaleForStroking();if(t.lineWidth=n||1,r===1&&i===1){t.stroke();return}const s=t.getLineDash();if(e&&t.save(),t.scale(r,i),s.length>0){const o=Math.max(r,i);t.setLineDash(s.map(l=>l/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const a in _n)di.prototype[a]!==void 0&&(di.prototype[_n[a]]=di.prototype[a]);class Ni{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class Nc{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}getAll(){return ys(this.#e)}has(e){return this.#e.has(e)}}const ui=Symbol("INTERNAL");class Bc{#e=!1;#t=!1;#n=!1;#i=!0;constructor(e,{name:t,intent:n,usage:r,rbGroups:i}){this.#e=!!(e&hn.DISPLAY),this.#t=!!(e&hn.PRINT),this.name=t,this.intent=n,this.usage=r,this.rbGroups=i}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,n=!1){e!==ui&&dt("Internal method `_setVisible` called."),this.#n=n,this.#i=t}}class zc{#e=null;#t=new Map;#n=null;#i=null;constructor(e,t=hn.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#i=e.order;for(const n of e.groups)this.#t.set(n.id,new Bc(t,n));if(e.baseState==="OFF")for(const n of this.#t.values())n._setVisible(ui,!1);for(const n of e.on)this.#t.get(n)._setVisible(ui,!0);for(const n of e.off)this.#t.get(n)._setVisible(ui,!1);this.#n=this.getHash()}}#s(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let r=1;r<t;r++){const i=e[r];let s;if(Array.isArray(i))s=this.#s(i);else if(this.#t.has(i))s=this.#t.get(i).visible;else return He(`Optional content group not found: ${i}`),!0;switch(n){case"And":if(!s)return!1;break;case"Or":if(s)return!0;break;case"Not":return!s;default:return!0}}return n==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return dr("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(He(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#s(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return He(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return He(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return He(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return He(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return He(`Unknown optional content policy ${e.policy}.`),!0}return He(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){const r=this.#t.get(e);if(!r){He(`Optional content group not found: ${e}`);return}if(n&&t&&r.rbGroups.length)for(const i of r.rbGroups)for(const s of i)s!==e&&this.#t.get(s)?._setVisible(ui,!1,!0);r._setVisible(ui,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let n;for(const r of e){switch(r){case"ON":case"OFF":case"Toggle":n=r;continue}const i=this.#t.get(r);if(i)switch(n){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!i.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#i?this.#i.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?ys(this.#t):null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new co;for(const[t,n]of this.#t)e.update(`${t}:${n.visible}`);return this.#e=e.hexdigest()}}class Hc{constructor(e,{disableRange:t=!1,disableStream:n=!1}){Vt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:i,progressiveDone:s,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=s,this._contentDispositionFilename=o,i?.length>0){const l=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,u)=>{this._onReceiveData({begin:l,chunk:u})}),e.addProgressListener((l,u)=>{this._onProgress({loaded:l,total:u})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const r=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(n),!0)});Vt(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Vt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new jc(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Vc(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class jc{constructor(e,t,n=!1,r=null){this._stream=e,this._done=n||!1,this._filename=As(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Vc{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Wc(a){let e=!0,t=n("filename\\*","i").exec(a);if(t){t=t[1];let c=o(t);return c=unescape(c),c=l(c),c=u(c),i(c)}if(t=s(a),t){const c=u(t);return i(c)}if(t=n("filename","i").exec(a),t){t=t[1];let c=o(t);return c=u(c),i(c)}function n(c,d){return new RegExp("(?:^|;)\\s*"+c+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function r(c,d){if(c){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const f=new TextDecoder(c,{fatal:!0}),p=fr(d);d=f.decode(p),e=!1}catch{}}return d}function i(c){return e&&/[\x80-\xff]/.test(c)&&(c=r("utf-8",c),e&&(c=r("iso-8859-1",c))),c}function s(c){const d=[];let f;const p=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(c))!==null;){let[,h,v,b]=f;if(h=parseInt(h,10),h in d){if(h===0)break;continue}d[h]=[v,b]}const g=[];for(let h=0;h<d.length&&h in d;++h){let[v,b]=d[h];b=o(b),v&&(b=unescape(b),h===0&&(b=l(b))),g.push(b)}return g.join("")}function o(c){if(c.startsWith('"')){const d=c.slice(1).split('\\"');for(let f=0;f<d.length;++f){const p=d[f].indexOf('"');p!==-1&&(d[f]=d[f].slice(0,p),d.length=f+1),d[f]=d[f].replaceAll(/\\(.)/g,"$1")}c=d.join('"')}return c}function l(c){const d=c.indexOf("'");if(d===-1)return c;const f=c.slice(0,d),g=c.slice(d+1).replace(/^[^']*'/,"");return r(f,g)}function u(c){return!c.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(c)?c:c.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,f,p,g){if(p==="q"||p==="Q")return g=g.replaceAll("_"," "),g=g.replaceAll(/=([0-9a-fA-F]{2})/g,function(h,v){return String.fromCharCode(parseInt(v,16))}),r(f,g);try{g=atob(g)}catch{}return r(f,g)})}return""}function _o(a,e){const t=new Headers;if(!a||!e||typeof e!="object")return t;for(const n in e){const r=e[n];r!==void 0&&t.append(n,r)}return t}function vr(a){try{return new URL(a).origin}catch{}return null}function wo({responseHeaders:a,isHttp:e,rangeChunkSize:t,disableRange:n}){const r={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(a.get("Content-Length"),10);return!Number.isInteger(i)||(r.suggestedLength=i,i<=2*t)||n||!e||a.get("Accept-Ranges")!=="bytes"||(a.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function yo(a){const e=a.get("Content-Disposition");if(e){let t=Wc(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(As(t))return t}return null}function br(a,e){return a===404||a===0&&e.startsWith("file:")?new Bi('Missing PDF "'+e+'".'):new or(`Unexpected server response (${a}) while retrieving PDF "${e}".`,a)}function Eo(a){return a===200||a===206}function So(a,e,t){return{method:"GET",headers:a,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function Ao(a){return a instanceof Uint8Array?a.buffer:a instanceof ArrayBuffer?a:(He(`getArrayBuffer - unexpected data format: ${a}`),new Uint8Array(a).buffer)}class _a{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=_o(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Vt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new $c(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Gc(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class $c{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),r=t.url;fetch(r,So(n,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=vr(i.url),!Eo(i.status))throw br(i.status,r);this._reader=i.body.getReader(),this._headersCapability.resolve();const s=i.headers,{allowRangeRequests:o,suggestedLength:l}=wo({responseHeaders:s,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=yo(s),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new zn("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Ao(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class Gc{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${n-1}`);const s=r.url;fetch(s,So(i,this._withCredentials,this._abortController)).then(o=>{const l=vr(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!Eo(o.status))throw br(o.status,s);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Ao(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const Gr=200,Ur=206;function Uc(a){const e=a.response;return typeof e!="string"?e:fr(e).buffer}class qc{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:n}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=_o(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,r=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,s]of this.headers)t.setRequestHeader(i,s);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=Ur):r.expectedStatus=Gr,t.responseType="arraybuffer",Vt(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){const n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const r=n.xhr;if(r.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){n.onError(r.status);return}const i=r.status||Gr;if(!(i===Gr&&n.expectedStatus===Ur)&&i!==n.expectedStatus){n.onError(r.status);return}const o=Uc(r);if(i===Ur){const l=r.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);u?n.onDone({begin:parseInt(u[1],10),chunk:o}):(He('Missing or invalid "Content-Range" header.'),n.onError(0))}else o?n.onDone({begin:0,chunk:o}):n.onError(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class Xc{constructor(e){this._source=e,this._manager=new qc(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Vt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Kc(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new Yc(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class Kc{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=vr(t.responseURL);const n=t.getAllResponseHeaders(),r=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...u]=o.split(": ");return[l,u.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:s}=wo({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=yo(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=br(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Yc{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=vr(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=br(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Zc=/^[a-z][a-z0-9\-+.]+:/i;function Jc(a){if(Zc.test(a))return new URL(a);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(a))}class Qc{constructor(e){this.source=e,this.url=Jc(e.url),Vt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Vt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new eu(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new tu(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class eu{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=new Bi(`Missing PDF "${this._url}".`)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new zn("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class tu{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=e.source;this._isStreamingSupported=!r.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const nu=1e5,an=30,iu=.8;class nn{#e=Promise.withResolvers();#t=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#s=null;#r=null;#l=0;#o=0;#u=null;#c=null;#d=0;#h=0;#f=Object.create(null);#a=[];#p=null;#m=[];#g=new WeakMap;#v=null;static#w=new Map;static#b=new Map;static#y=new WeakMap;static#S=null;static#C=new Set;constructor({textContentSource:e,container:t,viewport:n}){if(e instanceof ReadableStream)this.#p=e;else if(typeof e=="object")this.#p=new ReadableStream({start(l){l.enqueue(e),l.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#c=t,this.#h=n.scale*(globalThis.devicePixelRatio||1),this.#d=n.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:i,pageX:s,pageY:o}=n.rawDims;this.#v=[1,0,0,-1,-s,o+i],this.#o=r,this.#l=i,nn.#R(),Yn(t,n),this.#e.promise.finally(()=>{nn.#C.delete(this),this.#r=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=rn.platform;return We(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#u.read().then(({value:t,done:n})=>{if(n){this.#e.resolve();return}this.#s??=t.lang,Object.assign(this.#f,t.styles),this.#k(t.items),e()},this.#e.reject)};return this.#u=this.#p.getReader(),nn.#C.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const n=e.scale*(globalThis.devicePixelRatio||1),r=e.rotation;if(r!==this.#d&&(t?.(),this.#d=r,Yn(this.#c,{rotation:r})),n!==this.#h){t?.(),this.#h=n;const i={div:null,properties:null,ctx:nn.#x(this.#s)};for(const s of this.#m)i.properties=this.#g.get(s),i.div=s,this.#E(i)}}cancel(){const e=new zn("TextLayer task cancelled.");this.#u?.cancel(e).catch(()=>{}),this.#u=null,this.#e.reject(e)}get textDivs(){return this.#m}get textContentItemsStr(){return this.#a}#k(e){if(this.#n)return;this.#r.ctx??=nn.#x(this.#s);const t=this.#m,n=this.#a;for(const r of e){if(t.length>nu){He("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const i=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),r.id!==null&&this.#t.setAttribute("id",`${r.id}`),i.append(this.#t)}else r.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}n.push(r.str),this.#M(r)}}#M(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#m.push(t);const r=Ee.transform(this.#v,e.transform);let i=Math.atan2(r[1],r[0]);const s=this.#f[e.fontName];s.vertical&&(i+=Math.PI/2);let o=this.#i&&s.fontSubstitution||s.fontFamily;o=nn.fontFamilyMap.get(o)||o;const l=Math.hypot(r[2],r[3]),u=l*nn.#D(o,this.#s);let c,d;i===0?(c=r[4],d=r[5]-u):(c=r[4]+u*Math.sin(i),d=r[5]-u*Math.cos(i));const f="calc(var(--scale-factor)*",p=t.style;this.#t===this.#c?(p.left=`${(100*c/this.#o).toFixed(2)}%`,p.top=`${(100*d/this.#l).toFixed(2)}%`):(p.left=`${f}${c.toFixed(2)}px)`,p.top=`${f}${d.toFixed(2)}px)`),p.fontSize=`${f}${(nn.#S*l).toFixed(2)}px)`,p.fontFamily=o,n.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#i&&(t.dataset.fontName=s.fontSubstitutionLoadedName||e.fontName),i!==0&&(n.angle=i*(180/Math.PI));let g=!1;if(e.str.length>1)g=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const h=Math.abs(e.transform[0]),v=Math.abs(e.transform[3]);h!==v&&Math.max(h,v)/Math.min(h,v)>1.5&&(g=!0)}if(g&&(n.canvasWidth=s.vertical?e.height:e.width),this.#g.set(t,n),this.#r.div=t,this.#r.properties=n,this.#E(this.#r),n.hasText&&this.#t.append(t),n.hasEOL){const h=document.createElement("br");h.setAttribute("role","presentation"),this.#t.append(h)}}#E(e){const{div:t,properties:n,ctx:r}=e,{style:i}=t;let s="";if(nn.#S>1&&(s=`scale(${1/nn.#S})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:o}=i,{canvasWidth:l,fontSize:u}=n;nn.#P(r,u*this.#h,o);const{width:c}=r.measureText(t.textContent);c>0&&(s=`scaleX(${l*this.#h/c}) ${s}`)}n.angle!==0&&(s=`rotate(${n.angle}deg) ${s}`),s.length>0&&(i.transform=s)}static cleanup(){if(!(this.#C.size>0)){this.#w.clear();for(const{canvas:e}of this.#b.values())e.remove();this.#b.clear()}}static#x(e=null){let t=this.#b.get(e||="");if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(e,t),this.#y.set(t,{size:0,family:""})}return t}static#P(e,t,n){const r=this.#y.get(e);t===r.size&&n===r.family||(e.font=`${t}px ${n}`,r.size=t,r.family=n)}static#R(){if(this.#S!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#S=e.getBoundingClientRect().height,e.remove()}static#D(e,t){const n=this.#w.get(e);if(n)return n;const r=this.#x(t);r.canvas.width=r.canvas.height=an,this.#P(r,an,e);const i=r.measureText("");let s=i.fontBoundingBoxAscent,o=Math.abs(i.fontBoundingBoxDescent);if(s){const c=s/(s+o);return this.#w.set(e,c),r.canvas.width=r.canvas.height=0,c}r.strokeStyle="red",r.clearRect(0,0,an,an),r.strokeText("g",0,0);let l=r.getImageData(0,0,an,an).data;o=0;for(let c=l.length-1-3;c>=0;c-=4)if(l[c]>0){o=Math.ceil(c/4/an);break}r.clearRect(0,0,an,an),r.strokeText("A",0,an),l=r.getImageData(0,0,an,an).data,s=0;for(let c=0,d=l.length;c<d;c+=4)if(l[c]>0){s=an-Math.floor(c/4/an);break}r.canvas.width=r.canvas.height=0;const u=s?s/(s+o):iu;return this.#w.set(e,u),u}}class zi{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function r(i){if(!i)return;let s=null;const o=i.name;if(o==="#text")s=i.value;else if(zi.shouldBuildText(o))i?.attributes?.textContent?s=i.attributes.textContent:i.value&&(s=i.value);else return;if(s!==null&&t.push({str:s}),!!i.children)for(const l of i.children)r(l)}return r(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const ru=65536,su=100,au=5e3,ou=en?yc:bc,lu=en?Ec:po,cu=en?wc:_c,uu=en?Sc:vo;function hu(a={}){typeof a=="string"||a instanceof URL?a={url:a}:(a instanceof ArrayBuffer||ArrayBuffer.isView(a))&&(a={data:a});const e=new Rs,{docId:t}=e,n=a.url?du(a.url):null,r=a.data?fu(a.data):null,i=a.httpHeaders||null,s=a.withCredentials===!0,o=a.password??null,l=a.range instanceof Co?a.range:null,u=Number.isInteger(a.rangeChunkSize)&&a.rangeChunkSize>0?a.rangeChunkSize:ru;let c=a.worker instanceof fi?a.worker:null;const d=a.verbosity,f=typeof a.docBaseUrl=="string"&&!gr(a.docBaseUrl)?a.docBaseUrl:null,p=typeof a.cMapUrl=="string"?a.cMapUrl:null,g=a.cMapPacked!==!1,h=a.CMapReaderFactory||lu,v=typeof a.standardFontDataUrl=="string"?a.standardFontDataUrl:null,b=a.StandardFontDataFactory||uu,_=a.stopAtErrors!==!0,C=Number.isInteger(a.maxImageSize)&&a.maxImageSize>-1?a.maxImageSize:-1,E=a.isEvalSupported!==!1,k=typeof a.isOffscreenCanvasSupported=="boolean"?a.isOffscreenCanvasSupported:!en,H=typeof a.isImageDecoderSupported=="boolean"?a.isImageDecoderSupported:!en&&(rn.platform.isFirefox||!globalThis.chrome),T=Number.isInteger(a.canvasMaxAreaInBytes)?a.canvasMaxAreaInBytes:-1,A=typeof a.disableFontFace=="boolean"?a.disableFontFace:en,B=a.fontExtraProperties===!0,z=a.enableXfa===!0,y=a.ownerDocument||globalThis.document,S=a.disableRange===!0,L=a.disableStream===!0,N=a.disableAutoFetch===!0,D=a.pdfBug===!0,M=a.CanvasFactory||ou,x=a.FilterFactory||cu,j=a.enableHWA===!0,U=l?l.length:a.length??NaN,J=typeof a.useSystemFonts=="boolean"?a.useSystemFonts:!en&&!A,Q=typeof a.useWorkerFetch=="boolean"?a.useWorkerFetch:h===po&&b===vo&&p&&v&&Ii(p,document.baseURI)&&Ii(v,document.baseURI),X=null;Yl(d);const q={canvasFactory:new M({ownerDocument:y,enableHWA:j}),filterFactory:new x({docId:t,ownerDocument:y}),cMapReaderFactory:Q?null:new h({baseUrl:p,isCompressed:g}),standardFontDataFactory:Q?null:new b({baseUrl:v})};if(!c){const Ae={verbosity:d,port:Ni.workerPort};c=Ae.port?fi.fromPort(Ae):new fi(Ae),e._worker=c}const re={docId:t,apiVersion:"4.10.38",data:r,password:o,disableAutoFetch:N,rangeChunkSize:u,length:U,docBaseUrl:f,enableXfa:z,evaluatorOptions:{maxImageSize:C,disableFontFace:A,ignoreErrors:_,isEvalSupported:E,isOffscreenCanvasSupported:k,isImageDecoderSupported:H,canvasMaxAreaInBytes:T,fontExtraProperties:B,useSystemFonts:J,cMapUrl:Q?p:null,standardFontDataUrl:Q?v:null}},oe={disableFontFace:A,fontExtraProperties:B,ownerDocument:y,pdfBug:D,styleElement:X,loadingParams:{disableAutoFetch:N,enableXfa:z}};return c.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const Ae=c.messageHandler.sendWithPromise("GetDocRequest",re,r?[r.buffer]:null);let te;if(l)te=new Hc(l,{disableRange:S,disableStream:L});else if(!r){if(!n)throw new Error("getDocument - no `url` parameter provided.");let Pe;if(en)if(Ii(n)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Pe=_a}else Pe=Qc;else Pe=Ii(n)?_a:Xc;te=new Pe({url:n,length:U,httpHeaders:i,withCredentials:s,rangeChunkSize:u,disableRange:S,disableStream:L})}return Ae.then(Pe=>{if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const Be=new Di(t,Pe,c.port),it=new vu(Be,e,te,oe,q);e._transport=it,Be.send("Ready",null)})}).catch(e._capability.reject),e}function du(a){if(a instanceof URL)return a.href;try{return new URL(a,window.location).href}catch{if(en&&typeof a=="string")return a}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function fu(a){if(en&&typeof Buffer<"u"&&a instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength)return a;if(typeof a=="string")return fr(a);if(a instanceof ArrayBuffer||ArrayBuffer.isView(a)||typeof a=="object"&&!isNaN(a?.length))return new Uint8Array(a);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function wa(a){return typeof a=="object"&&Number.isInteger(a?.num)&&a.num>=0&&Number.isInteger(a?.gen)&&a.gen>=0}class Rs{static#e=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Rs.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}}class Co{constructor(e,t,n=!1,r=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const n of this._rangeListeners)n(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){dt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class pu{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return We(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class gu{#e=null;#t=!1;constructor(e,t,n,r=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=r?new aa:null,this._pdfBug=r,this.commonObjs=n.commonObjs,this.objs=new Po,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:r=0,dontFlip:i=!1}={}){return new Hi({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return We(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:n="display",annotationMode:r=Nn.ENABLE,transform:i=null,background:s=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:u=null,printAnnotationStorage:c=null,isEditing:d=!1}){this._stats?.time("Overall");const f=this._transport.getRenderingIntent(n,r,c,d),{renderingIntent:p,cacheKey:g}=f;this.#t=!1,this.#i(),o||=this._transport.getOptionalContentConfig(p);let h=this._intentStates.get(g);h||(h=Object.create(null),this._intentStates.set(g,h)),h.streamReaderCancelTimeout&&(clearTimeout(h.streamReaderCancelTimeout),h.streamReaderCancelTimeout=null);const v=!!(p&hn.PRINT);h.displayReadyCapability||(h.displayReadyCapability=Promise.withResolvers(),h.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(f));const b=E=>{h.renderTasks.delete(_),(this._maybeCleanupAfterRender||v)&&(this.#t=!0),this.#n(!v),E?(_.capability.reject(E),this._abortOperatorList({intentState:h,reason:E instanceof Error?E:new Error(E)})):_.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},_=new hi({callback:b,params:{canvasContext:e,viewport:t,transform:i,background:s},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:h.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!v,pdfBug:this._pdfBug,pageColors:u});(h.renderTasks||=new Set).add(_);const C=_.task;return Promise.all([h.displayReadyCapability.promise,o]).then(([E,k])=>{if(this.destroyed){b();return}if(this._stats?.time("Rendering"),!(k.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");_.initializeGraphics({transparency:E,optionalContentConfig:k}),_.operatorListChanged()}).catch(b),C}getOperatorList({intent:e="display",annotationMode:t=Nn.ENABLE,printAnnotationStorage:n=null,isEditing:r=!1}={}){function i(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const s=this._transport.getRenderingIntent(e,t,n,r,!0);let o=this._intentStates.get(s.cacheKey);o||(o=Object.create(null),this._intentStates.set(s.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=i,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||=new Set).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(s)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>zi.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,r){function i(){s.read().then(function({value:l,done:u}){if(u){n(o);return}o.lang??=l.lang,Object.assign(o.styles,l.styles),o.items.push(...l.items),i()},r)}const s=t.getReader(),o={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#t=!1,this.#i(),Promise.all(e)}cleanup(e=!1){this.#t=!0;const t=this.#n(!1);return e&&t&&(this._stats&&=new aa),t}#n(e=!1){if(this.#i(),!this.#t||this.destroyed)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#n(!1)},au),!1;for(const{renderTasks:t,operatorList:n}of this._intentStates.values())if(t.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#i(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,r=e.length;n<r;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:r}){const{map:i,transfer:s}=n,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:r},s).getReader(),u=this._intentStates.get(t);u.streamReader=l;const c=()=>{l.read().then(({value:d,done:f})=>{if(f){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,u),c())},d=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const f of u.renderTasks)f.operatorListChanged();this.#n(!0)}if(u.displayReadyCapability)u.displayReadyCapability.reject(d);else if(u.opListReadCapability)u.opListReadCapability.reject(d);else throw d}})};c()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof Ss){let r=su;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new zn(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[r,i]of this._intentStates)if(i===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}class mu{#e=new Map;#t=Promise.resolve();postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[r]of this.#e)r.call(this,n)})}addEventListener(e,t,n=null){let r=null;if(n?.signal instanceof AbortSignal){const{signal:i}=n;if(i.aborted){He("LoopbackPort - cannot use an `aborted` signal.");return}const s=()=>this.removeEventListener(e,t);r=()=>i.removeEventListener("abort",s),i.addEventListener("abort",s)}this.#e.set(t,r)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}var cr,Xn,Kn,pi,sr,gi,ar;const At=class At{constructor({name:e=null,port:t=null,verbosity:n=Zl()}={}){li(this,pi);if(this.name=e,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(bn(At,Kn)?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(bn(At,Kn)||Ei(At,Kn,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Di("main","worker",e),this._messageHandler.on("ready",function(){}),Yi(this,pi,sr).call(this)}_initialize(){if(bn(At,Xn)||bn(At,gi,ar)){this._setupFakeWorker();return}let{workerSrc:e}=At;try{At._isSameOrigin(window.location.href,e)||(e=At._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new Di("main","worker",t),r=()=>{i.abort(),n.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=new AbortController;t.addEventListener("error",()=>{this._webWorker||r()},{signal:i.signal}),n.on("test",o=>{if(i.abort(),this.destroyed||!o){r();return}this._messageHandler=n,this._port=t,this._webWorker=t,Yi(this,pi,sr).call(this)}),n.on("ready",o=>{if(i.abort(),this.destroyed){r();return}try{s()}catch{this._setupFakeWorker()}});const s=()=>{const o=new Uint8Array;n.send("test",o,[o.buffer])};s();return}catch{dr("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){bn(At,Xn)||(He("Setting up fake worker."),Ei(At,Xn,!0)),At._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new mu;this._port=t;const n=`fake${na(At,cr)._++}`,r=new Di(n+"_worker",n,t);e.setup(r,t),this._messageHandler=new Di(n,n+"_worker",t),Yi(this,pi,sr).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,bn(At,Kn)?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=bn(this,Kn)?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new At(e)}static get workerSrc(){if(Ni.workerSrc)return Ni.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return We(this,"_setupFakeWorkerGlobal",(async()=>bn(this,gi,ar)?bn(this,gi,ar):(await import(this.workerSrc)).WorkerMessageHandler)())}};cr=new WeakMap,Xn=new WeakMap,Kn=new WeakMap,pi=new WeakSet,sr=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},gi=new WeakSet,ar=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},li(At,gi),li(At,cr,0),li(At,Xn,!1),li(At,Kn),en&&(Ei(At,Xn,!0),Ni.workerSrc||="./pdf.worker.mjs"),At._isSameOrigin=(e,t)=>{let n;try{if(n=new URL(e),!n.origin||n.origin==="null")return!1}catch{return!1}const r=new URL(t,n);return n.origin===r.origin},At._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let fi=At;class vu{#e=new Map;#t=new Map;#n=new Map;#i=new Map;#s=null;constructor(e,t,n,r,i){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new Po,this.fontLoader=new mc({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#r(e,t=null){const n=this.#e.get(e);if(n)return n;const r=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,r),r}get annotationStorage(){return We(this,"annotationStorage",new xs)}getRenderingIntent(e,t=Nn.ENABLE,n=null,r=!1,i=!1){let s=hn.DISPLAY,o=ms;switch(e){case"any":s=hn.ANY;break;case"display":break;case"print":s=hn.PRINT;break;default:He(`getRenderingIntent - invalid intent: ${e}`)}const l=s&hn.PRINT&&n instanceof uo?n:this.annotationStorage;switch(t){case Nn.DISABLE:s+=hn.ANNOTATIONS_DISABLE;break;case Nn.ENABLE:break;case Nn.ENABLE_FORMS:s+=hn.ANNOTATIONS_FORMS;break;case Nn.ENABLE_STORAGE:s+=hn.ANNOTATIONS_STORAGE,o=l.serializable;break;default:He(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(s+=hn.IS_EDITING),i&&(s+=hn.OPLIST);const{ids:u,hash:c}=l.modifiedIds,d=[s,o.hash,c];return{renderingIntent:s,cacheKey:d.join("_"),annotationStorageSerializable:o,modifiedIds:u}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#t.values())e.push(n._destroy());this.#t.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),nn.cleanup(),this._networkStream?.cancelAllRequests(new zn("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,r)=>{Vt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},r.onPull=()=>{this._fullReader.read().then(function({value:i,done:s}){if(s){r.close();return}Vt(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{r.error(i)})},r.onCancel=i=>{this._fullReader.cancel(i),r.ready.catch(s=>{if(!this.destroyed)throw s})}}),e.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:i,contentLength:s}=this._fullReader;return(!r||!i)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=o=>{t.onProgress?.({loaded:o.loaded,total:o.total})}),{isStreamingSupported:r,isRangeSupported:i,contentLength:s}}),e.on("GetRangeReader",(n,r)=>{Vt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(n.begin,n.end);if(!i){r.close();return}r.onPull=()=>{i.read().then(function({value:s,done:o}){if(o){r.close();return}Vt(s instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{r.error(s)})},r.onCancel=s=>{i.cancel(s),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new pu(n,this))}),e.on("DocException",n=>{t._capability.reject(on(n))}),e.on("PasswordRequest",n=>{this.#s=Promise.withResolvers();try{if(!t.onPassword)throw on(n);const r=i=>{i instanceof Error?this.#s.reject(i):this.#s.resolve({password:i})};t.onPassword(r,n.code)}catch(r){this.#s.reject(r)}return this.#s.promise}),e.on("DataLoaded",n=>{t.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#t.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,r,i])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(r){case"Font":const{disableFontFace:s,fontExtraProperties:o,pdfBug:l}=this._params;if("error"in i){const f=i.error;He(`Error during font loading: ${f}`),this.commonObjs.resolve(n,f);break}const u=l&&globalThis.FontInspector?.enabled?(f,p)=>globalThis.FontInspector.fontAdded(f,p):null,c=new vc(i,{disableFontFace:s,fontExtraProperties:o,inspectFont:u});this.fontLoader.bind(c).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!o&&c.data&&(c.data=null),this.commonObjs.resolve(n,c)});break;case"CopyLocalImage":const{imageRef:d}=i;Vt(d,"The imageRef must be defined.");for(const f of this.#t.values())for(const[,p]of f.objs)if(p?.ref===d)return p.dataLen?(this.commonObjs.resolve(n,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,i);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([n,r,i,s])=>{if(this.destroyed)return;const o=this.#t.get(r);if(!o.objs.has(n)){if(o._intentStates.size===0){s?.bitmap?.close();return}switch(i){case"Image":o.objs.resolve(n,s),s?.dataLen>Ul&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(n,s);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",n=>{this.destroyed||t.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("FetchBuiltInCMap",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(n)}),e.on("FetchStandardFontData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&He("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=this.#n.get(t);if(n)return n;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&this.#i.set(i.refStr,e);const s=new gu(t,i,this,this._params.pdfBug);return this.#t.set(t,s),s});return this.#n.set(t,r),r}getPageIndex(e){return wa(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#r("GetFieldObjects")}hasJSActions(){return this.#r("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#r("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#r("GetOptionalContentConfig").then(t=>new zc(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(r=>({info:r[0],metadata:r[1]?new Nc(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),nn.cleanup()}}cachedPageNumber(e){if(!wa(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#i.get(t)??null}}const Ci=Symbol("INITIAL_DATA");class Po{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:Ci}}get(e,t=null){if(t){const r=this.#t(e);return r.promise.then(()=>t(r.data)),null}const n=this.#e[e];if(!n||n.data===Ci)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=this.#e[e];return!!t&&t.data!==Ci}delete(e){const t=this.#e[e];return!t||t.data===Ci?!1:(delete this.#e[e],!0)}resolve(e,t=null){const n=this.#t(e);n.data=t,n.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==Ci&&(yield[e,t])}}}class bu{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class hi{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:r,annotationCanvasMap:i,operatorList:s,pageIndex:o,canvasFactory:l,filterFactory:u,useRequestAnimationFrame:c=!1,pdfBug:d=!1,pageColors:f=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=r,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=s,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=u,this._pdfBug=d,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=c===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new bu(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(hi.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");hi.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:r,transform:i,background:s}=this.params;this.gfx=new di(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:i,viewport:r,transparency:e,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),hi.#t.delete(this._canvas),this.callback(e||new Ss(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),hi.#t.delete(this._canvas),this.callback())))}}const _u="4.10.38",wu="f9bea397f";function ya(a){return Math.floor(Math.max(0,Math.min(1,a))*255).toString(16).padStart(2,"0")}function Pi(a){return Math.max(0,Math.min(255,255*a))}class Ea{static CMYK_G([e,t,n,r]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Pi(e),[e,e,e]}static G_HTML([e]){const t=ya(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(Pi)}static RGB_HTML(e){return`#${e.map(ya).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,n+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,n,r]){return[Pi(1-Math.min(1,e+r)),Pi(1-Math.min(1,n+r)),Pi(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const r=1-e,i=1-t,s=1-n,o=Math.min(r,i,s);return["CMYK",r,i,s,o]}}class yu{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),n||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){dt("Abstract method `_createSVG` called.")}}class Ls extends yu{_createSVG(e){return document.createElementNS(Mn,e)}}class ko{static setupStorage(e,t,n,r,i){const s=r.getValue(t,{value:null});switch(n.name){case"textarea":if(s.value!==null&&(e.textContent=s.value),i==="print")break;e.addEventListener("input",o=>{r.setValue(t,{value:o.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(s.value===n.attributes.xfaOn?e.setAttribute("checked",!0):s.value===n.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",o=>{r.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(s.value!==null&&e.setAttribute("value",s.value),i==="print")break;e.addEventListener("input",o=>{r.setValue(t,{value:o.target.value})})}break;case"select":if(s.value!==null){e.setAttribute("value",s.value);for(const o of n.children)o.attributes.value===s.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,u=l.selectedIndex===-1?"":l[l.selectedIndex].value;r.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:r,linkService:i}){const{attributes:s}=t,o=e instanceof HTMLAnchorElement;s.type==="radio"&&(s.name=`${s.name}-${r}`);for(const[l,u]of Object.entries(s))if(u!=null)switch(l){case"class":u.length&&e.setAttribute(l,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,u)}o&&i.addLinkAttributes(e,s.href,s.newWindow),n&&s.dataId&&this.setupStorage(e,s.dataId,t,n)}static render(e){const t=e.annotationStorage,n=e.linkService,r=e.xfaHtml,i=e.intent||"display",s=document.createElement(r.name);r.attributes&&this.setAttributes({html:s,element:r,intent:i,linkService:n});const o=i!=="richText",l=e.div;if(l.append(s),e.viewport){const d=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=d}o&&l.setAttribute("class","xfaLayer xfaFont");const u=[];if(r.children.length===0){if(r.value){const d=document.createTextNode(r.value);s.append(d),o&&zi.shouldBuildText(r.name)&&u.push(d)}return{textDivs:u}}const c=[[r,-1,s]];for(;c.length>0;){const[d,f,p]=c.at(-1);if(f+1===d.children.length){c.pop();continue}const g=d.children[++c.at(-1)[1]];if(g===null)continue;const{name:h}=g;if(h==="#text"){const b=document.createTextNode(g.value);u.push(b),p.append(b);continue}const v=g?.attributes?.xmlns?document.createElementNS(g.attributes.xmlns,h):document.createElement(h);if(p.append(v),g.attributes&&this.setAttributes({html:v,element:g,storage:t,intent:i,linkService:n}),g.children?.length>0)c.push([g,-1,v]);else if(g.value){const b=document.createTextNode(g.value);o&&zi.shouldBuildText(h)&&u.push(b),v.append(b)}}for(const d of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))d.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Vi=1e3,Eu=9,Zn=new WeakSet;function Bn(a){return{width:a[2]-a[0],height:a[3]-a[1]}}class Su{static create(e){switch(e.data.annotationType){case $t.LINK:return new xo(e);case $t.TEXT:return new Au(e);case $t.WIDGET:switch(e.data.fieldType){case"Tx":return new Cu(e);case"Btn":return e.data.radioButton?new Mo(e):e.data.checkBox?new ku(e):new xu(e);case"Ch":return new Mu(e);case"Sig":return new Pu(e)}return new Jn(e);case $t.POPUP:return new bs(e);case $t.FREETEXT:return new To(e);case $t.LINE:return new Ru(e);case $t.SQUARE:return new Lu(e);case $t.CIRCLE:return new Iu(e);case $t.POLYLINE:return new Ro(e);case $t.CARET:return new Fu(e);case $t.INK:return new Is(e);case $t.POLYGON:return new Du(e);case $t.HIGHLIGHT:return new Lo(e);case $t.UNDERLINE:return new Ou(e);case $t.SQUIGGLY:return new Nu(e);case $t.STRIKEOUT:return new Bu(e);case $t.STAMP:return new Io(e);case $t.FILEATTACHMENT:return new zu(e);default:return new Ot(e)}}}class Ot{#e=null;#t=!1;#n=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),r&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:n}){return!!(e?.str||t?.str||n?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ot._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};const{rect:t}=e;t&&this.#i(t),this.#n?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#i(this.#e.rect),this.#n?.popup.resetEdited(),this.#e=null)}#i(e){const{container:{style:t},data:{rect:n,rotation:r},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:o,pageY:l}}}}=this;n?.splice(0,4,...e);const{width:u,height:c}=Bn(e);t.left=`${100*(e[0]-o)/i}%`,t.top=`${100*(s-e[3]+l)/s}%`,r===0?(t.width=`${100*u/i}%`,t.height=`${100*c/s}%`):this.setRotation(r)}_createContainer(e){const{data:t,parent:{page:n,viewport:r}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),this instanceof Jn||(i.tabIndex=Vi);const{style:s}=i;if(s.zIndex=this.parent.zIndex++,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof bs){const{rotation:h}=t;return!t.hasOwnCanvas&&h!==0&&this.setRotation(h,i),i}const{width:o,height:l}=Bn(t.rect);if(!e&&t.borderStyle.width>0){s.borderWidth=`${t.borderStyle.width}px`;const h=t.borderStyle.horizontalCornerRadius,v=t.borderStyle.verticalCornerRadius;if(h>0||v>0){const _=`calc(${h}px * var(--scale-factor)) / calc(${v}px * var(--scale-factor))`;s.borderRadius=_}else if(this instanceof Mo){const _=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;s.borderRadius=_}switch(t.borderStyle.style){case Si.SOLID:s.borderStyle="solid";break;case Si.DASHED:s.borderStyle="dashed";break;case Si.BEVELED:He("Unimplemented border style: beveled");break;case Si.INSET:He("Unimplemented border style: inset");break;case Si.UNDERLINE:s.borderBottomStyle="solid";break}const b=t.borderColor||null;b?(this.#t=!0,s.borderColor=Ee.makeHexColor(b[0]|0,b[1]|0,b[2]|0)):s.borderWidth=0}const u=Ee.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:c,pageHeight:d,pageX:f,pageY:p}=r.rawDims;s.left=`${100*(u[0]-f)/c}%`,s.top=`${100*(u[1]-p)/d}%`;const{rotation:g}=t;return t.hasOwnCanvas||g===0?(s.width=`${100*o/c}%`,s.height=`${100*l/d}%`):this.setRotation(g,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:r}=this.parent.viewport.rawDims,{width:i,height:s}=Bn(this.data.rect);let o,l;e%180===0?(o=100*i/n,l=100*s/r):(o=100*s/n,l=100*i/r),t.style.width=`${o}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,r)=>{const i=r.detail[t],s=i[0],o=i.slice(1);r.target.style[n]=Ea[`${s}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[n]:Ea[`${s}_rgb`](o)})};return We(this,"_commonActions",{display:t=>{const{display:n}=t.detail,r=n%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const r of Object.keys(t.detail))(e[r]||n[r])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[r,i]of Object.entries(t)){const s=n[r];if(s){const o={detail:{[r]:i},target:e};s(o),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,r,i]=this.data.rect.map(h=>Math.fround(h));if(e.length===8){const[h,v,b,_]=e.subarray(2,6);if(r===h&&i===v&&t===b&&n===_)return}const{style:s}=this.container;let o;if(this.#t){const{borderColor:h,borderWidth:v}=s;s.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${h}" stroke-width="${v}">`],this.container.classList.add("hasBorder")}const l=r-t,u=i-n,{svgFactory:c}=this,d=c.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const f=c.createElement("defs");d.append(f);const p=c.createElement("clipPath"),g=`clippath_${this.data.id}`;p.setAttribute("id",g),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let h=2,v=e.length;h<v;h+=8){const b=e[h],_=e[h+1],C=e[h+2],E=e[h+3],k=c.createElement("rect"),H=(C-t)/l,T=(i-_)/u,A=(b-C)/l,B=(_-E)/u;k.setAttribute("x",H),k.setAttribute("y",T),k.setAttribute("width",A),k.setAttribute("height",B),p.append(k),o?.push(`<rect vector-effect="non-scaling-stroke" x="${H}" y="${T}" width="${A}" height="${B}"/>`)}this.#t&&(o.push("</g></svg>')"),s.backgroundImage=o.join("")),this.container.append(d),this.container.style.clipPath=`url(#${g})`}_createPopup(){const{data:e}=this,t=this.#n=new bs({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){dt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:i,id:s,exportValues:o}of r){if(i===-1||s===t)continue;const l=typeof o=="string"?o:null,u=document.querySelector(`[data-element-id="${s}"]`);if(u&&!Zn.has(u)){He(`_getElementsByName - element not allowed: ${s}`);continue}n.push({id:s,exportValue:l,domElement:u})}return n}for(const r of document.getElementsByName(e)){const{exportValue:i}=r,s=r.getAttribute("data-element-id");s!==t&&Zn.has(r)&&n.push({id:s,exportValue:i,domElement:r})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}}class xo extends Ot{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let r=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(n,e.action),r=!0):e.attachment?(this.#t(n,e.attachment,e.attachmentDest),r=!0):e.setOCGState?(this.#n(n,e.setOCGState),r=!0):e.dest?(this._bindLink(n,e.dest),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),r=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(n,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(n),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,n=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,n),!1),this.#e()}#n(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(t.actions)){const i=n.get(r);i&&(e[i]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:r}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){He('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();const{fields:r,refs:i,include:s}=t,o=[];if(r.length!==0||i.length!==0){const c=new Set(i);for(const d of r){const f=this._fieldObjects[d]||[];for(const{id:p}of f)c.add(p)}for(const d of Object.values(this._fieldObjects))for(const f of d)c.has(f.id)===s&&o.push(f)}else for(const c of Object.values(this._fieldObjects))o.push(...c);const l=this.annotationStorage,u=[];for(const c of o){const{id:d}=c;switch(u.push(d),c.type){case"text":{const p=c.defaultValue||"";l.setValue(d,{value:p});break}case"checkbox":case"radiobutton":{const p=c.defaultValue===c.exportValues;l.setValue(d,{value:p});break}case"combobox":case"listbox":{const p=c.defaultValue||"";l.setValue(d,{value:p});break}default:continue}const f=document.querySelector(`[data-element-id="${d}"]`);if(f){if(!Zn.has(f)){He(`_bindResetFormAction - element not allowed: ${d}`);continue}}else continue;f.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:u,name:"ResetForm"}}),!1}}}class Au extends Ot{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Jn extends Ot{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return rn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,r,i){n.includes("mouse")?e.addEventListener(n,s=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:i(s),shift:s.shiftKey,modifier:this._getKeyModifier(s)}})}):e.addEventListener(n,s=>{if(n==="blur"){if(!t.focused||!s.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}i&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:i(s)}})})}_setEventListeners(e,t,n,r){for(const[i,s]of n)(s==="Action"||this.data.actions?.[s])&&((s==="Focus"||s==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,i,s,r),s==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):s==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Ee.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||Eu,i=e.style;let s;const o=2,l=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o),c=Math.round(u/(Hr*r))||1,d=u/c;s=Math.min(r,l(d/Hr))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o);s=Math.min(r,l(u/Hr))}i.fontSize=`calc(${s}px * var(--scale-factor))`,i.color=Ee.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class Cu extends Jn{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,r){const i=this.annotationStorage;for(const s of this._getElementsByName(e.name,e.id))s.domElement&&(s.domElement[t]=n),i.setValue(s.id,{[r]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const r=e.getValue(t,{value:this.data.fieldValue});let i=r.value||"";const s=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;s&&i.length>s&&(i=i.slice(0,s));let o=r.formattedValue||this.data.textContent?.join(`
`)||null;o&&this.data.comb&&(o=o.replaceAll(/\s+/g,""));const l={userValue:i,formattedValue:o,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=o??i,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",o??i),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),Zn.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=Vi,this._setRequired(n,this.data.required),s&&(n.maxLength=s),n.addEventListener("input",c=>{e.setValue(t,{value:c.target.value}),this.setPropertyOnSiblings(n,"value",c.target.value,"value"),l.formattedValue=null}),n.addEventListener("resetform",c=>{const d=this.data.defaultFieldValue??"";n.value=l.userValue=d,l.formattedValue=null});let u=c=>{const{formattedValue:d}=l;d!=null&&(c.target.value=d),c.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",d=>{if(l.focused)return;const{target:f}=d;l.userValue&&(f.value=l.userValue),l.lastCommittedValue=f.value,l.commitKey=1,this.data.actions?.Focus||(l.focused=!0)}),n.addEventListener("updatefromsandbox",d=>{this.showElementAndHideCanvas(d.target);const f={value(p){l.userValue=p.detail.value??"",e.setValue(t,{value:l.userValue.toString()}),p.target.value=l.userValue},formattedValue(p){const{formattedValue:g}=p.detail;l.formattedValue=g,g!=null&&p.target!==document.activeElement&&(p.target.value=g),e.setValue(t,{formattedValue:g})},selRange(p){p.target.setSelectionRange(...p.detail.selRange)},charLimit:p=>{const{charLimit:g}=p.detail,{target:h}=p;if(g===0){h.removeAttribute("maxLength");return}h.setAttribute("maxLength",g);let v=l.userValue;!v||v.length<=g||(v=v.slice(0,g),h.value=l.userValue=v,e.setValue(t,{value:v}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,willCommit:!0,commitKey:1,selStart:h.selectionStart,selEnd:h.selectionEnd}}))}};this._dispatchEventFromSandbox(f,d)}),n.addEventListener("keydown",d=>{l.commitKey=1;let f=-1;if(d.key==="Escape"?f=0:d.key==="Enter"&&!this.data.multiLine?f=2:d.key==="Tab"&&(l.commitKey=3),f===-1)return;const{value:p}=d.target;l.lastCommittedValue!==p&&(l.lastCommittedValue=p,l.userValue=p,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:p,willCommit:!0,commitKey:f,selStart:d.target.selectionStart,selEnd:d.target.selectionEnd}}))});const c=u;u=null,n.addEventListener("blur",d=>{if(!l.focused||!d.relatedTarget)return;this.data.actions?.Blur||(l.focused=!1);const{value:f}=d.target;l.userValue=f,l.lastCommittedValue!==f&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,willCommit:!0,commitKey:l.commitKey,selStart:d.target.selectionStart,selEnd:d.target.selectionEnd}}),c(d)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",d=>{l.lastCommittedValue=null;const{data:f,target:p}=d,{value:g,selectionStart:h,selectionEnd:v}=p;let b=h,_=v;switch(d.inputType){case"deleteWordBackward":{const C=g.substring(0,h).match(/\w*[^\w]*$/);C&&(b-=C[0].length);break}case"deleteWordForward":{const C=g.substring(h).match(/^[^\w]*\w*/);C&&(_+=C[0].length);break}case"deleteContentBackward":h===v&&(b-=1);break;case"deleteContentForward":h===v&&(_+=1);break}d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:g,change:f||"",willCommit:!1,selStart:b,selEnd:_}})}),this._setEventListeners(n,l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],d=>d.target.value)}if(u&&n.addEventListener("blur",u),this.data.comb){const d=(this.data.rect[2]-this.data.rect[0])/s;n.classList.add("comb"),n.style.letterSpacing=`calc(${d}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Pu extends Jn{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class ku extends Jn{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let r=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(n,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return Zn.add(i),i.setAttribute("data-element-id",n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,r&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=Vi,i.addEventListener("change",s=>{const{name:o,checked:l}=s.target;for(const u of this._getElementsByName(o,n)){const c=l&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=c),e.setValue(u.id,{value:c})}e.setValue(n,{value:l})}),i.addEventListener("resetform",s=>{const o=t.defaultFieldValue||"Off";s.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",s=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(n,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,s)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],s=>s.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Mo extends Jn{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let r=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(n,{value:r})),r)for(const s of this._getElementsByName(t.fieldName,n))e.setValue(s.id,{value:!1});const i=document.createElement("input");if(Zn.add(i),i.setAttribute("data-element-id",n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,r&&i.setAttribute("checked",!0),i.tabIndex=Vi,i.addEventListener("change",s=>{const{name:o,checked:l}=s.target;for(const u of this._getElementsByName(o,n))e.setValue(u.id,{value:!1});e.setValue(n,{value:l})}),i.addEventListener("resetform",s=>{const o=t.defaultFieldValue;s.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const s=t.buttonValue;i.addEventListener("updatefromsandbox",o=>{const l={value:u=>{const c=s===u.detail.value;for(const d of this._getElementsByName(u.target.name)){const f=c&&d.id===n;d.domElement&&(d.domElement.checked=f),e.setValue(d.id,{value:f})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class xu extends xo{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class Mu extends Jn{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");Zn.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=Vi;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",c=>{const d=this.data.defaultFieldValue;for(const f of r.options)f.selected=f.value===d});for(const c of this.data.options){const d=document.createElement("option");d.textContent=c.displayValue,d.value=c.exportValue,n.value.includes(c.exportValue)&&(d.setAttribute("selected",!0),i=!1),r.append(d)}let s=null;if(i){const c=document.createElement("option");c.value=" ",c.setAttribute("hidden",!0),c.setAttribute("selected",!0),r.prepend(c),s=()=>{c.remove(),r.removeEventListener("input",s),s=null},r.addEventListener("input",s)}const o=c=>{const d=c?"value":"textContent",{options:f,multiple:p}=r;return p?Array.prototype.filter.call(f,g=>g.selected).map(g=>g[d]):f.selectedIndex===-1?null:f[f.selectedIndex][d]};let l=o(!1);const u=c=>{const d=c.target.options;return Array.prototype.map.call(d,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",c=>{const d={value(f){s?.();const p=f.detail.value,g=new Set(Array.isArray(p)?p:[p]);for(const h of r.options)h.selected=g.has(h.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(f){r.multiple=!0},remove(f){const p=r.options,g=f.detail.remove;p[g].selected=!1,r.remove(g),p.length>0&&Array.prototype.findIndex.call(p,v=>v.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:o(!0),items:u(f)}),l=o(!1)},clear(f){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(f){const{index:p,displayValue:g,exportValue:h}=f.detail.insert,v=r.children[p],b=document.createElement("option");b.textContent=g,b.value=h,v?v.before(b):r.append(b),e.setValue(t,{value:o(!0),items:u(f)}),l=o(!1)},items(f){const{items:p}=f.detail;for(;r.length!==0;)r.remove(0);for(const g of p){const{displayValue:h,exportValue:v}=g,b=document.createElement("option");b.textContent=h,b.value=v,r.append(b)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:o(!0),items:u(f)}),l=o(!1)},indices(f){const p=new Set(f.detail.indices);for(const g of f.target.options)g.selected=p.has(g.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(d,c)}),r.addEventListener("input",c=>{const d=o(!0),f=o(!1);e.setValue(t,{value:d}),c.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:f,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],c=>c.target.value)):r.addEventListener("input",function(c){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class bs extends Ot{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:Ot._hasPopupData(t)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new Tu({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const n of this.elements)n.popup=e,n.container.ariaHasPopup="dialog",t.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(n=>`${Es}${n}`).join(",")),this.container}}class Tu{#e=this.#k.bind(this);#t=this.#P.bind(this);#n=this.#x.bind(this);#i=this.#E.bind(this);#s=null;#r=null;#l=null;#o=null;#u=null;#c=null;#d=null;#h=!1;#f=null;#a=null;#p=null;#m=null;#g=null;#v=null;#w=!1;constructor({container:e,color:t,elements:n,titleObj:r,modificationDate:i,contentsObj:s,richText:o,parent:l,rect:u,parentRect:c,open:d}){this.#r=e,this.#g=r,this.#l=s,this.#m=o,this.#c=l,this.#s=t,this.#p=u,this.#d=c,this.#u=n,this.#o=lo.toDateObject(i),this.trigger=n.flatMap(f=>f.getElementsToTriggerPopup());for(const f of this.trigger)f.addEventListener("click",this.#i),f.addEventListener("mouseenter",this.#n),f.addEventListener("mouseleave",this.#t),f.classList.add("popupTriggerArea");for(const f of n)f.container?.addEventListener("keydown",this.#e);this.#r.hidden=!0,d&&this.#E()}render(){if(this.#f)return;const e=this.#f=document.createElement("div");if(e.className="popup",this.#s){const i=e.style.outlineColor=Ee.makeHexColor(...this.#s);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`:e.style.backgroundColor=Ee.makeHexColor(...this.#s.map(o=>Math.floor(.7*(255-o)+o)))}const t=document.createElement("span");t.className="header";const n=document.createElement("h1");if(t.append(n),{dir:n.dir,str:n.textContent}=this.#g,e.append(t),this.#o){const i=document.createElement("span");i.classList.add("popupDate"),i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),t.append(i)}const r=this.#b;if(r)ko.render({xfaHtml:r,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const i=this._formatContents(this.#l);e.append(i)}this.#r.append(e)}get#b(){const e=this.#m,t=this.#l;return e?.str&&(!t?.str||t.str===e.str)&&this.#m.html||null}get#y(){return this.#b?.attributes?.style?.fontSize||0}get#S(){return this.#b?.attributes?.style?.color||null}#C(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:this.#S,fontSize:this.#y?`calc(${this.#y}px * var(--scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:r});return n}_formatContents({str:e,dir:t}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;const r=e.split(/(?:\r\n?|\n)/);for(let i=0,s=r.length;i<s;++i){const o=r[i];n.append(document.createTextNode(o)),i<s-1&&n.append(document.createElement("br"))}return n}#k(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#h)&&this.#E()}updateEdited({rect:e,popupContent:t}){this.#v||={contentsObj:this.#l,richText:this.#m},e&&(this.#a=null),t&&(this.#m=this.#C(t),this.#l=null),this.#f?.remove(),this.#f=null}resetEdited(){this.#v&&({contentsObj:this.#l,richText:this.#m}=this.#v,this.#v=null,this.#f?.remove(),this.#f=null,this.#a=null)}#M(){if(this.#a!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:r,pageY:i}}}=this.#c;let s=!!this.#d,o=s?this.#d:this.#p;for(const g of this.#u)if(!o||Ee.intersect(g.data.rect,o)!==null){o=g.data.rect,s=!0;break}const l=Ee.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),c=s?o[2]-o[0]+5:0,d=l[0]+c,f=l[1];this.#a=[100*(d-r)/t,100*(f-i)/n];const{style:p}=this.#r;p.left=`${this.#a[0]}%`,p.top=`${this.#a[1]}%`}#E(){this.#h=!this.#h,this.#h?(this.#x(),this.#r.addEventListener("click",this.#i),this.#r.addEventListener("keydown",this.#e)):(this.#P(),this.#r.removeEventListener("click",this.#i),this.#r.removeEventListener("keydown",this.#e))}#x(){this.#f||this.render(),this.isVisible?this.#h&&this.#r.classList.add("focused"):(this.#M(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#P(){this.#r.classList.remove("focused"),!(this.#h||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#w=this.isVisible,this.#w&&(this.#r.hidden=!0)}maybeShow(){this.#w&&(this.#f||this.#x(),this.#w=!1,this.#r.hidden=!1)}get isVisible(){return this.#r.hidden===!1}}class To extends Ot{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=ze.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Ru extends Ot{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:t,height:n}=Bn(e.rect),r=this.svgFactory.create(t,n,!0),i=this.#e=this.svgFactory.createElement("svg:line");return i.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),i.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),i.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),i.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),i.setAttribute("stroke-width",e.borderStyle.width||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),r.append(i),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Lu extends Ot{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:t,height:n}=Bn(e.rect),r=this.svgFactory.create(t,n,!0),i=e.borderStyle.width,s=this.#e=this.svgFactory.createElement("svg:rect");return s.setAttribute("x",i/2),s.setAttribute("y",i/2),s.setAttribute("width",t-i),s.setAttribute("height",n-i),s.setAttribute("stroke-width",i||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),r.append(s),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Iu extends Ot{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:t,height:n}=Bn(e.rect),r=this.svgFactory.create(t,n,!0),i=e.borderStyle.width,s=this.#e=this.svgFactory.createElement("svg:ellipse");return s.setAttribute("cx",t/2),s.setAttribute("cy",n/2),s.setAttribute("rx",t/2-i/2),s.setAttribute("ry",n/2-i/2),s.setAttribute("stroke-width",i||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),r.append(s),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Ro extends Ot{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:r}}=this;if(!t)return this.container;const{width:i,height:s}=Bn(e),o=this.svgFactory.create(i,s,!0);let l=[];for(let c=0,d=t.length;c<d;c+=2){const f=t[c]-e[0],p=e[3]-t[c+1];l.push(`${f},${p}`)}l=l.join(" ");const u=this.#e=this.svgFactory.createElement(this.svgElementName);return u.setAttribute("points",l),u.setAttribute("stroke-width",n.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),o.append(u),this.container.append(o),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Du extends Ro{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Fu extends Ot{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Is extends Ot{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ze.HIGHLIGHT:ze.INK}#n(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:r,popupRef:i}}=this,{transform:s,width:o,height:l}=this.#n(t,e),u=this.svgFactory.create(o,l,!0),c=this.#e=this.svgFactory.createElement("svg:g");u.append(c),c.setAttribute("stroke-width",r.width||1),c.setAttribute("stroke-linecap","round"),c.setAttribute("stroke-linejoin","round"),c.setAttribute("stroke-miterlimit",10),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),c.setAttribute("transform",s);for(let d=0,f=n.length;d<f;d++){const p=this.svgFactory.createElement(this.svgElementName);this.#t.push(p),p.setAttribute("points",n[d].join(",")),c.append(p)}return!i&&this.hasPopupData&&this._createPopup(),this.container.append(u),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:r}=e,i=this.#e;if(t>=0&&i.setAttribute("stroke-width",t||1),n)for(let s=0,o=this.#t.length;s<o;s++)this.#t[s].setAttribute("points",n[s].join(","));if(r){const{transform:s,width:o,height:l}=this.#n(this.data.rotation,r);i.parentElement.setAttribute("viewBox",`0 0 ${o} ${l}`),i.setAttribute("transform",s)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Lo extends Ot{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ze.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class Ou extends Ot{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Nu extends Ot{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Bu extends Ot{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Io extends Ot{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ze.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class zu extends Ot{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||t.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#t.bind(this)),this.#e=n;const{isMac:r}=rn.platform;return e.addEventListener("keydown",i=>{i.key==="Enter"&&(r?i.metaKey:i.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Hu{#e=null;#t=null;#n=new Map;#i=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:r,page:i,viewport:s,structTreeLayer:o}){this.div=e,this.#e=t,this.#t=n,this.#i=o||null,this.page=i,this.viewport=s,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return this.#n.size>0}async#s(e,t){const n=e.firstChild||e,r=n.id=`${Es}${t}`,i=await this.#i?.getAriaAttributes(r);if(i)for(const[s,o]of i)n.setAttribute(s,o);this.div.append(e),this.#e?.moveElementInDOM(this.div,e,n,!1)}async render(e){const{annotations:t}=e,n=this.div;Yn(n,this.viewport);const r=new Map,i={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Ls,annotationStorage:e.annotationStorage||new xs,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const s of t){if(s.noHTML)continue;const o=s.annotationType===$t.POPUP;if(o){const c=r.get(s.id);if(!c)continue;i.elements=c}else{const{width:c,height:d}=Bn(s.rect);if(c<=0||d<=0)continue}i.data=s;const l=Su.create(i);if(!l.isRenderable)continue;if(!o&&s.popupRef){const c=r.get(s.popupRef);c?c.push(l):r.set(s.popupRef,[l])}const u=l.render();s.hidden&&(u.style.visibility="hidden"),await this.#s(u,s.id),l._isEditable&&(this.#n.set(l.data.id,l),this._annotationEditorUIManager?.renderAnnotationElement(l))}this.#r()}update({viewport:e}){const t=this.div;this.viewport=e,Yn(t,{rotation:e.rotation}),this.#r(),t.hidden=!1}#r(){if(!this.#t)return;const e=this.div;for(const[t,n]of this.#t){const r=e.querySelector(`[data-annotation-id="${t}"]`);if(!r)continue;n.className="annotationContent";const{firstChild:i}=r;i?i.nodeName==="CANVAS"?i.replaceWith(n):i.classList.contains("annotationContent")?i.after(n):i.before(n):r.append(n)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}}const er=/\r\n?|\n/g;class Gt extends Le{#e;#t="";#n=`${this.id}-editor`;#i=null;#s;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=Gt.prototype,t=i=>i.isEmpty(),n=Hn.TRANSLATE_SMALL,r=Hn.TRANSLATE_BIG;return We(this,"_keyboardManager",new ji([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,r],checker:t}]]))}static _type="freetext";static _editorType=ze.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.#e=e.color||Gt._defaultColor||Le._defaultLineColor,this.#s=e.fontSize||Gt._defaultFontSize}static initialize(e,t){Le.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Xe.FREETEXT_SIZE:Gt._defaultFontSize=t;break;case Xe.FREETEXT_COLOR:Gt._defaultColor=t;break}}updateParams(e,t){switch(e){case Xe.FREETEXT_SIZE:this.#r(t);break;case Xe.FREETEXT_COLOR:this.#l(t);break}}static get defaultPropertiesToUpdate(){return[[Xe.FREETEXT_SIZE,Gt._defaultFontSize],[Xe.FREETEXT_COLOR,Gt._defaultColor||Le._defaultLineColor]]}get propertiesToUpdate(){return[[Xe.FREETEXT_SIZE,this.#s],[Xe.FREETEXT_COLOR,this.#e]]}#r(e){const t=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-this.#s)*this.parentScale),this.#s=r,this.#u()},n=this.#s;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Xe.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(e){const t=r=>{this.#e=this.editorDiv.style.color=r},n=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Xe.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-Gt._internalPadding*e,-(Gt._internalPadding+this.#s)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(ze.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const e=this._uiManager.combinedSignal(this.#i);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const e=[];this.editorDiv.normalize();let t=null;for(const n of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(Gt.#c(n)),t=n);return e.join(`
`)}#u(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:r,div:i}=this,s=i.style.display,o=i.classList.contains("hidden");i.classList.remove("hidden"),i.style.display="hidden",r.div.append(this.div),n=i.getBoundingClientRect(),i.remove(),i.style.display=s,i.classList.toggle("hidden",o)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#t,t=this.#t=this.#o().trimEnd();if(e===t)return;const n=r=>{if(this.#t=r,!r){this.remove();return}this.#d(),this._uiManager.rebuild(this),this.#u()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#u()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Gt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#s}px * var(--scale-factor))`,n.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),lr(this,this.div,["dblclick","keydown"]),this.width){const[r,i]=this.parentDimensions;if(this.annotationElementId){const{position:s}=this._initialData;let[o,l]=this.getInitialTranslation();[o,l]=this.pageTranslationToScreen(o,l);const[u,c]=this.pageDimensions,[d,f]=this.pageTranslation;let p,g;switch(this.rotation){case 0:p=e+(s[0]-d)/u,g=t+this.height-(s[1]-f)/c;break;case 90:p=e+(s[0]-d)/u,g=t-(s[1]-f)/c,[o,l]=[l,-o];break;case 180:p=e-this.width+(s[0]-d)/u,g=t-(s[1]-f)/c,[o,l]=[-o,-l];break;case 270:p=e+(s[0]-d-this.height*c)/u,g=t+(s[1]-f-this.width*u)/c,[o,l]=[-l,o];break}this.setAt(p*r,g*i,o,l)}else this.setAt(e*r,t*i,this.width*r,this.height*i);this.#d(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(er,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const r=Gt.#f(t.getData("text")||"").replaceAll(er,`
`);if(!r)return;const i=window.getSelection();if(!i.rangeCount)return;this.editorDiv.normalize(),i.deleteFromDocument();const s=i.getRangeAt(0);if(!r.includes(`
`)){s.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),i.collapseToStart();return}const{startContainer:o,startOffset:l}=s,u=[],c=[];if(o.nodeType===Node.TEXT_NODE){const p=o.parentElement;if(c.push(o.nodeValue.slice(l).replaceAll(er,"")),p!==this.editorDiv){let g=u;for(const h of this.editorDiv.childNodes){if(h===p){g=c;continue}g.push(Gt.#c(h))}}u.push(o.nodeValue.slice(0,l).replaceAll(er,""))}else if(o===this.editorDiv){let p=u,g=0;for(const h of this.editorDiv.childNodes)g++===l&&(p=c),p.push(Gt.#c(h))}this.#t=`${u.join(`
`)}${r}${c.join(`
`)}`,this.#d();const d=new Range;let f=u.reduce((p,g)=>p+g.length,0);for(const{firstChild:p}of this.editorDiv.childNodes)if(p.nodeType===Node.TEXT_NODE){const g=p.nodeValue.length;if(f<=g){d.setStart(p,f),d.setEnd(p,f);break}f-=g}i.removeAllRanges(),i.addRange(d)}#d(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const e of this.#t.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#h(){return this.#t.replaceAll(" "," ")}static#f(e){return e.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}static async deserialize(e,t,n){let r=null;if(e instanceof To){const{data:{defaultAppearanceData:{fontSize:s,fontColor:o},rect:l,rotation:u,id:c,popupRef:d},textContent:f,textPosition:p,parent:{page:{pageNumber:g}}}=e;if(!f||f.length===0)return null;r=e={annotationType:ze.FREETEXT,color:Array.from(o),fontSize:s,value:f.join(`
`),position:p,pageIndex:g-1,rect:l.slice(0),rotation:u,id:c,deleted:!1,popupRef:d}}const i=await super.deserialize(e,t,n);return i.#s=e.fontSize,i.#e=Ee.makeHexColor(...e.color),i.#t=Gt.#f(e.value),i.annotationElementId=e.id||null,i._initialData=r,i}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Gt._internalPadding*this.parentScale,n=this.getRect(t,t),r=Le._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),i={annotationType:ze.FREETEXT,color:r,fontSize:this.#s,value:this.#h(),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?i:this.annotationElementId&&!this.#a(i)?null:(i.id=this.annotationElementId,i)}#a(e){const{value:t,fontSize:n,color:r,pageIndex:i}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((s,o)=>s!==r[o])||e.pageIndex!==i}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(this.deleted)return t;const{style:n}=t;n.fontSize=`calc(${this.#s}px * var(--scale-factor))`,n.color=this.#e,t.replaceChildren();for(const i of this.#t.split(`
`)){const s=document.createElement("div");s.append(i?document.createTextNode(i):document.createElement("br")),t.append(s)}const r=Gt._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(r,r),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class ge{static PRECISION=1e-4;toSVGPath(){dt("Abstract method `toSVGPath` must be implemented.")}get box(){dt("Abstract getter `box` must be implemented.")}serialize(e,t){dt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,r,i,s){s||=new Float32Array(e.length);for(let o=0,l=e.length;o<l;o+=2)s[o]=t+e[o]*r,s[o+1]=n+e[o+1]*i;return s}static _rescaleAndSwap(e,t,n,r,i,s){s||=new Float32Array(e.length);for(let o=0,l=e.length;o<l;o+=2)s[o]=t+e[o+1]*r,s[o+1]=n+e[o]*i;return s}static _translate(e,t,n,r){r||=new Float32Array(e.length);for(let i=0,s=e.length;i<s;i+=2)r[i]=t+e[i],r[i+1]=n+e[i+1];return r}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,r,i){switch(i){case 90:return[1-t/n,e/r];case 180:return[1-e/n,1-t/r];case 270:return[t/n,1-e/r];default:return[e/n,t/r]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,r,i,s){return[(e+5*n)/6,(t+5*r)/6,(5*n+i)/6,(5*r+s)/6,(n+i)/2,(r+s)/2]}}class qn{#e;#t=[];#n;#i;#s=[];#r=new Float32Array(18);#l;#o;#u;#c;#d;#h;#f=[];static#a=8;static#p=2;static#m=qn.#a+qn.#p;constructor({x:e,y:t},n,r,i,s,o=0){this.#e=n,this.#h=i*r,this.#i=s,this.#r.set([NaN,NaN,NaN,NaN,e,t],6),this.#n=o,this.#c=qn.#a*r,this.#u=qn.#m*r,this.#d=r,this.#f.push(e,t)}isEmpty(){return isNaN(this.#r[8])}#g(){const e=this.#r.subarray(4,6),t=this.#r.subarray(16,18),[n,r,i,s]=this.#e;return[(this.#l+(e[0]-t[0])/2-n)/i,(this.#o+(e[1]-t[1])/2-r)/s,(this.#l+(t[0]-e[0])/2-n)/i,(this.#o+(t[1]-e[1])/2-r)/s]}add({x:e,y:t}){this.#l=e,this.#o=t;const[n,r,i,s]=this.#e;let[o,l,u,c]=this.#r.subarray(8,12);const d=e-u,f=t-c,p=Math.hypot(d,f);if(p<this.#u)return!1;const g=p-this.#c,h=g/p,v=h*d,b=h*f;let _=o,C=l;o=u,l=c,u+=v,c+=b,this.#f?.push(e,t);const E=-b/g,k=v/g,H=E*this.#h,T=k*this.#h;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([u+H,c+T],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([u-H,c-T],16),isNaN(this.#r[6])?(this.#s.length===0&&(this.#r.set([o+H,l+T],2),this.#s.push(NaN,NaN,NaN,NaN,(o+H-n)/i,(l+T-r)/s),this.#r.set([o-H,l-T],14),this.#t.push(NaN,NaN,NaN,NaN,(o-H-n)/i,(l-T-r)/s)),this.#r.set([_,C,o,l,u,c],6),!this.isEmpty()):(this.#r.set([_,C,o,l,u,c],6),Math.abs(Math.atan2(C-l,_-o)-Math.atan2(b,v))<Math.PI/2?([o,l,u,c]=this.#r.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((o+u)/2-n)/i,((l+c)/2-r)/s),[o,l,_,C]=this.#r.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((_+o)/2-n)/i,((C+l)/2-r)/s),!0):([_,C,o,l,u,c]=this.#r.subarray(0,6),this.#s.push(((_+5*o)/6-n)/i,((C+5*l)/6-r)/s,((5*o+u)/6-n)/i,((5*l+c)/6-r)/s,((o+u)/2-n)/i,((l+c)/2-r)/s),[u,c,o,l,_,C]=this.#r.subarray(12,18),this.#t.push(((_+5*o)/6-n)/i,((C+5*l)/6-r)/s,((5*o+u)/6-n)/i,((5*l+c)/6-r)/s,((o+u)/2-n)/i,((l+c)/2-r)/s),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#s,t=this.#t;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#v();const n=[];n.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?n.push(`L${e[r+4]} ${e[r+5]}`):n.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);this.#b(n);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?n.push(`L${t[r+4]} ${t[r+5]}`):n.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return this.#w(n),n.join(" ")}#v(){const[e,t,n,r]=this.#e,[i,s,o,l]=this.#g();return`M${(this.#r[2]-e)/n} ${(this.#r[3]-t)/r} L${(this.#r[4]-e)/n} ${(this.#r[5]-t)/r} L${i} ${s} L${o} ${l} L${(this.#r[16]-e)/n} ${(this.#r[17]-t)/r} L${(this.#r[14]-e)/n} ${(this.#r[15]-t)/r} Z`}#w(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#b(e){const[t,n,r,i]=this.#e,s=this.#r.subarray(4,6),o=this.#r.subarray(16,18),[l,u,c,d]=this.#g();e.push(`L${(s[0]-t)/r} ${(s[1]-n)/i} L${l} ${u} L${c} ${d} L${(o[0]-t)/r} ${(o[1]-n)/i}`)}newFreeDrawOutline(e,t,n,r,i,s){return new Do(e,t,n,r,i,s)}getOutlines(){const e=this.#s,t=this.#t,n=this.#r,[r,i,s,o]=this.#e,l=new Float32Array((this.#f?.length??0)+2);for(let d=0,f=l.length-2;d<f;d+=2)l[d]=(this.#f[d]-r)/s,l[d+1]=(this.#f[d+1]-i)/o;if(l[l.length-2]=(this.#l-r)/s,l[l.length-1]=(this.#o-i)/o,isNaN(n[6])&&!this.isEmpty())return this.#y(l);const u=new Float32Array(this.#s.length+24+this.#t.length);let c=e.length;for(let d=0;d<c;d+=2){if(isNaN(e[d])){u[d]=u[d+1]=NaN;continue}u[d]=e[d],u[d+1]=e[d+1]}c=this.#C(u,c);for(let d=t.length-6;d>=6;d-=6)for(let f=0;f<6;f+=2){if(isNaN(t[d+f])){u[c]=u[c+1]=NaN,c+=2;continue}u[c]=t[d+f],u[c+1]=t[d+f+1],c+=2}return this.#S(u,c),this.newFreeDrawOutline(u,l,this.#e,this.#d,this.#n,this.#i)}#y(e){const t=this.#r,[n,r,i,s]=this.#e,[o,l,u,c]=this.#g(),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-n)/i,(t[3]-r)/s,NaN,NaN,NaN,NaN,(t[4]-n)/i,(t[5]-r)/s,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,u,c,NaN,NaN,NaN,NaN,(t[16]-n)/i,(t[17]-r)/s,NaN,NaN,NaN,NaN,(t[14]-n)/i,(t[15]-r)/s],0),this.newFreeDrawOutline(d,e,this.#e,this.#d,this.#n,this.#i)}#S(e,t){const n=this.#t;return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6}#C(e,t){const n=this.#r.subarray(4,6),r=this.#r.subarray(16,18),[i,s,o,l]=this.#e,[u,c,d,f]=this.#g();return e.set([NaN,NaN,NaN,NaN,(n[0]-i)/o,(n[1]-s)/l,NaN,NaN,NaN,NaN,u,c,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(r[0]-i)/o,(r[1]-s)/l],t),t+=24}}class Do extends ge{#e;#t=new Float32Array(4);#n;#i;#s;#r;#l;constructor(e,t,n,r,i,s){super(),this.#l=e,this.#s=t,this.#e=n,this.#r=r,this.#n=i,this.#i=s,this.lastPoint=[NaN,NaN],this.#o(s);const[o,l,u,c]=this.#t;for(let d=0,f=e.length;d<f;d+=2)e[d]=(e[d]-o)/u,e[d+1]=(e[d+1]-l)/c;for(let d=0,f=t.length;d<f;d+=2)t[d]=(t[d]-o)/u,t[d+1]=(t[d+1]-l)/c}toSVGPath(){const e=[`M${this.#l[4]} ${this.#l[5]}`];for(let t=6,n=this.#l.length;t<n;t+=6){if(isNaN(this.#l[t])){e.push(`L${this.#l[t+4]} ${this.#l[t+5]}`);continue}e.push(`C${this.#l[t]} ${this.#l[t+1]} ${this.#l[t+2]} ${this.#l[t+3]} ${this.#l[t+4]} ${this.#l[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,n,r],i){const s=n-e,o=r-t;let l,u;switch(i){case 0:l=ge._rescale(this.#l,e,r,s,-o),u=ge._rescale(this.#s,e,r,s,-o);break;case 90:l=ge._rescaleAndSwap(this.#l,e,t,s,o),u=ge._rescaleAndSwap(this.#s,e,t,s,o);break;case 180:l=ge._rescale(this.#l,n,t,-s,o),u=ge._rescale(this.#s,n,t,-s,o);break;case 270:l=ge._rescaleAndSwap(this.#l,n,r,-s,-o),u=ge._rescaleAndSwap(this.#s,n,r,-s,-o);break}return{outline:Array.from(l),points:[Array.from(u)]}}#o(e){const t=this.#l;let n=t[4],r=t[5],i=n,s=r,o=n,l=r,u=n,c=r;const d=e?Math.max:Math.min;for(let p=6,g=t.length;p<g;p+=6){if(isNaN(t[p]))i=Math.min(i,t[p+4]),s=Math.min(s,t[p+5]),o=Math.max(o,t[p+4]),l=Math.max(l,t[p+5]),c<t[p+5]?(u=t[p+4],c=t[p+5]):c===t[p+5]&&(u=d(u,t[p+4]));else{const h=Ee.bezierBoundingBox(n,r,...t.slice(p,p+6));i=Math.min(i,h[0]),s=Math.min(s,h[1]),o=Math.max(o,h[2]),l=Math.max(l,h[3]),c<h[3]?(u=h[2],c=h[3]):c===h[3]&&(u=d(u,h[2]))}n=t[p+4],r=t[p+5]}const f=this.#t;f[0]=i-this.#n,f[1]=s-this.#n,f[2]=o-i+2*this.#n,f[3]=l-s+2*this.#n,this.lastPoint=[u,c]}get box(){return this.#t}newOutliner(e,t,n,r,i,s=0){return new qn(e,t,n,r,i,s)}getNewOutline(e,t){const[n,r,i,s]=this.#t,[o,l,u,c]=this.#e,d=i*u,f=s*c,p=n*u+o,g=r*c+l,h=this.newOutliner({x:this.#s[0]*d+p,y:this.#s[1]*f+g},this.#e,this.#r,e,this.#i,t??this.#n);for(let v=2;v<this.#s.length;v+=2)h.add({x:this.#s[v]*d+p,y:this.#s[v+1]*f+g});return h.getOutlines()}}class _s{#e;#t;#n=[];#i=[];constructor(e,t=0,n=0,r=!0){let i=1/0,s=-1/0,o=1/0,l=-1/0;const u=10**-4;for(const{x:v,y:b,width:_,height:C}of e){const E=Math.floor((v-t)/u)*u,k=Math.ceil((v+_+t)/u)*u,H=Math.floor((b-t)/u)*u,T=Math.ceil((b+C+t)/u)*u,A=[E,H,T,!0],B=[k,H,T,!1];this.#n.push(A,B),i=Math.min(i,E),s=Math.max(s,k),o=Math.min(o,H),l=Math.max(l,T)}const c=s-i+2*n,d=l-o+2*n,f=i-n,p=o-n,g=this.#n.at(r?-1:-2),h=[g[0],g[2]];for(const v of this.#n){const[b,_,C]=v;v[0]=(b-f)/c,v[1]=(_-p)/d,v[2]=(C-p)/d}this.#e=new Float32Array([f,p,c,d]),this.#t=h}getOutlines(){this.#n.sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of this.#n)t[3]?(e.push(...this.#u(t)),this.#l(t)):(this.#o(t),e.push(...this.#u(t)));return this.#s(e)}#s(e){const t=[],n=new Set;for(const s of e){const[o,l,u]=s;t.push([o,l,s],[o,u,s])}t.sort((s,o)=>s[1]-o[1]||s[0]-o[0]);for(let s=0,o=t.length;s<o;s+=2){const l=t[s][2],u=t[s+1][2];l.push(u),u.push(l),n.add(l),n.add(u)}const r=[];let i;for(;n.size>0;){const s=n.values().next().value;let[o,l,u,c,d]=s;n.delete(s);let f=o,p=l;for(i=[o,u],r.push(i);;){let g;if(n.has(c))g=c;else if(n.has(d))g=d;else break;n.delete(g),[o,l,u,c,d]=g,f!==o&&(i.push(f,p,o,p===l?l:u),f=o),p=p===l?u:l}i.push(f,p)}return new ju(r,this.#e,this.#t)}#r(e){const t=this.#i;let n=0,r=t.length-1;for(;n<=r;){const i=n+r>>1,s=t[i][0];if(s===e)return i;s<e?n=i+1:r=i-1}return r+1}#l([,e,t]){const n=this.#r(e);this.#i.splice(n,0,[e,t])}#o([,e,t]){const n=this.#r(e);for(let r=n;r<this.#i.length;r++){const[i,s]=this.#i[r];if(i!==e)break;if(i===e&&s===t){this.#i.splice(r,1);return}}for(let r=n-1;r>=0;r--){const[i,s]=this.#i[r];if(i!==e)break;if(i===e&&s===t){this.#i.splice(r,1);return}}}#u(e){const[t,n,r]=e,i=[[t,n,r]],s=this.#r(r);for(let o=0;o<s;o++){const[l,u]=this.#i[o];for(let c=0,d=i.length;c<d;c++){const[,f,p]=i[c];if(!(u<=f||p<=l)){if(f>=l){if(p>u)i[c][1]=u;else{if(d===1)return[];i.splice(c,1),c--,d--}continue}i[c][2]=l,p>u&&i.push([t,u,p])}}}return i}}class ju extends ge{#e;#t;constructor(e,t,n){super(),this.#t=e,this.#e=t,this.lastPoint=n}toSVGPath(){const e=[];for(const t of this.#t){let[n,r]=t;e.push(`M${n} ${r}`);for(let i=2;i<t.length;i+=2){const s=t[i],o=t[i+1];s===n?(e.push(`V${o}`),r=o):o===r&&(e.push(`H${s}`),n=s)}e.push("Z")}return e.join(" ")}serialize([e,t,n,r],i){const s=[],o=n-e,l=r-t;for(const u of this.#t){const c=new Array(u.length);for(let d=0;d<u.length;d+=2)c[d]=e+u[d]*o,c[d+1]=r-u[d+1]*l;s.push(c)}return s}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class ws extends qn{newFreeDrawOutline(e,t,n,r,i,s){return new Vu(e,t,n,r,i,s)}}class Vu extends Do{newOutliner(e,t,n,r,i,s=0){return new ws(e,t,n,r,i,s)}}class mn{#e=null;#t=null;#n;#i=null;#s=!1;#r=!1;#l=null;#o;#u=null;#c=null;#d;static#h=null;static get _keyboardManager(){return We(this,"_keyboardManager",new ji([[["Escape","mac+Escape"],mn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],mn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],mn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],mn.prototype._moveToPrevious],[["Home","mac+Home"],mn.prototype._moveToBeginning],[["End","mac+End"],mn.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#r=!1,this.#d=Xe.HIGHLIGHT_COLOR,this.#l=e):(this.#r=!0,this.#d=Xe.HIGHLIGHT_DEFAULT_COLOR),this.#c=e?._uiManager||t,this.#o=this.#c._eventBus,this.#n=e?.color||this.#c?.highlightColors.values().next().value||"#FFFF98",mn.#h||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=this.#c._signal;e.addEventListener("click",this.#m.bind(this),{signal:t}),e.addEventListener("keydown",this.#p.bind(this),{signal:t});const n=this.#t=document.createElement("span");return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=this.#n,e.append(n),e}renderMainDropdown(){const e=this.#i=this.#f();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#f(){const e=document.createElement("div"),t=this.#c._signal;e.addEventListener("contextmenu",wn,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,r]of this.#c.highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",r),i.title=n,i.setAttribute("data-l10n-id",mn.#h[n]);const s=document.createElement("span");i.append(s),s.className="swatch",s.style.backgroundColor=r,i.setAttribute("aria-selected",r===this.#n),i.addEventListener("click",this.#a.bind(this,r),{signal:t}),e.append(i)}return e.addEventListener("keydown",this.#p.bind(this),{signal:t}),e}#a(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:this.#d,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#m(e);return}const t=e.target.getAttribute("data-color");t&&this.#a(t,e)}_moveToNext(e){if(!this.#v){this.#m(e);return}if(e.target===this.#e){this.#i.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#i?.firstChild||e.target===this.#e){this.#v&&this._hideDropdownFromKeyboard();return}this.#v||this.#m(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#v){this.#m(e);return}this.#i.firstChild?.focus()}_moveToEnd(e){if(!this.#v){this.#m(e);return}this.#i.lastChild?.focus()}#p(e){mn._keyboardManager.exec(this,e)}#m(e){if(this.#v){this.hideDropdown();return}if(this.#s=e.detail===0,this.#u||(this.#u=new AbortController,window.addEventListener("pointerdown",this.#g.bind(this),{signal:this.#c.combinedSignal(this.#u)})),this.#i){this.#i.classList.remove("hidden");return}const t=this.#i=this.#f();this.#e.append(t)}#g(e){this.#i?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#u?.abort(),this.#u=null}get#v(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#v){this.#l?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#i)return;const t=this.#c.highlightColors.values();for(const n of this.#i.children)n.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#i?.remove(),this.#i=null}}class Ft extends Le{#e=null;#t=0;#n;#i=null;#s=null;#r=null;#l=null;#o=0;#u=null;#c=null;#d=null;#h=!1;#f=null;#a;#p=null;#m="";#g;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=ze.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=Ft.prototype;return We(this,"_keyboardManager",new ji([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||Ft._defaultColor,this.#g=e.thickness||Ft._defaultThickness,this.#a=e.opacity||Ft._defaultOpacity,this.#n=e.boxes||null,this.#v=e.methodOfCreation||"",this.#m=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#h=!0,this.#b(e),this.#M()):this.#n&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#l=e.focusNode,this.#o=e.focusOffset,this.#w(),this.#M(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#g,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#w(){const e=new _s(this.#n,.001);this.#c=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const t=new _s(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#r=t.getOutlines();const{lastPoint:n}=this.#r;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#b({highlightOutlines:e,highlightId:t,clipPathId:n}){this.#c=e;const r=1.5;if(this.#r=e.getNewOutline(this.#g/2+r,.0025),t>=0)this.#d=t,this.#i=n,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const c=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:Ft.#E(this.#c.box,(c-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:Ft.#E(this.#r.box,c),path:{d:this.#r.toSVGPath()}})}const[i,s,o,l]=e.box;switch(this.rotation){case 0:this.x=i,this.y=s,this.width=o,this.height=l;break;case 90:{const[c,d]=this.parentDimensions;this.x=s,this.y=1-i,this.width=o*d/c,this.height=l*c/d;break}case 180:this.x=1-i,this.y=1-s,this.width=o,this.height=l;break;case 270:{const[c,d]=this.parentDimensions;this.x=1-s,this.y=i,this.width=o*d/c,this.height=l*c/d;break}}const{lastPoint:u}=this.#r;this.#f=[(u[0]-i)/o,(u[1]-s)/l]}static initialize(e,t){Le.initialize(e,t),Ft._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Xe.HIGHLIGHT_DEFAULT_COLOR:Ft._defaultColor=t;break;case Xe.HIGHLIGHT_THICKNESS:Ft._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#f}updateParams(e,t){switch(e){case Xe.HIGHLIGHT_COLOR:this.#y(t);break;case Xe.HIGHLIGHT_THICKNESS:this.#S(t);break}}static get defaultPropertiesToUpdate(){return[[Xe.HIGHLIGHT_DEFAULT_COLOR,Ft._defaultColor],[Xe.HIGHLIGHT_THICKNESS,Ft._defaultThickness]]}get propertiesToUpdate(){return[[Xe.HIGHLIGHT_COLOR,this.color||Ft._defaultColor],[Xe.HIGHLIGHT_THICKNESS,this.#g||Ft._defaultThickness],[Xe.HIGHLIGHT_FREE,this.#h]]}#y(e){const t=(i,s)=>{this.color=i,this.#a=s,this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:i,"fill-opacity":s}}),this.#s?.updateColor(i)},n=this.color,r=this.#a;this.addCommands({cmd:t.bind(this,e,Ft._defaultOpacity),undo:t.bind(this,n,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Xe.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#S(e){const t=this.#g,n=r=>{this.#g=r,this.#C(r)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Xe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(this.#s=new mn({editor:this}),e.addColorPicker(this.#s)),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#R())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#R())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#k(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#M(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#k():e&&(this.#M(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#C(e){if(!this.#h)return;this.#b({highlightOutlines:this.#c.getNewOutline(e/2)}),this.fixAndSetPosition();const[t,n]=this.parentDimensions;this.setDims(this.width*t,this.height*n)}#k(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#M(e=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=e.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#a},rootClass:{highlight:!0,free:this.#h},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#h),this.#u&&(this.#u.style.clipPath=this.#i))}static#E([e,t,n,r],i){switch(i){case 90:return[1-t-r,e,r,n];case 180:return[1-e-n,1-t-r,n,r];case 270:return[t,1-e-n,r,n]}return[e,t,n,r]}rotate(e){const{drawLayer:t}=this.parent;let n;this.#h?(e=(e-this.rotation+360)%360,n=Ft.#E(this.#c.box,e)):n=Ft.#E([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#d,{bbox:n,root:{"data-main-rotation":e}}),t.updateProperties(this.#p,{bbox:Ft.#E(this.#r.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#m&&(e.setAttribute("aria-label",this.#m),e.setAttribute("role","mark")),this.#h?e.classList.add("free"):this.div.addEventListener("keydown",this.#x.bind(this),{signal:this._uiManager._signal});const t=this.#u=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#i;const[n,r]=this.parentDimensions;return this.setDims(this.width*n,this.height*r),lr(this,this.#u,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#x(e){Ft._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#P(!0);break;case 1:case 3:this.#P(!1);break}}#P(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#l,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#h||this.#P(!1))}get _mustFixPosition(){return!this.#h}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!e}}))}#R(){return this.#h?this.rotation:0}#D(){if(this.#h)return null;const[e,t]=this.pageDimensions,[n,r]=this.pageTranslation,i=this.#n,s=new Float32Array(i.length*8);let o=0;for(const{x:l,y:u,width:c,height:d}of i){const f=l*e+n,p=(1-u)*t+r;s[o]=s[o+4]=f,s[o+1]=s[o+3]=p,s[o+2]=s[o+6]=f+c*e,s[o+5]=s[o+7]=p-d*t,o+=8}return s}#O(e){return this.#c.serialize(e,this.#R())}static startHighlighting(e,t,{target:n,x:r,y:i}){const{x:s,y:o,width:l,height:u}=n.getBoundingClientRect(),c=new AbortController,d=e.combinedSignal(c),f=p=>{c.abort(),this.#_(e,p)};window.addEventListener("blur",f,{signal:d}),window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("pointerdown",dn,{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",wn,{signal:d}),n.addEventListener("pointermove",this.#A.bind(this,e),{signal:d}),this._freeHighlight=new ws({x:r,y:i},[s,o,l,u],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#A(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#_(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,n){let r=null;if(e instanceof Lo){const{data:{quadPoints:g,rect:h,rotation:v,id:b,color:_,opacity:C,popupRef:E},parent:{page:{pageNumber:k}}}=e;r=e={annotationType:ze.HIGHLIGHT,color:Array.from(_),opacity:C,quadPoints:g,boxes:null,pageIndex:k-1,rect:h.slice(0),rotation:v,id:b,deleted:!1,popupRef:E}}else if(e instanceof Is){const{data:{inkLists:g,rect:h,rotation:v,id:b,color:_,borderStyle:{rawWidth:C},popupRef:E},parent:{page:{pageNumber:k}}}=e;r=e={annotationType:ze.HIGHLIGHT,color:Array.from(_),thickness:C,inkLists:g,boxes:null,pageIndex:k-1,rect:h.slice(0),rotation:v,id:b,deleted:!1,popupRef:E}}const{color:i,quadPoints:s,inkLists:o,opacity:l}=e,u=await super.deserialize(e,t,n);u.color=Ee.makeHexColor(...i),u.#a=l||1,o&&(u.#g=e.thickness),u.annotationElementId=e.id||null,u._initialData=r;const[c,d]=u.pageDimensions,[f,p]=u.pageTranslation;if(s){const g=u.#n=[];for(let h=0;h<s.length;h+=8)g.push({x:(s[h]-f)/c,y:1-(s[h+1]-p)/d,width:(s[h+2]-s[h])/c,height:(s[h+1]-s[h+5])/d});u.#w(),u.#M(),u.rotate(u.rotation)}else if(o){u.#h=!0;const g=o[0],h={x:g[0]-f,y:d-(g[1]-p)},v=new ws(h,[0,0,c,d],1,u.#g/2,!0,.001);for(let C=0,E=g.length;C<E;C+=2)h.x=g[C]-f,h.y=d-(g[C+1]-p),v.add(h);const{id:b,clipPathId:_}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:u.color,"fill-opacity":u._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:v.toSVGPath()}},!0,!0);u.#b({highlightOutlines:v.getOutlines(),highlightId:b,clipPathId:_}),u.#M()}return u}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),n=Le._colorManager.convert(this.color),r={annotationType:ze.HIGHLIGHT,color:n,opacity:this.#a,thickness:this.#g,quadPoints:this.#D(),outlines:this.#O(t),pageIndex:this.pageIndex,rect:t,rotation:this.#R(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#I(r)?null:(r.id=this.annotationElementId,r)}#I(e){const{color:t}=this._initialData;return e.color.some((n,r)=>n!==t[r])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class Wu{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))this.updateProperty(t,n)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){dt("Not implemented")}}class Re extends Le{#e=null;#t;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#s=null;static#r=NaN;static#l=null;static#o=null;static#u=NaN;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,e.drawOutlines&&(this.#c(e),this.#f())}#c({drawOutlines:e,drawId:t,drawingOptions:n}){this.#e=e,this._drawingOptions||=n,t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#d(e,this.parent),this.#m(e.box)}#d(e,t){const{id:n}=t.drawLayer.draw(Re._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[r,i]of Object.entries(t))n.has(r)?Object.assign(e[r],i):e[r]=i;return e}static getDefaultDrawingOptions(e){dt("Not implemented")}static get typesMap(){dt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,t),this._currentParent&&(Re.#n.updateProperty(n,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,r]of this.typesMap)e.push([n,t[r]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,r]of this.constructor.typesMap)e.push([n,t[r]]);return e}_updateProperty(e,t,n){const r=this._drawingOptions,i=r[t],s=o=>{r.updateProperty(t,o);const l=this.#e.updateProperty(t,o);l&&this.#m(l),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:s.bind(this,n),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Re._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#p()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Re._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#p()),{bbox:this.#g()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g(e,t)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Re._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#h(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#m(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#h()):e&&(this._uiManager.addShouldRescale(this),this.#f(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#h(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#e,e)}}#a([e,t,n,r]){const{parentDimensions:[i,s],rotation:o}=this;switch(o){case 90:return[t,1-e,n*(s/i),r*(i/s)];case 180:return[1-e,1-t,n,r];case 270:return[1-t,e,n*(s/i),r*(i/s)];default:return[e,t,n,r]}}#p(){const{x:e,y:t,width:n,height:r,parentDimensions:[i,s],rotation:o}=this;switch(o){case 90:return[1-t,e,n*(i/s),r*(s/i)];case 180:return[1-e,1-t,n,r];case 270:return[t,1-e,n*(i/s),r*(s/i)];default:return[e,t,n,r]}}#m(e){if([this.x,this.y,this.width,this.height]=this.#a(e),this.div){this.fixAndSetPosition();const[t,n]=this.parentDimensions;this.setDims(this.width*t,this.height*n)}this._onResized()}#g(){const{x:e,y:t,width:n,height:r,rotation:i,parentRotation:s,parentDimensions:[o,l]}=this;switch((i*4+s)/90){case 1:return[1-t-r,e,r,n];case 2:return[1-e-n,1-t-r,n,r];case 3:return[t,1-e-n,r,n];case 4:return[e,t-n*(o/l),r*(l/o),n*(o/l)];case 5:return[1-t,e,n*(o/l),r*(l/o)];case 6:return[1-e-r*(l/o),1-t,r*(l/o),n*(o/l)];case 7:return[t-n*(o/l),1-e-r*(l/o),n*(o/l),r*(l/o)];case 8:return[e-n,t-r,n,r];case 9:return[1-t,e-n,r,n];case 10:return[1-e,1-t,n,r];case 11:return[t-r,1-e,r,n];case 12:return[e-r*(l/o),t,r*(l/o),n*(o/l)];case 13:return[1-t-n*(o/l),e-r*(l/o),n*(o/l),r*(l/o)];case 14:return[1-e,1-t-n*(o/l),r*(l/o),n*(o/l)];case 15:return[t,1-e,n*(o/l),r*(l/o)];default:return[e,t,n,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Re._mergeSVGProperties({bbox:this.#g()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#m(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const e=super.render();e.classList.add("draw");const t=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal";const[n,r]=this.parentDimensions;return this.setDims(this.width*n,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),e}static createDrawerInstance(e,t,n,r,i){dt("Not implemented")}static startDrawing(e,t,n,r){const{target:i,offsetX:s,offsetY:o,pointerId:l,pointerType:u}=r;if(Re.#l&&Re.#l!==u)return;const{viewport:{rotation:c}}=e,{width:d,height:f}=i.getBoundingClientRect(),p=Re.#i=new AbortController,g=e.combinedSignal(p);if(Re.#r||=l,Re.#l??=u,window.addEventListener("pointerup",h=>{Re.#r===h.pointerId?this._endDraw(h):Re.#o?.delete(h.pointerId)},{signal:g}),window.addEventListener("pointercancel",h=>{Re.#r===h.pointerId?this._currentParent.endDrawingSession():Re.#o?.delete(h.pointerId)},{signal:g}),window.addEventListener("pointerdown",h=>{Re.#l===h.pointerType&&((Re.#o||=new Set).add(h.pointerId),Re.#n.isCancellable()&&(Re.#n.removeLastElement(),Re.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",wn,{signal:g}),i.addEventListener("pointermove",this._drawMove.bind(this),{signal:g}),i.addEventListener("touchmove",h=>{h.timeStamp===Re.#u&&dn(h)},{signal:g}),e.toggleDrawing(),t._editorUndoBar?.hide(),Re.#n){e.drawLayer.updateProperties(this._currentDrawId,Re.#n.startNew(s,o,d,f,c));return}t.updateUIForDefaultProperties(this),Re.#n=this.createDrawerInstance(s,o,d,f,c),Re.#s=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(Re.#s.toSVGProperties(),Re.#n.defaultSVGProperties),!0,!1)}static _drawMove(e){if(Re.#u=-1,!Re.#n)return;const{offsetX:t,offsetY:n,pointerId:r}=e;if(Re.#r===r){if(Re.#o?.size>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Re.#n.add(t,n)),Re.#u=e.timeStamp,dn(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,Re.#n=null,Re.#s=null,Re.#l=null,Re.#u=NaN),Re.#i&&(Re.#i.abort(),Re.#i=null,Re.#r=NaN,Re.#o=null)}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e&&t.drawLayer.updateProperties(this._currentDrawId,Re.#n.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const n=Re.#n,r=this._currentDrawId,i=n.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(r,n.setLastElement(i))},undo:()=>{t.drawLayer.updateProperties(r,n.removeLastElement())},mustExec:!1,type:Xe.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(Xe.DRAW_STEP),!Re.#n.isEmpty()){const{pageDimensions:[n,r],scale:i}=t,s=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Re.#n.getOutlines(n*i,r*i,i,this._INNER_MARGIN),drawingOptions:Re.#s,mustBeCommitted:!e});return this._cleanup(!0),s}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,r,i,s){dt("Not implemented")}static async deserialize(e,t,n){const{rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:o}}=t.viewport,l=this.deserializeDraw(s,o,r,i,this._INNER_MARGIN,e),u=await super.deserialize(e,t,n);return u.createDrawingOptions(e),u.#c({drawOutlines:l}),u.#f(),u.onScaleChanging(),u.rotate(),u}serializeDraw(e){const[t,n]=this.pageTranslation,[r,i]=this.pageDimensions;return this.#e.serialize([t,n,r,i],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class $u{#e=new Float64Array(6);#t;#n;#i;#s;#r;#l="";#o=0;#u=new _r;#c;#d;constructor(e,t,n,r,i,s){this.#c=n,this.#d=r,this.#i=i,this.#s=s,[e,t]=this.#h(e,t);const o=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#r=[e,t],this.#n=[{line:o,points:this.#r}],this.#e.set(o,0)}updateProperty(e,t){e==="stroke-width"&&(this.#s=t)}#h(e,t){return ge._normalizePoint(e,t,this.#c,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#r.length<=10}add(e,t){[e,t]=this.#h(e,t);const[n,r,i,s]=this.#e.subarray(2,6),o=e-i,l=t-s;return Math.hypot(this.#c*o,this.#d*l)<=2?null:(this.#r.push(e,t),isNaN(n)?(this.#e.set([i,s,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([n,r,i,s,e,t],0),this.#t.push(...ge.createBezierPoints(n,r,i,s,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,r,i){this.#c=n,this.#d=r,this.#i=i,[e,t]=this.#h(e,t);const s=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#r=[e,t];const o=this.#n.at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),this.#n.push({line:s,points:this.#r}),this.#e.set(s,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(e){return this.#n?(this.#n.push(e),this.#t=e.line,this.#r=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#u.setLastElement(e)}removeLastElement(){if(!this.#n)return this.#u.removeLastElement();this.#n.pop(),this.#l="";for(let e=0,t=this.#n.length;e<t;e++){const{line:n,points:r}=this.#n[e];this.#t=n,this.#r=r,this.#o=0,this.toSVGPath()}return{path:{d:this.#l}}}toSVGPath(){const e=ge.svgRound(this.#t[4]),t=ge.svgRound(this.#t[5]);if(this.#r.length===2)return this.#l=`${this.#l} M ${e} ${t} Z`,this.#l;if(this.#r.length<=6){const r=this.#l.lastIndexOf("M");this.#l=`${this.#l.slice(0,r)} M ${e} ${t}`,this.#o=6}if(this.#r.length===4){const r=ge.svgRound(this.#t[10]),i=ge.svgRound(this.#t[11]);return this.#l=`${this.#l} L ${r} ${i}`,this.#o=12,this.#l}const n=[];this.#o===0&&(n.push(`M ${e} ${t}`),this.#o=6);for(let r=this.#o,i=this.#t.length;r<i;r+=6){const[s,o,l,u,c,d]=this.#t.slice(r,r+6).map(ge.svgRound);n.push(`C${s} ${o} ${l} ${u} ${c} ${d}`)}return this.#l+=n.join(" "),this.#o=this.#t.length,this.#l}getOutlines(e,t,n,r){const i=this.#n.at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),this.#u.build(this.#n,e,t,n,this.#i,this.#s,r),this.#e=null,this.#t=null,this.#n=null,this.#l=null,this.#u}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class _r extends ge{#e;#t=0;#n;#i;#s;#r;#l;#o;#u;build(e,t,n,r,i,s,o){this.#s=t,this.#r=n,this.#l=r,this.#o=i,this.#u=s,this.#n=o??0,this.#i=e,this.#h()}setLastElement(e){return this.#i.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#i){if(e.push(`M${ge.svgRound(t[4])} ${ge.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12){e.push(`L${ge.svgRound(t[10])} ${ge.svgRound(t[11])}`);continue}for(let n=6,r=t.length;n<r;n+=6){const[i,s,o,l,u,c]=t.subarray(n,n+6).map(ge.svgRound);e.push(`C${i} ${s} ${o} ${l} ${u} ${c}`)}}return e.join("")}serialize([e,t,n,r],i){const s=[],o=[],[l,u,c,d]=this.#d();let f,p,g,h,v,b,_,C,E;switch(this.#o){case 0:E=ge._rescale,f=e,p=t+r,g=n,h=-r,v=e+l*n,b=t+(1-u-d)*r,_=e+(l+c)*n,C=t+(1-u)*r;break;case 90:E=ge._rescaleAndSwap,f=e,p=t,g=n,h=r,v=e+u*n,b=t+l*r,_=e+(u+d)*n,C=t+(l+c)*r;break;case 180:E=ge._rescale,f=e+n,p=t,g=-n,h=r,v=e+(1-l-c)*n,b=t+u*r,_=e+(1-l)*n,C=t+(u+d)*r;break;case 270:E=ge._rescaleAndSwap,f=e+n,p=t+r,g=-n,h=-r,v=e+(1-u-d)*n,b=t+(1-l-c)*r,_=e+(1-u)*n,C=t+(1-l)*r;break}for(const{line:k,points:H}of this.#i)s.push(E(k,f,p,g,h,i?new Array(k.length):null)),o.push(E(H,f,p,g,h,i?new Array(H.length):null));return{lines:s,points:o,rect:[v,b,_,C]}}static deserialize(e,t,n,r,i,{paths:{lines:s,points:o},rotation:l,thickness:u}){const c=[];let d,f,p,g,h;switch(l){case 0:h=ge._rescale,d=-e/n,f=t/r+1,p=1/n,g=-1/r;break;case 90:h=ge._rescaleAndSwap,d=-t/r,f=-e/n,p=1/r,g=1/n;break;case 180:h=ge._rescale,d=e/n+1,f=-t/r,p=-1/n,g=1/r;break;case 270:h=ge._rescaleAndSwap,d=t/r+1,f=e/n+1,p=-1/r,g=-1/n;break}if(!s){s=[];for(const b of o){const _=b.length;if(_===2){s.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1]]));continue}if(_===4){s.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1],NaN,NaN,NaN,NaN,b[2],b[3]]));continue}const C=new Float32Array(3*(_-2));s.push(C);let[E,k,H,T]=b.subarray(0,4);C.set([NaN,NaN,NaN,NaN,E,k],0);for(let A=4;A<_;A+=2){const B=b[A],z=b[A+1];C.set(ge.createBezierPoints(E,k,H,T,B,z),(A-2)*3),[E,k,H,T]=[H,T,B,z]}}}for(let b=0,_=s.length;b<_;b++)c.push({line:h(s[b].map(C=>C??NaN),d,f,p,g),points:h(o[b].map(C=>C??NaN),d,f,p,g)});const v=new _r;return v.build(c,n,r,1,l,u,i),v}#c(e=this.#u){const t=this.#n+e/2*this.#l;return this.#o%180===0?[t/this.#s,t/this.#r]:[t/this.#r,t/this.#s]}#d(){const[e,t,n,r]=this.#e,[i,s]=this.#c(0);return[e+i,t+s,n-2*i,r-2*s]}#h(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#i){if(r.length<=12){for(let o=4,l=r.length;o<l;o+=6){const[u,c]=r.subarray(o,o+2);e[0]=Math.min(e[0],u),e[1]=Math.min(e[1],c),e[2]=Math.max(e[2],u),e[3]=Math.max(e[3],c)}continue}let i=r[4],s=r[5];for(let o=6,l=r.length;o<l;o+=6){const[u,c,d,f,p,g]=r.subarray(o,o+6);Ee.bezierBoundingBox(i,s,u,c,d,f,p,g,e),i=p,s=g}}const[t,n]=this.#c();e[0]=Math.min(1,Math.max(0,e[0]-t)),e[1]=Math.min(1,Math.max(0,e[1]-n)),e[2]=Math.min(1,Math.max(0,e[2]+t)),e[3]=Math.min(1,Math.max(0,e[3]+n)),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,n]=this.#c();this.#u=e;const[r,i]=this.#c(),[s,o]=[r-t,i-n],l=this.#e;return l[0]-=s,l[1]-=o,l[2]+=2*s,l[3]+=2*o,l}updateParentDimensions([e,t],n){const[r,i]=this.#c();this.#s=e,this.#r=t,this.#l=n;const[s,o]=this.#c(),l=s-r,u=o-i,c=this.#e;return c[0]-=l,c[1]-=u,c[2]+=2*l,c[3]+=2*u,c}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(ge.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ge.svgRound(e)} ${ge.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let n=0,r=0,i=0,s=0,o=0,l=0;switch(this.#t){case 90:r=t/e,i=-e/t,o=e;break;case 180:n=-1,s=-1,o=e,l=t;break;case 270:r=-t/e,i=e/t,l=t;break;default:return""}return`matrix(${n} ${r} ${i} ${s} ${ge.svgRound(o)} ${ge.svgRound(l)})`}getPathResizingSVGProperties([e,t,n,r]){const[i,s]=this.#c(),[o,l,u,c]=this.#e;if(Math.abs(u-i)<=ge.PRECISION||Math.abs(c-s)<=ge.PRECISION){const h=e+n/2-(o+u/2),v=t+r/2-(l+c/2);return{path:{"transform-origin":`${ge.svgRound(e)} ${ge.svgRound(t)}`,transform:`${this.rotationTransform} translate(${h} ${v})`}}}const d=(n-2*i)/(u-2*i),f=(r-2*s)/(c-2*s),p=u/n,g=c/r;return{path:{"transform-origin":`${ge.svgRound(o)} ${ge.svgRound(l)}`,transform:`${this.rotationTransform} scale(${p} ${g}) translate(${ge.svgRound(i)} ${ge.svgRound(s)}) scale(${d} ${f}) translate(${ge.svgRound(-i)} ${ge.svgRound(-s)})`}}}getPathResizedSVGProperties([e,t,n,r]){const[i,s]=this.#c(),o=this.#e,[l,u,c,d]=o;if(o[0]=e,o[1]=t,o[2]=n,o[3]=r,Math.abs(c-i)<=ge.PRECISION||Math.abs(d-s)<=ge.PRECISION){const v=e+n/2-(l+c/2),b=t+r/2-(u+d/2);for(const{line:_,points:C}of this.#i)ge._translate(_,v,b,_),ge._translate(C,v,b,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ge.svgRound(e)} ${ge.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const f=(n-2*i)/(c-2*i),p=(r-2*s)/(d-2*s),g=-f*(l+i)+e+i,h=-p*(u+s)+t+s;if(f!==1||p!==1||g!==0||h!==0)for(const{line:v,points:b}of this.#i)ge._rescale(v,g,h,f,p,v),ge._rescale(b,g,h,f,p,b);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ge.svgRound(e)} ${ge.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],n){const[r,i]=n,s=this.#e,o=e-s[0],l=t-s[1];if(this.#s===r&&this.#r===i)for(const{line:u,points:c}of this.#i)ge._translate(u,o,l,u),ge._translate(c,o,l,c);else{const u=this.#s/r,c=this.#r/i;this.#s=r,this.#r=i;for(const{line:d,points:f}of this.#i)ge._rescale(d,o,l,u,c,d),ge._rescale(f,o,l,u,c,f);s[2]*=u,s[3]*=c}return s[0]=e,s[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ge.svgRound(e)} ${ge.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ge.svgRound(e[0])} ${ge.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class Ds extends Wu{#e;constructor(e){super(),this.#e=e,super.updateProperties({fill:"none",stroke:Le._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this.#e.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Ds(this.#e);return e.updateAll(this),e}}class Fs extends Re{static _type="ink";static _editorType=ze.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0}static initialize(e,t){Le.initialize(e,t),this._defaultDrawingOptions=new Ds(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return We(this,"typesMap",new Map([[Xe.INK_THICKNESS,"stroke-width"],[Xe.INK_COLOR,"stroke"],[Xe.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,r,i){return new $u(e,t,n,r,i,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,r,i,s){return _r.deserialize(e,t,n,r,i,s)}static async deserialize(e,t,n){let r=null;if(e instanceof Is){const{data:{inkLists:s,rect:o,rotation:l,id:u,color:c,opacity:d,borderStyle:{rawWidth:f},popupRef:p},parent:{page:{pageNumber:g}}}=e;r=e={annotationType:ze.INK,color:Array.from(c),thickness:f,opacity:d,paths:{points:s},boxes:null,pageIndex:g-1,rect:o.slice(0),rotation:l,id:u,deleted:!1,popupRef:p}}const i=await super.deserialize(e,t,n);return i.annotationElementId=e.id||null,i._initialData=r,i}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:n}){this._drawingOptions=Fs.getDefaultDrawingOptions({stroke:Ee.makeHexColor(...e),"stroke-width":t,"stroke-opacity":n})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n,rect:r}=this.serializeDraw(e),{_drawingOptions:{stroke:i,"stroke-opacity":s,"stroke-width":o}}=this,l={annotationType:ze.INK,color:Le._colorManager.convert(i),opacity:s,thickness:o,paths:{lines:t,points:n},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?l:this.annotationElementId&&!this.#e(l)?null:(l.id=this.annotationElementId,l)}#e(e){const{color:t,thickness:n,opacity:r,pageIndex:i}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((s,o)=>s!==t[o])||e.thickness!==n||e.opacity!==r||e.pageIndex!==i}renderAnnotationElement(e){const{points:t,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:t}),null}}class Os extends Le{#e=null;#t=null;#n=null;#i=null;#s=null;#r="";#l=null;#o=null;#u=!1;#c=!1;static _type="stamp";static _editorType=ze.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#i=e.bitmapUrl,this.#s=e.bitmapFile}static initialize(e,t){Le.initialize(e,t)}static get supportedTypes(){return We(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return We(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(ze.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#d(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#u=e.isSvg),e.file&&(this.#r=e.file.name),this.#a()}#h(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:i,height:s}=e||this.copyCanvas(null,null,!0).imageData,o=await n.guess({name:"altText",request:{data:r,width:i,height:s,channels:r.length/(i*s)}});if(!o)throw new Error("No response from the AI service.");if(o.error)throw new Error("Error from the AI service.");if(o.cancel)return null;if(!o.output)throw new Error("No valid response from the AI service.");const l=o.output;return await this.setGuessedAltText(l),t&&!this.hasAltTextData()&&(this.altTextData={alt:l,decorative:!1}),l}#f(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(n=>this.#d(n,!0)).finally(()=>this.#h());return}if(this.#i){const n=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(n).then(r=>this.#d(r)).finally(()=>this.#h());return}if(this.#s){const n=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(n).then(r=>this.#d(r)).finally(()=>this.#h());return}const e=document.createElement("input");e.type="file",e.accept=Os.supportedTypesStr;const t=this._uiManager._signal;this.#n=new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#d(r)}n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#h()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#l?.remove(),this.#l=null,this.#o&&(clearTimeout(this.#o),this.#o=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#f();return}super.rebuild(),this.div!==null&&(this.#t&&this.#l===null&&this.#f(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#i||this.#s||this.#t)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#e?this.#a():this.#f(),this.width&&!this.annotationElementId){const[n,r]=this.parentDimensions;this.setAt(e*n,t*r,this.width*n,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#o!==null&&clearTimeout(this.#o);const e=200;this.#o=setTimeout(()=>{this.#o=null,this.#m()},e)}#a(){const{div:e}=this;let{width:t,height:n}=this.#e;const[r,i]=this.pageDimensions,s=.75;if(this.width)t=this.width*r,n=this.height*i;else if(t>s*r||n>s*i){const c=Math.min(s*r/t,s*i/n);t*=c,n*=c}const[o,l]=this.parentDimensions;this.setDims(t*o/r,n*l/i),this._uiManager.enableWaiting(!1);const u=this.#l=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=t/r,this.height=n/i,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#m(),this.#c||(this.parent.addUndoableEditor(this),this.#c=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&u.setAttribute("aria-label",this.#r)}copyCanvas(e,t,n=!1){e||(e=224);const{width:r,height:i}=this.#e,s=new gs;let o=this.#e,l=r,u=i,c=null;if(t){if(r>t||i>t){const H=Math.min(t/r,t/i);l=Math.floor(r*H),u=Math.floor(i*H)}c=document.createElement("canvas");const f=c.width=Math.ceil(l*s.sx),p=c.height=Math.ceil(u*s.sy);this.#u||(o=this.#p(f,p));const g=c.getContext("2d");g.filter=this._uiManager.hcmFilter;let h="white",v="#cfcfd8";this._uiManager.hcmFilter!=="none"?v="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(h="#8f8f9d",v="#42414d");const b=15,_=b*s.sx,C=b*s.sy,E=new OffscreenCanvas(_*2,C*2),k=E.getContext("2d");k.fillStyle=h,k.fillRect(0,0,_*2,C*2),k.fillStyle=v,k.fillRect(0,0,_,C),k.fillRect(_,C,_,C),g.fillStyle=g.createPattern(E,"repeat"),g.fillRect(0,0,f,p),g.drawImage(o,0,0,o.width,o.height,0,0,f,p)}let d=null;if(n){let f,p;if(s.symmetric&&o.width<e&&o.height<e)f=o.width,p=o.height;else if(o=this.#e,r>e||i>e){const v=Math.min(e/r,e/i);f=Math.floor(r*v),p=Math.floor(i*v),this.#u||(o=this.#p(f,p))}const h=new OffscreenCanvas(f,p).getContext("2d",{willReadFrequently:!0});h.drawImage(o,0,0,o.width,o.height,0,0,f,p),d={width:f,height:p,data:h.getImageData(0,0,f,p).data}}return{canvas:c,width:l,height:u,imageData:d}}#p(e,t){const{width:n,height:r}=this.#e;let i=n,s=r,o=this.#e;for(;i>2*e||s>2*t;){const l=i,u=s;i>2*e&&(i=i>=16384?Math.floor(i/2)-1:Math.ceil(i/2)),s>2*t&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2));const c=new OffscreenCanvas(i,s);c.getContext("2d").drawImage(o,0,0,l,u,0,0,i,s),o=c.transferToImageBitmap()}return o}#m(){const[e,t]=this.parentDimensions,{width:n,height:r}=this,i=new gs,s=Math.ceil(n*e*i.sx),o=Math.ceil(r*t*i.sy),l=this.#l;if(!l||l.width===s&&l.height===o)return;l.width=s,l.height=o;const u=this.#u?this.#e:this.#p(s,o),c=l.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(u,0,0,u.width,u.height,0,0,s,o)}getImageForAltText(){return this.#l}#g(e){if(e){if(this.#u){const r=this._uiManager.imageManager.getSvgUrl(this.#t);if(r)return r}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#u){const[t,n]=this.pageDimensions,r=Math.round(this.width*t*mi.PDF_TO_CSS_UNITS),i=Math.round(this.height*n*mi.PDF_TO_CSS_UNITS),s=new OffscreenCanvas(r,i);return s.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,r,i),s.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,n){let r=null;if(e instanceof Io){const{data:{rect:g,rotation:h,id:v,structParent:b,popupRef:_},container:C,parent:{page:{pageNumber:E}}}=e,k=C.querySelector("canvas"),H=n.imageManager.getFromCanvas(C.id,k);k.remove();const T=(await t._structTree.getAriaAttributes(`${Es}${v}`))?.get("aria-label")||"";r=e={annotationType:ze.STAMP,bitmapId:H.id,bitmap:H.bitmap,pageIndex:E-1,rect:g.slice(0),rotation:h,id:v,deleted:!1,accessibilityData:{decorative:!1,altText:T},isSvg:!1,structParent:b,popupRef:_}}const i=await super.deserialize(e,t,n),{rect:s,bitmap:o,bitmapUrl:l,bitmapId:u,isSvg:c,accessibilityData:d}=e;u&&n.imageManager.isValidId(u)?(i.#t=u,o&&(i.#e=o)):i.#i=l,i.#u=c;const[f,p]=i.pageDimensions;return i.width=(s[2]-s[0])/f,i.height=(s[3]-s[1])/p,i.annotationElementId=e.id||null,d&&(i.altTextData=d),i._initialData=r,i.#c=!!r,i}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:ze.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#u,structTreeParentId:this._structTreeParentId};if(e)return n.bitmapUrl=this.#g(!0),n.accessibilityData=this.serializeAltText(!0),n;const{decorative:r,altText:i}=this.serializeAltText(!1);if(!r&&i&&(n.accessibilityData={type:"Figure",alt:i}),this.annotationElementId){const o=this.#v(n);if(o.isSame)return null;o.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,t===null)return n;t.stamps||=new Map;const s=this.#u?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:s,serialized:n}),n.bitmap=this.#g(!1);else if(this.#u){const o=t.stamps.get(this.#t);s>o.area&&(o.area=s,o.serialized.bitmap.close(),o.serialized.bitmap=this.#g(!1))}return n}#v(e){const{pageIndex:t,accessibilityData:{altText:n}}=this._initialData,r=e.pageIndex===t,i=(e.accessibilityData?.alt||"")===n;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&i,isSameAltText:i}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}class Tn{#e;#t=!1;#n=null;#i=null;#s=null;#r=new Map;#l=!1;#o=!1;#u=!1;#c=null;#d=null;#h=null;#f=null;#a;static _initialized=!1;static#p=new Map([Gt,Fs,Os,Ft].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:r,accessibilityManager:i,annotationLayer:s,drawLayer:o,textLayer:l,viewport:u,l10n:c}){const d=[...Tn.#p.values()];if(!Tn._initialized){Tn._initialized=!0;for(const f of d)f.initialize(c,e)}e.registerEditorTypes(d),this.#a=e,this.pageIndex=t,this.div=n,this.#e=i,this.#n=s,this.viewport=u,this.#h=l,this.drawLayer=o,this._structTree=r,this.#a.addLayer(this)}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===ze.NONE}updateToolbar(e){this.#a.updateToolbar(e)}updateMode(e=this.#a.getMode()){switch(this.#b(),e){case ze.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ze.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ze.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const n of Tn.#p.values())t.toggle(`${n._type}Editing`,e===n._editorType);this.div.hidden=!1}hasTextLayer(e){return e===this.#h?.div}setEditingState(e){this.#a.setEditingState(e)}addCommands(e){this.#a.addCommands(e)}cleanUndoStack(e){this.#a.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#n?.div.classList.toggle("disabled",!e)}async enable(){this.#u=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const n of this.#r.values())n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#a.removeChangedExistingAnnotation(n),e.add(n.annotationElementId));if(!this.#n){this.#u=!1;return}const t=this.#n.getEditableAnnotations();for(const n of t){if(n.hide(),this.#a.isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const r=await this.deserialize(n);r&&(this.addOrRebuild(r),r.enableEditing())}this.#u=!1}disable(){this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of this.#r.values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);this.getEditableAnnotation(r.annotationElementId)?.show(),r.remove()}if(this.#n){const r=this.#n.getEditableAnnotations();for(const i of r){const{id:s}=i.data;if(this.#a.isDeletedAnnotationElement(s))continue;let o=t.get(s);if(o){o.resetAnnotationElement(i),o.show(!1),i.show();continue}o=e.get(s),o&&(this.#a.addChangedExistingAnnotation(o),o.renderAnnotationElement(i)&&o.show(!1)),i.show()}}this.#b(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const r of Tn.#p.values())n.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(e){return this.#n?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#a.getActive()!==e&&this.#a.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const e=this.#a.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#m.bind(this),{signal:e}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#m(e){this.#a.unselectAll();const{target:t}=e;if(t===this.#h.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#h.div.contains(t)){const{isMac:n}=rn.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#a.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),Ft.startHighlighting(this,this.#a.direction==="ltr",{target:this.#h.div,x:e.x,y:e.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),e.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const e=this.#a.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#i?.abort(),this.#i=null}attach(e){this.#r.set(e.id,e);const{annotationElementId:t}=e;t&&this.#a.isDeletedAnnotationElement(t)&&this.#a.removeDeletedAnnotationElement(e)}detach(e){this.#r.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#o&&e.annotationElementId&&this.#a.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#a.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#a.addDeletedAnnotationElement(e.annotationElementId),Le.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#a.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#u),this.#a.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#s&&(e._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getNextId(){return this.#a.getId()}get#g(){return Tn.#p.get(this.#a.getMode())}combinedSignal(e){return this.#a.combinedSignal(e)}#v(e){const t=this.#g;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#g?.canCreateNewEmptyEditor()}pasteEditor(e,t){this.#a.updateToolbar(e),this.#a.updateMode(e);const{offsetX:n,offsetY:r}=this.#w(),i=this.getNextId(),s=this.#v({parent:this,id:i,x:n,y:r,uiManager:this.#a,isCentered:!0,...t});s&&this.add(s)}async deserialize(e){return await Tn.#p.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#a)||null}createAndAddNewEditor(e,t,n={}){const r=this.getNextId(),i=this.#v({parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:this.#a,isCentered:t,...n});return i&&this.add(i),i}#w(){const{x:e,y:t,width:n,height:r}=this.div.getBoundingClientRect(),i=Math.max(0,e),s=Math.max(0,t),o=Math.min(window.innerWidth,e+n),l=Math.min(window.innerHeight,t+r),u=(i+o)/2-e,c=(s+l)/2-t,[d,f]=this.viewport.rotation%180===0?[u,c]:[c,u];return{offsetX:d,offsetY:f}}addNewEditor(){this.createAndAddNewEditor(this.#w(),!0)}setSelected(e){this.#a.setSelected(e)}toggleSelected(e){this.#a.toggleSelected(e)}unselect(e){this.#a.unselect(e)}pointerup(e){const{isMac:t}=rn.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&this.#l&&(this.#l=!1,!(this.#g?.isDrawer&&this.#g.supportMultipleDrawings))){if(!this.#t){this.#t=!0;return}if(this.#a.getMode()===ze.STAMP){this.#a.unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){if(this.#a.getMode()===ze.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}const{isMac:t}=rn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#l=!0,this.#g?.isDrawer){this.startDrawingSession(e);return}const n=this.#a.getActive();this.#t=!n||n.isEmpty()}startDrawingSession(e){if(this.div.focus(),this.#c){this.#g.startDrawing(this,this.#a,!1,e);return}this.#a.setCurrentDrawingSession(this),this.#c=new AbortController;const t=this.#a.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#d=null,this.commitOrRemove())},{signal:t}),this.#g.startDrawing(this,this.#a,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#d=t);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(e=!1){return this.#c?(this.#a.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#d=null,this.#g.endDrawing(e)):null}findNewParent(e,t,n){const r=this.#a.findParent(t,n);return r===null||r===this?!1:(r.changeParent(e),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#g.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const e of this.#r.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#r.clear(),this.#a.removeLayer(this)}#b(){for(const e of this.#r.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,Yn(this.div,e);for(const t of this.#a.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#a.commitOrRemove(),this.#b();const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,Yn(this.div,{rotation:n}),t!==n)for(const r of this.#r.values())r.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#a.viewParameters.realScale}}class tn{#e=null;#t=0;#n=new Map;#i=new Map;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#n.size>0)for(const t of this.#n.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return We(this,"_svgFactory",new Ls)}static#s(e,[t,n,r,i]){const{style:s}=e;s.top=`${100*n}%`,s.left=`${100*t}%`,s.width=`${100*r}%`,s.height=`${100*i}%`}#r(){const e=tn._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#l(e,t){const n=tn._svgFactory.createElement("clipPath");e.append(n);const r=`clip_${t}`;n.setAttribute("id",r),n.setAttribute("clipPathUnits","objectBoundingBox");const i=tn._svgFactory.createElement("use");return n.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),r}#o(e,t){for(const[n,r]of Object.entries(t))r===null?e.removeAttribute(n):e.setAttribute(n,r)}draw(e,t=!1,n=!1){const r=this.#t++,i=this.#r(),s=tn._svgFactory.createElement("defs");i.append(s);const o=tn._svgFactory.createElement("path");s.append(o);const l=`path_p${this.pageIndex}_${r}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#i.set(r,o);const u=n?this.#l(s,l):null,c=tn._svgFactory.createElement("use");return i.append(c),c.setAttribute("href",`#${l}`),this.updateProperties(i,e),this.#n.set(r,i),{id:r,clipPathId:`url(#${u})`}}drawOutline(e,t){const n=this.#t++,r=this.#r(),i=tn._svgFactory.createElement("defs");r.append(i);const s=tn._svgFactory.createElement("path");i.append(s);const o=`path_p${this.pageIndex}_${n}`;s.setAttribute("id",o),s.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const d=tn._svgFactory.createElement("mask");i.append(d),l=`mask_p${this.pageIndex}_${n}`,d.setAttribute("id",l),d.setAttribute("maskUnits","objectBoundingBox");const f=tn._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=tn._svgFactory.createElement("use");d.append(p),p.setAttribute("href",`#${o}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const u=tn._svgFactory.createElement("use");r.append(u),u.setAttribute("href",`#${o}`),l&&u.setAttribute("mask",`url(#${l})`);const c=u.cloneNode();return r.append(c),u.classList.add("mainOutline"),c.classList.add("secondaryOutline"),this.updateProperties(r,e),this.#n.set(n,r),n}finalizeDraw(e,t){this.#i.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:n,bbox:r,rootClass:i,path:s}=t,o=typeof e=="number"?this.#n.get(e):e;if(o){if(n&&this.#o(o,n),r&&tn.#s(o,r),i){const{classList:l}=o;for(const[u,c]of Object.entries(i))l.toggle(u,c)}if(s){const u=o.firstChild.firstChild;this.#o(u,s)}}}updateParent(e,t){if(t===this)return;const n=this.#n.get(e);n&&(t.#e.append(n),this.#n.delete(e),t.#n.set(e,n))}remove(e){this.#i.delete(e),this.#e!==null&&(this.#n.get(e).remove(),this.#n.delete(e))}destroy(){this.#e=null;for(const e of this.#n.values())e.remove();this.#n.clear(),this.#i.clear()}}globalThis.pdfjsTestingUtils={HighlightOutliner:_s};var Gu=Oe.AbortException,Uu=Oe.AnnotationEditorLayer,qu=Oe.AnnotationEditorParamsType,Xu=Oe.AnnotationEditorType,Ku=Oe.AnnotationEditorUIManager,Yu=Oe.AnnotationLayer,Zu=Oe.AnnotationMode,Ju=Oe.ColorPicker,Qu=Oe.DOMSVGFactory,eh=Oe.DrawLayer,th=Oe.FeatureTest,nh=Oe.GlobalWorkerOptions,ih=Oe.ImageKind,rh=Oe.InvalidPDFException,sh=Oe.MissingPDFException,ah=Oe.OPS,oh=Oe.OutputScale,lh=Oe.PDFDataRangeTransport,ch=Oe.PDFDateString,uh=Oe.PDFWorker,hh=Oe.PasswordResponses,dh=Oe.PermissionFlag,fh=Oe.PixelsPerInch,ph=Oe.RenderingCancelledException,gh=Oe.TextLayer,mh=Oe.TouchManager,vh=Oe.UnexpectedResponseException,bh=Oe.Util,_h=Oe.VerbosityLevel,wh=Oe.XfaLayer,yh=Oe.build,Eh=Oe.createValidAbsoluteUrl,Sh=Oe.fetchData,Ah=Oe.getDocument,Ch=Oe.getFilenameFromUrl,Ph=Oe.getPdfFilenameFromUrl,kh=Oe.getXfaPageViewport,xh=Oe.isDataScheme,Mh=Oe.isPdfFile,Th=Oe.noContextMenu,Rh=Oe.normalizeUnicode,Lh=Oe.setLayerDimensions,Ih=Oe.shadow,Dh=Oe.stopEvent,Fh=Oe.version;const Oh=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Gu,AnnotationEditorLayer:Uu,AnnotationEditorParamsType:qu,AnnotationEditorType:Xu,AnnotationEditorUIManager:Ku,AnnotationLayer:Yu,AnnotationMode:Zu,ColorPicker:Ju,DOMSVGFactory:Qu,DrawLayer:eh,FeatureTest:th,GlobalWorkerOptions:nh,ImageKind:ih,InvalidPDFException:rh,MissingPDFException:sh,OPS:ah,OutputScale:oh,PDFDataRangeTransport:lh,PDFDateString:ch,PDFWorker:uh,PasswordResponses:hh,PermissionFlag:dh,PixelsPerInch:fh,RenderingCancelledException:ph,TextLayer:gh,TouchManager:mh,UnexpectedResponseException:vh,Util:bh,VerbosityLevel:_h,XfaLayer:wh,build:yh,createValidAbsoluteUrl:Eh,fetchData:Sh,getDocument:Ah,getFilenameFromUrl:Ch,getPdfFilenameFromUrl:Ph,getXfaPageViewport:kh,isDataScheme:xh,isPdfFile:Mh,noContextMenu:Th,normalizeUnicode:Rh,setLayerDimensions:Lh,shadow:Ih,stopEvent:Dh,version:Fh},Symbol.toStringTag,{value:"Module"})),Nh=Nl(Oh);var Sa;function Bh(){return Sa||(Sa=1,(function(a){var e=Kt(),t=Nh;function n(m){var w=Object.create(null);return m&&Object.keys(m).forEach((function(P){if(P!=="default"){var R=Object.getOwnPropertyDescriptor(m,P);Object.defineProperty(w,P,R.get?R:{enumerable:!0,get:function(){return m[P]}})}})),w.default=m,Object.freeze(w)}var r,i=n(e),s=n(t);a.AnnotationType=void 0,(r=a.AnnotationType||(a.AnnotationType={}))[r.Text=1]="Text",r[r.Link=2]="Link",r[r.FreeText=3]="FreeText",r[r.Line=4]="Line",r[r.Square=5]="Square",r[r.Circle=6]="Circle",r[r.Polygon=7]="Polygon",r[r.Polyline=8]="Polyline",r[r.Highlight=9]="Highlight",r[r.Underline=10]="Underline",r[r.Squiggly=11]="Squiggly",r[r.StrikeOut=12]="StrikeOut",r[r.Stamp=13]="Stamp",r[r.Caret=14]="Caret",r[r.Ink=15]="Ink",r[r.Popup=16]="Popup",r[r.FileAttachment=17]="FileAttachment";var o=function(m,w){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,R){P.__proto__=R}||function(P,R){for(var F in R)Object.prototype.hasOwnProperty.call(R,F)&&(P[F]=R[F])},o(m,w)};function l(m,w){if(typeof w!="function"&&w!==null)throw new TypeError("Class extends value "+String(w)+" is not a constructor or null");function P(){this.constructor=m}o(m,w),m.prototype=w===null?Object.create(w):(P.prototype=w.prototype,new P)}var u,c=function(){return c=Object.assign||function(m){for(var w,P=1,R=arguments.length;P<R;P++)for(var F in w=arguments[P])Object.prototype.hasOwnProperty.call(w,F)&&(m[F]=w[F]);return m},c.apply(this,arguments)};a.TextDirection=void 0,(u=a.TextDirection||(a.TextDirection={})).RightToLeft="RTL",u.LeftToRight="LTR";var d,f=i.createContext({currentTheme:"light",direction:a.TextDirection.LeftToRight,setCurrentTheme:function(){}}),p=function(m){var w=[];return Object.keys(m).forEach((function(P){P&&m[P]&&w.push(P)})),w.join(" ")},g=typeof window<"u"?i.useLayoutEffect:i.useEffect,h=function(m){var w=i.useRef(null),P=m.once,R=m.threshold,F=m.onVisibilityChanged;return g((function(){var O=w.current;if(O){var G=new IntersectionObserver((function(V){V.forEach((function(I){var $=I.isIntersecting,W=I.intersectionRatio;F({isVisible:$,ratio:W}),$&&P&&(G.unobserve(O),G.disconnect())}))}),{threshold:R||0});return G.observe(O),function(){G.unobserve(O),G.disconnect()}}}),[]),w},v=function(m){var w=m.children,P=m.ignoreDirection,R=P!==void 0&&P,F=m.size,O=F===void 0?24:F,G=i.useContext(f).direction,V=!R&&G===a.TextDirection.RightToLeft,I="".concat(O||24,"px");return i.createElement("svg",{"aria-hidden":"true",className:p({"rpv-core__icon":!0,"rpv-core__icon--rtl":V}),focusable:"false",height:I,viewBox:"0 0 24 24",width:I},w)},b=function(){return i.createElement(v,{size:16},i.createElement("path",{d:"M23.5,0.499l-16.5,23l-6.5-6.5"}))},_=function(m){var w=m.children,P=m.testId,R=m.onClick,F=i.useContext(f).direction===a.TextDirection.RightToLeft,O=P?{"data-testid":P}:{};return i.createElement("button",c({className:p({"rpv-core__primary-button":!0,"rpv-core__primary-button--rtl":F}),type:"button",onClick:R},O),w)},C=function(m){var w=m.size,P=w===void 0?"4rem":w,R=m.testId,F=i.useState(!1),O=F[0],G=F[1],V=R?{"data-testid":R}:{},I=h({onVisibilityChanged:function($){G($.isVisible)}});return i.createElement("div",c({},V,{className:p({"rpv-core__spinner":!0,"rpv-core__spinner--animating":O}),ref:I,style:{height:P,width:P}}))},E=function(m){var w=m.ariaLabel,P=w===void 0?"":w,R=m.autoFocus,F=R!==void 0&&R,O=m.placeholder,G=O===void 0?"":O,V=m.testId,I=m.type,$=I===void 0?"text":I,W=m.value,Z=W===void 0?"":W,Y=m.onChange,K=m.onKeyDown,se=K===void 0?function(){}:K,ie=i.useContext(f).direction,ne=i.useRef(),Fe=ie===a.TextDirection.RightToLeft,me={ref:ne,"data-testid":"","aria-label":P,className:p({"rpv-core__textbox":!0,"rpv-core__textbox--rtl":Fe}),placeholder:G,value:Z,onChange:function(ve){return Y(ve.target.value)},onKeyDown:se};return V&&(me["data-testid"]=V),g((function(){if(F){var ve=ne.current;if(ve){var Se=window.scrollX,ue=window.scrollY;ve.focus(),window.scrollTo(Se,ue)}}}),[]),$==="text"?i.createElement("input",c({type:"text"},me)):i.createElement("input",c({type:"password"},me))};(function(m){m[m.ExitFullScreen=0]="ExitFullScreen",m[m.FullScreenChange=1]="FullScreenChange",m[m.FullScreenElement=2]="FullScreenElement",m[m.FullScreenEnabled=3]="FullScreenEnabled",m[m.RequestFullScreen=4]="RequestFullScreen"})(d||(d={}));var k,H={ExitFullScreen:"exitFullscreen",FullScreenChange:"fullscreenchange",FullScreenElement:"fullscreenElement",FullScreenEnabled:"fullscreenEnabled",RequestFullScreen:"requestFullscreen"},T={ExitFullScreen:"webkitExitFullscreen",FullScreenChange:"webkitfullscreenchange",FullScreenElement:"webkitFullscreenElement",FullScreenEnabled:"webkitFullscreenEnabled",RequestFullScreen:"webkitRequestFullscreen"},A={ExitFullScreen:"msExitFullscreen",FullScreenChange:"msFullscreenChange",FullScreenElement:"msFullscreenElement",FullScreenEnabled:"msFullscreenEnabled",RequestFullScreen:"msRequestFullscreen"},B=typeof window<"u",z=B&&(d.FullScreenEnabled in document&&H||T.FullScreenEnabled in document&&T||A.FullScreenEnabled in document&&A)||H,y=function(){return B&&z.FullScreenEnabled in document&&document[z.FullScreenEnabled]===!0},S=function(m){return B?m[z.ExitFullScreen]():Promise.resolve({})},L=function(){return B?document[z.FullScreenElement]:null},N=function(m,w){var P=i.useRef(),R=function(){P.current&&clearTimeout(P.current)};return i.useEffect((function(){return function(){return R()}}),[]),i.useCallback((function(){for(var F=[],O=0;O<arguments.length;O++)F[O]=arguments[O];R(),P.current=setTimeout((function(){m.apply(void 0,F)}),w)}),[m,w])},D=function(){var m=i.useRef(!1);return i.useEffect((function(){return m.current=!0,function(){m.current=!1}}),[]),m},M=function(m){var w=i.useRef(m);return i.useEffect((function(){w.current=m}),[m]),w.current};(function(m){m.NotRenderedYet="NotRenderedYet",m.Rendering="Rendering",m.Rendered="Rendered"})(k||(k={}));var x,j=-9999,U=function(m){var w=m.doc,P=w.numPages,R=w.loadingTask.docId,F=i.useMemo((function(){return Array(P).fill(null).map((function(V,I){return{pageIndex:I,renderStatus:k.NotRenderedYet,visibility:j}}))}),[R]),O=i.useRef({currentRenderingPage:-1,startRange:0,endRange:P-1,visibilities:F}),G=function(V,I){O.current.visibilities[V].visibility=I};return{getHighestPriorityPage:function(){var V=O.current.visibilities.slice(O.current.startRange,O.current.endRange+1).filter((function(Y){return Y.visibility>j}));if(!V.length)return-1;for(var I=V[0].pageIndex,$=V[V.length-1].pageIndex,W=V.length,Z=0;Z<W;Z++){if(V[Z].renderStatus===k.Rendering)return-1;if(V[Z].renderStatus===k.NotRenderedYet)return V[Z].pageIndex}return $+1<P&&O.current.visibilities[$+1].renderStatus!==k.Rendered?$+1:I-1>=0&&O.current.visibilities[I-1].renderStatus!==k.Rendered?I-1:-1},isInRange:function(V){return V>=O.current.startRange&&V<=O.current.endRange},markNotRendered:function(){for(var V=0;V<P;V++)O.current.visibilities[V].renderStatus=k.NotRenderedYet},markRendered:function(V){O.current.visibilities[V].renderStatus=k.Rendered},markRendering:function(V){O.current.currentRenderingPage!==-1&&O.current.currentRenderingPage!==V&&O.current.visibilities[O.current.currentRenderingPage].renderStatus===k.Rendering&&(O.current.visibilities[O.current.currentRenderingPage].renderStatus=k.NotRenderedYet),O.current.visibilities[V].renderStatus=k.Rendering,O.current.currentRenderingPage=V},setOutOfRange:function(V){G(V,j)},setRange:function(V,I){O.current.startRange=V,O.current.endRange=I;for(var $=0;$<P;$++)($<V||$>I)&&(O.current.visibilities[$].visibility=j,O.current.visibilities[$].renderStatus=k.NotRenderedYet)},setVisibility:G}},J={core:{askingPassword:{requirePasswordToOpen:"This document requires a password to open",submit:"Submit"},wrongPassword:{tryAgain:"The password is wrong. Please try again"},pageLabel:"Page {{pageIndex}}"}},Q=i.createContext({l10n:J,setL10n:function(){}}),X=0,q=function(){return X++},re=function(m,w,P){var R=function(F){var O=w.current;if(O){var G=F.target;if(G instanceof Element&&G.shadowRoot){var V=F.composedPath();V.length>0&&!O.contains(V[0])&&P()}else O.contains(G)||P()}};i.useEffect((function(){if(m){var F={capture:!0};return document.addEventListener("click",R,F),function(){document.removeEventListener("click",R,F)}}}),[])},oe=function(m){var w=function(P){P.key==="Escape"&&m()};i.useEffect((function(){return document.addEventListener("keyup",w),function(){document.removeEventListener("keyup",w)}}),[])},Ae=function(m){var w=m.ariaControlsSuffix,P=m.children,R=m.closeOnClickOutside,F=m.closeOnEscape,O=m.onToggle,G=i.useRef(),V=i.useContext(f).direction===a.TextDirection.RightToLeft;return i.useEffect((function(){var I=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",function(){document.body.style.overflow=I}}),[]),oe((function(){G.current&&F&&O()})),re(R,G,O),g((function(){var I=G.current;if(I){var $=.75*document.body.clientHeight;I.getBoundingClientRect().height>=$&&(I.style.overflow="auto",I.style.maxHeight="".concat($,"px"))}}),[]),i.createElement("div",{"aria-modal":"true",className:p({"rpv-core__modal-body":!0,"rpv-core__modal-body--rtl":V}),id:"rpv-core__modal-body-".concat(w),ref:G,role:"dialog",tabIndex:-1},P)},te=function(m){var w=m.children;return i.createElement("div",{className:"rpv-core__modal-overlay"},w)};a.ToggleStatus=void 0,(x=a.ToggleStatus||(a.ToggleStatus={})).Close="Close",x.Open="Open",x.Toggle="Toggle";var Pe,Be=function(m){var w=i.useState(m),P=w[0],R=w[1];return{opened:P,toggle:function(F){switch(F){case a.ToggleStatus.Close:R(!1);break;case a.ToggleStatus.Open:R(!0);break;case a.ToggleStatus.Toggle:default:R((function(O){return!O}))}}}},it=function(m){var w=m.content,P=m.isOpened,R=P!==void 0&&P,F=m.target,O=Be(R),G=O.opened,V=O.toggle;return i.createElement(i.Fragment,null,F&&F(V,G),G&&w(V))};a.Position=void 0,(Pe=a.Position||(a.Position={})).TopLeft="TOP_LEFT",Pe.TopCenter="TOP_CENTER",Pe.TopRight="TOP_RIGHT",Pe.RightTop="RIGHT_TOP",Pe.RightCenter="RIGHT_CENTER",Pe.RightBottom="RIGHT_BOTTOM",Pe.BottomLeft="BOTTOM_LEFT",Pe.BottomCenter="BOTTOM_CENTER",Pe.BottomRight="BOTTOM_RIGHT",Pe.LeftTop="LEFT_TOP",Pe.LeftCenter="LEFT_CENTER",Pe.LeftBottom="LEFT_BOTTOM";var ft,Je,pt,mt,Ut,Tt,bt,le,ce=function(m,w,P,R,F){g((function(){var O=w.current,G=m.current,V=P.current;if(G&&O&&V){var I=V.getBoundingClientRect(),$=(function(Y,K,se,ie){var ne=K.getBoundingClientRect(),Fe=Y.getBoundingClientRect(),me=Fe.height,ve=Fe.width,Se=0,ue=0;switch(se){case a.Position.TopLeft:Se=ne.top-me,ue=ne.left;break;case a.Position.TopCenter:Se=ne.top-me,ue=ne.left+ne.width/2-ve/2;break;case a.Position.TopRight:Se=ne.top-me,ue=ne.left+ne.width-ve;break;case a.Position.RightTop:Se=ne.top,ue=ne.left+ne.width;break;case a.Position.RightCenter:Se=ne.top+ne.height/2-me/2,ue=ne.left+ne.width;break;case a.Position.RightBottom:Se=ne.top+ne.height-me,ue=ne.left+ne.width;break;case a.Position.BottomLeft:Se=ne.top+ne.height,ue=ne.left;break;case a.Position.BottomCenter:Se=ne.top+ne.height,ue=ne.left+ne.width/2-ve/2;break;case a.Position.BottomRight:Se=ne.top+ne.height,ue=ne.left+ne.width-ve;break;case a.Position.LeftTop:Se=ne.top,ue=ne.left-ve;break;case a.Position.LeftCenter:Se=ne.top+ne.height/2-me/2,ue=ne.left-ve;break;case a.Position.LeftBottom:Se=ne.top+ne.height-me,ue=ne.left-ve}return{left:ue+(ie.left||0),top:Se+(ie.top||0)}})(G,O,R,F),W=$.top,Z=$.left;G.style.top="".concat(W-I.top,"px"),G.style.left="".concat(Z-I.left,"px")}}),[])},Ke=function(m){var w,P=m.customClassName,R=m.position;return i.createElement("div",{className:p((w={"rpv-core__arrow":!0,"rpv-core__arrow--tl":R===a.Position.TopLeft,"rpv-core__arrow--tc":R===a.Position.TopCenter,"rpv-core__arrow--tr":R===a.Position.TopRight,"rpv-core__arrow--rt":R===a.Position.RightTop,"rpv-core__arrow--rc":R===a.Position.RightCenter,"rpv-core__arrow--rb":R===a.Position.RightBottom,"rpv-core__arrow--bl":R===a.Position.BottomLeft,"rpv-core__arrow--bc":R===a.Position.BottomCenter,"rpv-core__arrow--br":R===a.Position.BottomRight,"rpv-core__arrow--lt":R===a.Position.LeftTop,"rpv-core__arrow--lc":R===a.Position.LeftCenter,"rpv-core__arrow--lb":R===a.Position.LeftBottom},w["".concat(P)]=P!=="",w))})},Ce=function(m){var w=m.ariaControlsSuffix,P=m.children,R=m.closeOnClickOutside,F=m.offset,O=m.position,G=m.targetRef,V=m.onClose,I=i.useRef(),$=i.useRef(),W=i.useRef(),Z=i.useContext(f).direction===a.TextDirection.RightToLeft;re(R,I,V),ce(I,G,W,O,F),g((function(){var K=$.current;if(K){var se=.75*document.body.clientHeight;K.getBoundingClientRect().height>=se&&(K.style.overflow="auto",K.style.maxHeight="".concat(se,"px"))}}),[]);var Y="rpv-core__popover-body-inner-".concat(w);return i.createElement(i.Fragment,null,i.createElement("div",{ref:W,style:{left:0,position:"absolute",top:0}}),i.createElement("div",{"aria-describedby":Y,className:p({"rpv-core__popover-body":!0,"rpv-core__popover-body--rtl":Z}),id:"rpv-core__popover-body-".concat(w),ref:I,role:"dialog",tabIndex:-1},i.createElement(Ke,{customClassName:"rpv-core__popover-body-arrow",position:O}),i.createElement("div",{id:Y,ref:$},P)))},_e=function(m){var w=m.closeOnEscape,P=m.onClose,R=i.useRef();return oe((function(){R.current&&w&&P()})),i.createElement("div",{className:"rpv-core__popover-overlay",ref:R})},Qe=function(m){var w=m.ariaControlsSuffix,P=m.children,R=m.contentRef,F=m.offset,O=m.position,G=m.targetRef,V=i.useRef(),I=i.useContext(f).direction===a.TextDirection.RightToLeft;return ce(R,G,V,O,F),i.createElement(i.Fragment,null,i.createElement("div",{ref:V,style:{left:0,position:"absolute",top:0}}),i.createElement("div",{className:p({"rpv-core__tooltip-body":!0,"rpv-core__tooltip-body--rtl":I}),id:"rpv-core__tooltip-body-".concat(w),ref:R,role:"tooltip"},i.createElement(Ke,{customClassName:"rpv-core__tooltip-body-arrow",position:O}),i.createElement("div",{className:"rpv-core__tooltip-body-content"},P)))};a.FullScreenMode=void 0,(ft=a.FullScreenMode||(a.FullScreenMode={})).Normal="Normal",ft.Entering="Entering",ft.Entered="Entered",ft.EnteredCompletely="EnteredCompletely",ft.Exitting="Exitting",ft.Exited="Exited",a.LayerRenderStatus=void 0,(Je=a.LayerRenderStatus||(a.LayerRenderStatus={}))[Je.PreRender=0]="PreRender",Je[Je.DidRender=1]="DidRender",a.PageMode=void 0,(pt=a.PageMode||(a.PageMode={})).Attachments="UseAttachments",pt.Bookmarks="UseOutlines",pt.ContentGroup="UseOC",pt.Default="UserNone",pt.FullScreen="FullScreen",pt.Thumbnails="UseThumbs",a.PasswordStatus=void 0,(mt=a.PasswordStatus||(a.PasswordStatus={})).RequiredPassword="RequiredPassword",mt.WrongPassword="WrongPassword",a.RotateDirection=void 0,(Ut=a.RotateDirection||(a.RotateDirection={})).Backward="Backward",Ut.Forward="Forward",a.ScrollMode=void 0,(Tt=a.ScrollMode||(a.ScrollMode={})).Page="Page",Tt.Horizontal="Horizontal",Tt.Vertical="Vertical",Tt.Wrapped="Wrapped",a.SpecialZoomLevel=void 0,(bt=a.SpecialZoomLevel||(a.SpecialZoomLevel={})).ActualSize="ActualSize",bt.PageFit="PageFit",bt.PageWidth="PageWidth",a.ViewMode=void 0,(le=a.ViewMode||(a.ViewMode={})).DualPage="DualPage",le.DualPageWithCover="DualPageWithCover",le.SinglePage="SinglePage";var at,_t=function(m,w){return m.reduce((function(P,R,F){return F%w?P[P.length-1].push(R):P.push([R]),P}),[])},Pt=function(m,w){switch(w[1].name){case"XYZ":return{bottomOffset:function(P,R){return w[3]===null?R:w[3]},leftOffset:function(P,R){return w[2]===null?0:w[2]},pageIndex:m,scaleTo:w[4]};case"Fit":case"FitB":return{bottomOffset:0,leftOffset:0,pageIndex:m,scaleTo:a.SpecialZoomLevel.PageFit};case"FitH":case"FitBH":return{bottomOffset:w[2],leftOffset:0,pageIndex:m,scaleTo:a.SpecialZoomLevel.PageWidth};default:return{bottomOffset:0,leftOffset:0,pageIndex:m,scaleTo:1}}},gt=new Map,Rt=new Map,Nt=function(m,w){return"".concat(m.loadingTask.docId,"___").concat(w.num,"R").concat(w.gen===0?"":w.gen)},Bt=function(m,w,P){gt.set(Nt(m,w),P)},rt=function(m,w){if(!m)return Promise.reject("The document is not loaded yet");var P="".concat(m.loadingTask.docId,"___").concat(w),R=Rt.get(P);return R?Promise.resolve(R):new Promise((function(F,O){m.getPage(w+1).then((function(G){Rt.set(P,G),G.ref&&Bt(m,G.ref,w),F(G)}))}))},fn=function(m,w){return new Promise((function(P){new Promise((function(R){typeof w=="string"?m.getDestination(w).then((function(F){R(F)})):R(w)})).then((function(R){if(typeof R[0]=="object"&&R[0]!==null){var F=R[0],O=(function(V,I){var $=Nt(V,I);return gt.has($)?gt.get($):null})(m,F);O===null?m.getPageIndex(F).then((function(V){Bt(m,F,V),fn(m,w).then((function(I){return P(I)}))})):P(Pt(O,R))}else{var G=Pt(R[0],R);P(G)}}))}))};(function(m){m[m.Solid=1]="Solid",m[m.Dashed=2]="Dashed",m[m.Beveled=3]="Beveled",m[m.Inset=4]="Inset",m[m.Underline=5]="Underline"})(at||(at={}));var vt,yn=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"),pn=function(m,w,P,R){var F=parseInt(m,10);return F>=w&&F<=P?F:R},Lt=function(m){return m.contentsObj?m.contentsObj.str:m.contents||""},It=function(m){return m.titleObj?m.titleObj.str:m.title||""},Qn=function(m){var w=m.annotation,P=i.useContext(f).direction,R=It(w),F=Lt(w),O=P===a.TextDirection.RightToLeft,G=i.useRef(),V="";if(w.modificationDate){var I=(function($){var W=yn.exec($);if(!W)return null;var Z=parseInt(W[1],10),Y=pn(W[2],1,12,1)-1,K=pn(W[3],1,31,1),se=pn(W[4],0,23,0),ie=pn(W[5],0,59,0),ne=pn(W[6],0,59,0),Fe=W[7]||"Z",me=pn(W[8],0,23,0),ve=pn(W[9],0,59,0);switch(Fe){case"-":se+=me,ie+=ve;break;case"+":se-=me,ie-=ve}return new Date(Date.UTC(Z,Y,K,se,ie,ne))})(w.modificationDate);V=I?"".concat(I.toLocaleDateString(),", ").concat(I.toLocaleTimeString()):""}return i.useLayoutEffect((function(){if(G.current){var $=document.querySelector('[data-annotation-id="'.concat(w.id,'"]'));if($){var W=$;return W.style.zIndex+=1,function(){W.style.zIndex="".concat(parseInt(W.style.zIndex,10)-1)}}}}),[]),i.createElement("div",{ref:G,className:p({"rpv-core__annotation-popup-wrapper":!0,"rpv-core__annotation-popup-wrapper--rtl":O}),style:{top:w.annotationType===a.AnnotationType.Popup?"":"100%"}},R&&i.createElement(i.Fragment,null,i.createElement("div",{className:p({"rpv-core__annotation-popup-title":!0,"rpv-core__annotation-popup-title--ltr":!O,"rpv-core__annotation-popup-title--rtl":O})},R),i.createElement("div",{className:"rpv-core__annotation-popup-date"},V)),F&&i.createElement("div",{className:"rpv-core__annotation-popup-content"},F.split(`
`).map((function($,W){return i.createElement(i.Fragment,{key:W},$,i.createElement("br",null))}))))};(function(m){m.Click="Click",m.Hover="Hover"})(vt||(vt={}));var Ge,wt=function(m){var w,P=m.annotation,R=m.children,F=m.ignoreBorder,O=m.hasPopup,G=m.isRenderable,V=m.page,I=m.viewport,$=P.rect,W=(function(){var we=Be(!1),Ue=we.opened,$e=we.toggle,qe=i.useState(vt.Hover),Ye=qe[0],et=qe[1];return{opened:Ue,closeOnHover:function(){Ye===vt.Hover&&$e(a.ToggleStatus.Close)},openOnHover:function(){Ye===vt.Hover&&$e(a.ToggleStatus.Open)},toggleOnClick:function(){switch(Ye){case vt.Click:Ue&&et(vt.Hover),$e(a.ToggleStatus.Toggle);break;case vt.Hover:et(vt.Click),$e(a.ToggleStatus.Open)}}}})(),Z=W.closeOnHover,Y=W.opened,K=W.openOnHover,se=W.toggleOnClick,ie=(w=[$[0],V.view[3]+V.view[1]-$[1],$[2],V.view[3]+V.view[1]-$[3]],[Math.min(w[0],w[2]),Math.min(w[1],w[3]),Math.max(w[0],w[2]),Math.max(w[1],w[3])]),ne=$[2]-$[0],Fe=$[3]-$[1],me={borderColor:"",borderRadius:"",borderStyle:"",borderWidth:""};if(!F&&P.borderStyle.width>0){switch(P.borderStyle.style){case at.Dashed:me.borderStyle="dashed";break;case at.Solid:me.borderStyle="solid";break;case at.Underline:me=Object.assign({borderBottomStyle:"solid"},me);case at.Beveled:case at.Inset:}var ve=P.borderStyle.width;me.borderWidth="".concat(ve,"px"),P.borderStyle.style!==at.Underline&&(ne-=2*ve,Fe-=2*ve);var Se=P.borderStyle,ue=Se.horizontalCornerRadius,ke=Se.verticalCornerRadius;(ue>0||ke>0)&&(me.borderRadius="".concat(ue,"px / ").concat(ke,"px")),P.color?me.borderColor="rgb(".concat(0|P.color[0],", ").concat(0|P.color[1],", ").concat(0|P.color[2],")"):me.borderWidth="0"}return i.createElement(i.Fragment,null,G&&R({popup:{opened:Y,closeOnHover:Z,openOnHover:K,toggleOnClick:se},slot:{attrs:{style:Object.assign({height:"".concat(Fe,"px"),left:"".concat(ie[0],"px"),top:"".concat(ie[1],"px"),transform:"matrix(".concat(I.transform.join(","),")"),transformOrigin:"-".concat(ie[0],"px -").concat(ie[1],"px"),width:"".concat(ne,"px")},me)},children:i.createElement(i.Fragment,null,O&&Y&&i.createElement(Qn,{annotation:P}))}}))},Vn=function(m){var w=m.annotation,P=m.page,R=m.viewport,F=w.hasPopup===!1,O=It(w),G=Lt(w),V=!!(w.hasPopup||O||G);return i.createElement(wt,{annotation:w,hasPopup:F,ignoreBorder:!0,isRenderable:V,page:P,viewport:R},(function(I){return i.createElement("div",c({},I.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--caret","data-annotation-id":w.id,onClick:I.popup.toggleOnClick,onMouseEnter:I.popup.openOnHover,onMouseLeave:I.popup.closeOnHover}),I.slot.children)}))},Pn=function(m){var w=m.annotation,P=m.page,R=m.viewport,F=w.hasPopup===!1,O=It(w),G=Lt(w),V=!!(w.hasPopup||O||G),I=w.rect,$=I[2]-I[0],W=I[3]-I[1],Z=w.borderStyle.width;return i.createElement(wt,{annotation:w,hasPopup:F,ignoreBorder:!0,isRenderable:V,page:P,viewport:R},(function(Y){return i.createElement("div",c({},Y.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--circle","data-annotation-id":w.id,onClick:Y.popup.toggleOnClick,onMouseEnter:Y.popup.openOnHover,onMouseLeave:Y.popup.closeOnHover}),i.createElement("svg",{height:"".concat(W,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat($," ").concat(W),width:"".concat($,"px")},i.createElement("circle",{cy:W/2,fill:"none",rx:$/2-Z/2,ry:W/2-Z/2,stroke:"transparent",strokeWidth:Z||1})),Y.slot.children)}))},ei=function(m){var w=m.annotation,P=m.page,R=m.viewport,F=It(w),O=Lt(w),G=!(w.hasPopup!==!1||!F&&!O),V=function(){var I,$,W,Z,Y=w.file;Y&&(I=Y.filename,$=Y.content,W=typeof $=="string"?"":URL.createObjectURL(new Blob([$],{type:""})),(Z=document.createElement("a")).style.display="none",Z.href=W||I,Z.setAttribute("download",(function(K){var se=K.split("/").pop();return se?se.split("#")[0].split("?")[0]:K})(I)),document.body.appendChild(Z),Z.click(),document.body.removeChild(Z),W&&URL.revokeObjectURL(W))};return i.createElement(wt,{annotation:w,hasPopup:G,ignoreBorder:!0,isRenderable:!0,page:P,viewport:R},(function(I){return i.createElement("div",c({},I.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--file-attachment","data-annotation-id":w.id,onClick:I.popup.toggleOnClick,onDoubleClick:V,onMouseEnter:I.popup.openOnHover,onMouseLeave:I.popup.closeOnHover}),I.slot.children)}))},vi=function(m){var w=m.annotation,P=m.page,R=m.viewport,F=w.hasPopup===!1,O=It(w),G=Lt(w),V=!!(w.hasPopup||O||G);return i.createElement(wt,{annotation:w,hasPopup:F,ignoreBorder:!0,isRenderable:V,page:P,viewport:R},(function(I){return i.createElement("div",c({},I.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--free-text","data-annotation-id":w.id,onClick:I.popup.toggleOnClick,onMouseEnter:I.popup.openOnHover,onMouseLeave:I.popup.closeOnHover}),I.slot.children)}))},ti=function(m){var w=m.annotation,P=m.page,R=m.viewport,F=It(w),O=Lt(w),G=!(!F&&!O),V=!w.parentType||["Circle","Ink","Line","Polygon","PolyLine","Square"].indexOf(w.parentType)!==-1;return g((function(){if(w.parentId){var I=document.querySelector('[data-annotation-id="'.concat(w.parentId,'"]')),$=document.querySelector('[data-annotation-id="'.concat(w.id,'"]'));if(I&&$){var W=parseFloat(I.style.left),Z=parseFloat(I.style.top)+parseFloat(I.style.height);$.style.left="".concat(W,"px"),$.style.top="".concat(Z,"px"),$.style.transformOrigin="-".concat(W,"px -").concat(Z,"px")}}}),[]),i.createElement(wt,{annotation:w,hasPopup:V,ignoreBorder:!1,isRenderable:G,page:P,viewport:R},(function(I){return i.createElement("div",c({},I.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--popup","data-annotation-id":w.id}),i.createElement(Qn,{annotation:w}))}))},ni=function(m){var w=m.annotation,P=m.childAnnotation,R=m.page,F=m.viewport,O=w.hasPopup===!1,G=It(w),V=Lt(w),I=!!(w.hasPopup||G||V);if(w.quadPoints&&w.quadPoints.length>0){var $=w.quadPoints.map((function(W){return Object.assign({},w,{rect:[W[2].x,W[2].y,W[1].x,W[1].y],quadPoints:[]})}));return i.createElement(i.Fragment,null,$.map((function(W,Z){return i.createElement(ni,{key:Z,annotation:W,childAnnotation:P,page:R,viewport:F})})))}return i.createElement(wt,{annotation:w,hasPopup:O,ignoreBorder:!0,isRenderable:I,page:R,viewport:F},(function(W){return i.createElement(i.Fragment,null,i.createElement("div",c({},W.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--highlight","data-annotation-id":w.id,onClick:W.popup.toggleOnClick,onMouseEnter:W.popup.openOnHover,onMouseLeave:W.popup.closeOnHover}),W.slot.children),P&&P.annotationType===a.AnnotationType.Popup&&W.popup.opened&&i.createElement(ti,{annotation:P,page:R,viewport:F}))}))},ii=function(m){var w=m.annotation,P=m.page,R=m.viewport,F=w.hasPopup===!1,O=It(w),G=Lt(w),V=!!(w.hasPopup||O||G),I=w.rect,$=I[2]-I[0],W=I[3]-I[1],Z=w.borderStyle.width;return i.createElement(wt,{annotation:w,hasPopup:F,ignoreBorder:!0,isRenderable:V,page:P,viewport:R},(function(Y){return i.createElement("div",c({},Y.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--ink","data-annotation-id":w.id,onClick:Y.popup.toggleOnClick,onMouseEnter:Y.popup.openOnHover,onMouseLeave:Y.popup.closeOnHover}),w.inkLists&&w.inkLists.length&&i.createElement("svg",{height:"".concat(W,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat($," ").concat(W),width:"".concat($,"px")},w.inkLists.map((function(K,se){return i.createElement("polyline",{key:se,fill:"none",stroke:"transparent",strokeWidth:Z||1,points:K.map((function(ie){return"".concat(ie.x-I[0],",").concat(I[3]-ie.y)})).join(" ")})}))),Y.slot.children)}))},ri=function(m){var w=m.annotation,P=m.page,R=m.viewport,F=w.hasPopup===!1,O=It(w),G=Lt(w),V=!!(w.hasPopup||O||G),I=w.rect,$=I[2]-I[0],W=I[3]-I[1],Z=w.borderStyle.width;return i.createElement(wt,{annotation:w,hasPopup:F,ignoreBorder:!0,isRenderable:V,page:P,viewport:R},(function(Y){return i.createElement("div",c({},Y.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--line","data-annotation-id":w.id,onClick:Y.popup.toggleOnClick,onMouseEnter:Y.popup.openOnHover,onMouseLeave:Y.popup.closeOnHover}),i.createElement("svg",{height:"".concat(W,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat($," ").concat(W),width:"".concat($,"px")},i.createElement("line",{stroke:"transparent",strokeWidth:Z||1,x1:I[2]-w.lineCoordinates[0],x2:I[2]-w.lineCoordinates[2],y1:I[3]-w.lineCoordinates[1],y2:I[3]-w.lineCoordinates[3]})),Y.slot.children)}))},bi=/^([^\w]*)(javascript|data|vbscript)/im,_i=/&#(\w+)(^\w|;)?/g,wr=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,yr=/^([^:]+):/gm,Er=function(m,w){var P,R=(P=m||"",P.replace(_i,(function(V,I){return String.fromCharCode(I)}))).replace(wr,"").trim();if(!R)return w;var F=R[0];if(F==="."||F==="/")return R;var O=R.match(yr);if(!O)return R;var G=O[0];return bi.test(G)?w:R},Sr=function(m){var w,P=m.annotation,R=m.annotationContainerRef,F=m.doc,O=m.outlines,G=m.page,V=m.pageIndex,I=m.scale,$=m.viewport,W=m.onExecuteNamedAction,Z=m.onJumpFromLinkAnnotation,Y=m.onJumpToDest,K=i.useRef(),se=O&&O.length&&P.dest&&typeof P.dest=="string"?(w=O.find((function(me){return me.dest===P.dest})))===null||w===void 0?void 0:w.title:"",ie=!!(P.url||P.dest||P.action||P.unsafeUrl),ne={};if(P.url||P.unsafeUrl){var Fe=Er(P.url||P.unsafeUrl,"");Fe?ne={"data-target":"external",href:Fe,rel:"noopener noreferrer nofollow",target:P.newWindow?"_blank":"",title:Fe}:ie=!1}else ne={href:"","data-annotation-link":P.id,onClick:function(me){me.preventDefault(),P.action?W(P.action):fn(F,P.dest).then((function(ve){var Se=K.current,ue=R.current;if(Se&&ue){var ke=Se.getBoundingClientRect();ue.style.setProperty("height","100%"),ue.style.setProperty("width","100%");var we=ue.getBoundingClientRect();ue.style.removeProperty("height"),ue.style.removeProperty("width");var Ue=(ke.left-we.left)/I,$e=(we.bottom-ke.bottom+ke.height)/I;Z({bottomOffset:$e,label:se,leftOffset:Ue,pageIndex:V})}Y(ve)}))}};return se&&(ne=Object.assign({},ne,{title:se,"aria-label":se})),i.createElement(wt,{annotation:P,hasPopup:!1,ignoreBorder:!1,isRenderable:ie,page:G,viewport:$},(function(me){return i.createElement("div",c({},me.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--link","data-annotation-id":P.id,"data-testid":"core__annotation--link-".concat(P.id)}),i.createElement("a",c({ref:K},ne)))}))},Fo=function(m){var w=m.annotation,P=m.page,R=m.viewport,F=w.hasPopup===!1,O=It(w),G=Lt(w),V=!!(w.hasPopup||O||G),I=w.rect,$=I[2]-I[0],W=I[3]-I[1],Z=w.borderStyle.width;return i.createElement(wt,{annotation:w,hasPopup:F,ignoreBorder:!0,isRenderable:V,page:P,viewport:R},(function(Y){return i.createElement("div",c({},Y.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--polygon","data-annotation-id":w.id,onClick:Y.popup.toggleOnClick,onMouseEnter:Y.popup.openOnHover,onMouseLeave:Y.popup.closeOnHover}),w.vertices&&w.vertices.length&&i.createElement("svg",{height:"".concat(W,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat($," ").concat(W),width:"".concat($,"px")},i.createElement("polygon",{fill:"none",stroke:"transparent",strokeWidth:Z||1,points:w.vertices.map((function(K){return"".concat(K.x-I[0],",").concat(I[3]-K.y)})).join(" ")})),Y.slot.children)}))},Oo=function(m){var w=m.annotation,P=m.page,R=m.viewport,F=w.hasPopup===!1,O=It(w),G=Lt(w),V=!!(w.hasPopup||O||G),I=w.rect,$=I[2]-I[0],W=I[3]-I[1],Z=w.borderStyle.width;return i.createElement(wt,{annotation:w,hasPopup:F,ignoreBorder:!0,isRenderable:V,page:P,viewport:R},(function(Y){return i.createElement("div",c({},Y.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--polyline","data-annotation-id":w.id,onClick:Y.popup.toggleOnClick,onMouseEnter:Y.popup.openOnHover,onMouseLeave:Y.popup.closeOnHover}),w.vertices&&w.vertices.length&&i.createElement("svg",{height:"".concat(W,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat($," ").concat(W),width:"".concat($,"px")},i.createElement("polyline",{fill:"none",stroke:"transparent",strokeWidth:Z||1,points:w.vertices.map((function(K){return"".concat(K.x-I[0],",").concat(I[3]-K.y)})).join(" ")})),Y.slot.children)}))},No=function(m){var w=m.annotation,P=m.page,R=m.viewport,F=w.hasPopup===!1,O=It(w),G=Lt(w),V=!!(w.hasPopup||O||G),I=w.rect,$=I[2]-I[0],W=I[3]-I[1],Z=w.borderStyle.width;return i.createElement(wt,{annotation:w,hasPopup:F,ignoreBorder:!0,isRenderable:V,page:P,viewport:R},(function(Y){return i.createElement("div",c({},Y.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--square","data-annotation-id":w.id,onClick:Y.popup.toggleOnClick,onMouseEnter:Y.popup.openOnHover,onMouseLeave:Y.popup.closeOnHover}),i.createElement("svg",{height:"".concat(W,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat($," ").concat(W),width:"".concat($,"px")},i.createElement("rect",{height:W-Z,fill:"none",stroke:"transparent",strokeWidth:Z||1,x:Z/2,y:Z/2,width:$-Z})),Y.slot.children)}))},Bo=function(m){var w=m.annotation,P=m.page,R=m.viewport,F=w.hasPopup===!1,O=It(w),G=Lt(w),V=!!(w.hasPopup||O||G);return i.createElement(wt,{annotation:w,hasPopup:F,ignoreBorder:!0,isRenderable:V,page:P,viewport:R},(function(I){return i.createElement("div",c({},I.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--squiggly","data-annotation-id":w.id,onClick:I.popup.toggleOnClick,onMouseEnter:I.popup.openOnHover,onMouseLeave:I.popup.closeOnHover}),I.slot.children)}))},zo=function(m){var w=m.annotation,P=m.page,R=m.viewport,F=w.hasPopup===!1,O=It(w),G=Lt(w),V=!!(w.hasPopup||O||G);return i.createElement(wt,{annotation:w,hasPopup:F,ignoreBorder:!0,isRenderable:V,page:P,viewport:R},(function(I){return i.createElement("div",c({},I.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--stamp","data-annotation-id":w.id,onClick:I.popup.toggleOnClick,onMouseEnter:I.popup.openOnHover,onMouseLeave:I.popup.closeOnHover}),I.slot.children)}))},Ho=function(m){var w=m.annotation,P=m.page,R=m.viewport,F=w.hasPopup===!1,O=It(w),G=Lt(w),V=!!(w.hasPopup||O||G);return i.createElement(wt,{annotation:w,hasPopup:F,ignoreBorder:!0,isRenderable:V,page:P,viewport:R},(function(I){return i.createElement("div",c({},I.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--strike-out","data-annotation-id":w.id,onClick:I.popup.toggleOnClick,onMouseEnter:I.popup.openOnHover,onMouseLeave:I.popup.closeOnHover}),I.slot.children)}))},jo=function(){return i.createElement(v,{size:16},i.createElement("path",{d:"M.5,16.5a1,1,0,0,0,1,1h2v4l4-4h15a1,1,0,0,0,1-1V3.5a1,1,0,0,0-1-1H1.5a1,1,0,0,0-1,1Z"}),i.createElement("path",{d:"M7.25,9.75A.25.25,0,1,1,7,10a.25.25,0,0,1,.25-.25"}),i.createElement("path",{d:"M12,9.75a.25.25,0,1,1-.25.25A.25.25,0,0,1,12,9.75"}),i.createElement("path",{d:"M16.75,9.75a.25.25,0,1,1-.25.25.25.25,0,0,1,.25-.25"}))},Vo=function(){return i.createElement(v,{size:16},i.createElement("path",{d:"M0.500 12.001 A11.500 11.500 0 1 0 23.500 12.001 A11.500 11.500 0 1 0 0.500 12.001 Z"}),i.createElement("path",{d:"M6.000 12.001 A6.000 6.000 0 1 0 18.000 12.001 A6.000 6.000 0 1 0 6.000 12.001 Z"}),i.createElement("path",{d:"M21.423 5.406L17.415 9.414"}),i.createElement("path",{d:"M14.587 6.585L18.607 2.565"}),i.createElement("path",{d:"M5.405 21.424L9.413 17.416"}),i.createElement("path",{d:"M6.585 14.588L2.577 18.596"}),i.createElement("path",{d:"M18.602 21.419L14.595 17.412"}),i.createElement("path",{d:"M17.419 14.58L21.428 18.589"}),i.createElement("path",{d:"M2.582 5.399L6.588 9.406"}),i.createElement("path",{d:"M9.421 6.581L5.412 2.572"}))},Wo=function(){return i.createElement(v,{size:16},i.createElement("path",{d:"M4.000 18.500 A1.500 1.500 0 1 0 7.000 18.500 A1.500 1.500 0 1 0 4.000 18.500 Z"}),i.createElement("path",{d:"M20.5.5l-9.782,9.783a7,7,0,1,0,3,3L17,10h1.5V8.5L19,8h1.5V6.5L21,6h1.5V4.5l1-1V.5Z"}))},$o=function(){return i.createElement(v,{size:16},i.createElement("path",{d:"M2.000 2.500 L22.000 2.500 L22.000 23.500 L2.000 23.500 Z"}),i.createElement("path",{d:"M6 4.5L6 0.5"}),i.createElement("path",{d:"M18 4.5L18 0.5"}),i.createElement("path",{d:"M10 4.5L10 0.5"}),i.createElement("path",{d:"M14 4.5L14 0.5"}))},Go=function(){return i.createElement(v,{size:16},i.createElement("path",{d:"M17.5 0.498L17.5 23.498"}),i.createElement("path",{d:"M10.5 0.498L10.5 23.498"}),i.createElement("path",{d:"M23.5.5H6.5a6,6,0,0,0,0,12h4"}))},Uo=function(){return i.createElement(v,{size:16},i.createElement("path",{d:"M2.5 22.995L12 6.005 21.5 22.995 2.5 22.995z"}))},qo=function(m){var w=m.annotation,P=m.childAnnotation,R=m.page,F=m.viewport,O=w.hasPopup===!1,G=It(w),V=Lt(w),I=!!(w.hasPopup||G||V),$=w.name?w.name.toLowerCase():"";return i.createElement(wt,{annotation:w,hasPopup:O,ignoreBorder:!1,isRenderable:I,page:R,viewport:F},(function(W){return i.createElement(i.Fragment,null,i.createElement("div",c({},W.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--text","data-annotation-id":w.id,onClick:W.popup.toggleOnClick,onMouseEnter:W.popup.openOnHover,onMouseLeave:W.popup.closeOnHover}),$&&i.createElement("div",{className:"rpv-core__annotation-text-icon"},$==="check"&&i.createElement(b,null),$==="comment"&&i.createElement(jo,null),$==="help"&&i.createElement(Vo,null),$==="insert"&&i.createElement(Uo,null),$==="key"&&i.createElement(Wo,null),$==="note"&&i.createElement($o,null),($==="newparagraph"||$==="paragraph")&&i.createElement(Go,null)),W.slot.children),P&&P.annotationType===a.AnnotationType.Popup&&W.popup.opened&&i.createElement(ti,{annotation:P,page:R,viewport:F}))}))},Xo=function(m){var w=m.annotation,P=m.page,R=m.viewport,F=w.hasPopup===!1,O=It(w),G=Lt(w),V=!!(w.hasPopup||O||G);return i.createElement(wt,{annotation:w,hasPopup:F,ignoreBorder:!0,isRenderable:V,page:P,viewport:R},(function(I){return i.createElement("div",c({},I.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--underline","data-annotation-id":w.id,onClick:I.popup.toggleOnClick,onMouseEnter:I.popup.openOnHover,onMouseLeave:I.popup.closeOnHover}),I.slot.children)}))},Ko=function(m){var w=m.annotations,P=m.doc,R=m.outlines,F=m.page,O=m.pageIndex,G=m.plugins,V=m.rotation,I=m.scale,$=m.onExecuteNamedAction,W=m.onJumpFromLinkAnnotation,Z=m.onJumpToDest,Y=i.useRef(),K=F.getViewport({rotation:V,scale:I}).clone({dontFlip:!0}),se=w.filter((function(ie){return!ie.parentId}));return g((function(){var ie=Y.current;ie&&G.forEach((function(ne){ne.onAnnotationLayerRender&&ne.onAnnotationLayerRender({annotations:se,container:ie,pageIndex:O,rotation:V,scale:I})}))}),[]),i.createElement("div",{ref:Y,className:"rpv-core__annotation-layer","data-testid":"core__annotation-layer-".concat(O)},se.map((function(ie){var ne=w.find((function(Fe){return Fe.parentId===ie.id}));switch(ie.annotationType){case a.AnnotationType.Caret:return i.createElement(Vn,{key:ie.id,annotation:ie,page:F,viewport:K});case a.AnnotationType.Circle:return i.createElement(Pn,{key:ie.id,annotation:ie,page:F,viewport:K});case a.AnnotationType.FileAttachment:return i.createElement(ei,{key:ie.id,annotation:ie,page:F,viewport:K});case a.AnnotationType.FreeText:return i.createElement(vi,{key:ie.id,annotation:ie,page:F,viewport:K});case a.AnnotationType.Highlight:return i.createElement(ni,{key:ie.id,annotation:ie,childAnnotation:ne,page:F,viewport:K});case a.AnnotationType.Ink:return i.createElement(ii,{key:ie.id,annotation:ie,page:F,viewport:K});case a.AnnotationType.Line:return i.createElement(ri,{key:ie.id,annotation:ie,page:F,viewport:K});case a.AnnotationType.Link:return i.createElement(Sr,{key:ie.id,annotation:ie,annotationContainerRef:Y,doc:P,outlines:R,page:F,pageIndex:O,scale:I,viewport:K,onExecuteNamedAction:$,onJumpFromLinkAnnotation:W,onJumpToDest:Z});case a.AnnotationType.Polygon:return i.createElement(Fo,{key:ie.id,annotation:ie,page:F,viewport:K});case a.AnnotationType.Polyline:return i.createElement(Oo,{key:ie.id,annotation:ie,page:F,viewport:K});case a.AnnotationType.Popup:return i.createElement(ti,{key:ie.id,annotation:ie,page:F,viewport:K});case a.AnnotationType.Square:return i.createElement(No,{key:ie.id,annotation:ie,page:F,viewport:K});case a.AnnotationType.Squiggly:return i.createElement(Bo,{key:ie.id,annotation:ie,page:F,viewport:K});case a.AnnotationType.Stamp:return i.createElement(zo,{key:ie.id,annotation:ie,page:F,viewport:K});case a.AnnotationType.StrikeOut:return i.createElement(Ho,{key:ie.id,annotation:ie,page:F,viewport:K});case a.AnnotationType.Text:return i.createElement(qo,{key:ie.id,annotation:ie,childAnnotation:ne,page:F,viewport:K});case a.AnnotationType.Underline:return i.createElement(Xo,{key:ie.id,annotation:ie,page:F,viewport:K});default:return i.createElement(i.Fragment,{key:ie.id})}})))},Yo=function(m){var w=m.page,P=m.renderAnnotations,R=D(),F=i.useState({loading:!0,annotations:[]}),O=F[0],G=F[1];return i.useEffect((function(){w.getAnnotations({intent:"display"}).then((function(V){R.current&&G({loading:!1,annotations:V})}))}),[]),O.loading?i.createElement(i.Fragment,null):P(O.annotations)},Zo=function(m){var w=m.doc,P=m.outlines,R=m.page,F=m.pageIndex,O=m.plugins,G=m.rotation,V=m.scale,I=m.onExecuteNamedAction,$=m.onJumpFromLinkAnnotation,W=m.onJumpToDest;return i.createElement(Yo,{page:R,renderAnnotations:function(Z){return i.createElement(Ko,{annotations:Z,doc:w,outlines:P,page:R,pageIndex:F,plugins:O,rotation:G,scale:V,onExecuteNamedAction:I,onJumpFromLinkAnnotation:$,onJumpToDest:W})}})},Wi=function(m,w){var P=m%w;return P===0?m:Math.floor(m-P)},Jo=function(m){var w=m.canvasLayerRef,P=m.height,R=m.page,F=m.pageIndex,O=m.plugins,G=m.rotation,V=m.scale,I=m.width,$=m.onRenderCanvasCompleted,W=i.useRef();return g((function(){var Z=W.current;Z&&Z.cancel();var Y=w.current;Y.removeAttribute("data-testid"),O.forEach((function(we){we.onCanvasLayerRender&&we.onCanvasLayerRender({ele:Y,pageIndex:F,rotation:G,scale:V,status:a.LayerRenderStatus.PreRender})}));var K=R.getViewport({rotation:G,scale:V}),se=window.devicePixelRatio||1,ie=Math.sqrt(16777216/(K.width*K.height)),ne=se>ie;ne?Y.style.transform="scale(1, 1)":Y.style.removeProperty("transform");var Fe=Math.min(ie,se),me=(function(we,Ue){var $e,qe;if(Math.floor(we)===we)return[we,1];var Ye=1/we;if(Ye>Ue)return[1,Ue];if(Math.floor(Ye)===Ye)return[1,Ye];for(var et=we>1?Ye:we,Mt=0,ut=1,Dt=1,yt=1;;){var kt=Mt+Dt,xt=ut+yt;if(xt>Ue)break;et<=kt/xt?(Dt=($e=[kt,xt])[0],yt=$e[1]):(Mt=(qe=[kt,xt])[0],ut=qe[1])}return et<(Mt/ut+Dt/yt)/2?et===we?[Mt,ut]:[ut,Mt]:et===we?[Dt,yt]:[yt,Dt]})(Fe,8),ve=me[0],Se=me[1];Y.width=Wi(K.width*Fe,ve),Y.height=Wi(K.height*Fe,ve),Y.style.width="".concat(Wi(K.width,Se),"px"),Y.style.height="".concat(Wi(K.height,Se),"px"),Y.hidden=!0;var ue=Y.getContext("2d",{alpha:!1}),ke=ne||se!==1?[Fe,0,0,Fe,0,0]:null;return W.current=R.render({canvasContext:ue,transform:ke,viewport:K}),W.current.promise.then((function(){Y.hidden=!1,Y.setAttribute("data-testid","core__canvas-layer-".concat(F)),O.forEach((function(we){we.onCanvasLayerRender&&we.onCanvasLayerRender({ele:Y,pageIndex:F,rotation:G,scale:V,status:a.LayerRenderStatus.DidRender})})),$()}),(function(){$()})),function(){Y&&(Y.width=0,Y.height=0)}}),[]),i.createElement("div",{className:"rpv-core__canvas-layer",style:{height:"".concat(P,"px"),width:"".concat(I,"px")}},i.createElement("canvas",{ref:w}))},Qo=function(m){var w=m.height,P=m.page,R=m.rotation,F=m.scale,O=m.width,G=i.useRef();return g((function(){var V=G.current,I=P.getViewport({rotation:R,scale:F});P.getOperatorList().then((function($){(function(){var W=G.current;W&&(W.innerHTML="")})(),new s.SVGGraphics(P.commonObjs,P.objs).getSVG($,I).then((function(W){W.style.height="".concat(w,"px"),W.style.width="".concat(O,"px"),V.appendChild(W)}))}))}),[]),i.createElement("div",{className:"rpv-core__svg-layer",ref:G})},el=function(m){var w=m.containerRef,P=m.page,R=m.pageIndex,F=m.plugins,O=m.rotation,G=m.scale,V=m.onRenderTextCompleted,I=i.useRef(),$=function(){var W=w.current;W&&([].slice.call(W.querySelectorAll(".rpv-core__text-layer-text")).forEach((function(Z){return W.removeChild(Z)})),[].slice.call(W.querySelectorAll('br[role="presentation"]')).forEach((function(Z){return W.removeChild(Z)})))};return g((function(){var W=I.current;W&&W.cancel();var Z=w.current;if(Z){Z.removeAttribute("data-testid");var Y=P.getViewport({rotation:O,scale:G});return F.forEach((function(K){K.onTextLayerRender&&K.onTextLayerRender({ele:Z,pageIndex:R,scale:G,status:a.LayerRenderStatus.PreRender})})),P.getTextContent().then((function(K){$(),I.current=s.renderTextLayer({container:Z,textContent:K,textContentSource:K,viewport:Y}),I.current.promise.then((function(){Z.setAttribute("data-testid","core__text-layer-".concat(R)),[].slice.call(Z.children).forEach((function(se){se.classList.contains("rpv-core__text-layer-text--not")||se.classList.add("rpv-core__text-layer-text")})),F.forEach((function(se){se.onTextLayerRender&&se.onTextLayerRender({ele:Z,pageIndex:R,scale:G,status:a.LayerRenderStatus.DidRender})})),V()}),(function(){Z.removeAttribute("data-testid"),V()}))})),function(){var K;$(),(K=I.current)===null||K===void 0||K.cancel()}}}),[]),i.createElement("div",{className:"rpv-core__text-layer",ref:w})},tl=function(m){var w=m.doc,P=m.measureRef,R=m.outlines,F=m.pageIndex,O=m.pageRotation,G=m.pageSize,V=m.plugins,I=m.renderPage,$=m.renderQueueKey,W=m.rotation,Z=m.scale,Y=m.shouldRender,K=m.viewMode,se=m.onExecuteNamedAction,ie=m.onJumpFromLinkAnnotation,ne=m.onJumpToDest,Fe=m.onRenderCompleted,me=m.onRotatePage,ve=D(),Se=i.useState(null),ue=Se[0],ke=Se[1],we=i.useState(!1),Ue=we[0],$e=we[1],qe=i.useState(!1),Ye=qe[0],et=qe[1],Mt=i.useRef(),ut=i.useRef(),Dt=Math.abs(W+O)%180==0,yt=G.pageWidth*Z,kt=G.pageHeight*Z,xt=Dt?yt:kt,Et=Dt?kt:yt,Zt=(G.rotation+W+O)%360,En=i.useRef(0),vn=I||function(Wt){return i.createElement(i.Fragment,null,Wt.canvasLayer.children,Wt.textLayer.children,Wt.annotationLayer.children)};return i.useEffect((function(){ke(null),$e(!1),et(!1)}),[O,W,Z]),i.useEffect((function(){Y&&ve.current&&!ue&&rt(w,F).then((function(Wt){ve.current&&(En.current=$,ke(Wt))}))}),[Y,ue]),i.useEffect((function(){Ue&&Ye&&($!==En.current?(ke(null),$e(!1),et(!1)):Fe(F))}),[Ue,Ye]),i.createElement("div",{className:p({"rpv-core__page-layer":!0,"rpv-core__page-layer--dual":K===a.ViewMode.DualPage,"rpv-core__page-layer--dual-cover":K===a.ViewMode.DualPageWithCover,"rpv-core__page-layer--single":K===a.ViewMode.SinglePage}),"data-testid":"core__page-layer-".concat(F),ref:P,style:{height:"".concat(Et,"px"),width:"".concat(xt,"px")}},ue?i.createElement(i.Fragment,null,vn({annotationLayer:{attrs:{},children:i.createElement(Zo,{doc:w,outlines:R,page:ue,pageIndex:F,plugins:V,rotation:Zt,scale:Z,onExecuteNamedAction:se,onJumpFromLinkAnnotation:ie,onJumpToDest:ne})},canvasLayer:{attrs:{},children:i.createElement(Jo,{canvasLayerRef:Mt,height:Et,page:ue,pageIndex:F,plugins:V,rotation:Zt,scale:Z,width:xt,onRenderCanvasCompleted:function(){ve.current&&$e(!0)}})},canvasLayerRendered:Ue,doc:w,height:Et,pageIndex:F,rotation:Zt,scale:Z,svgLayer:{attrs:{},children:i.createElement(Qo,{height:Et,page:ue,rotation:Zt,scale:Z,width:xt})},textLayer:{attrs:{},children:i.createElement(el,{containerRef:ut,page:ue,pageIndex:F,plugins:V,rotation:Zt,scale:Z,onRenderTextCompleted:function(){ve.current&&et(!0)}})},textLayerRendered:Ye,width:xt,markRendered:Fe,onRotatePage:function(Wt){return me(F,Wt)}}),V.map((function(Wt,sn){return Wt.renderPageLayer?i.createElement(i.Fragment,{key:sn},Wt.renderPageLayer({canvasLayerRef:Mt,canvasLayerRendered:Ue,doc:w,height:Et,pageIndex:F,rotation:Zt,scale:Z,textLayerRef:ut,textLayerRendered:Ye,width:xt})):i.createElement(i.Fragment,{key:sn})}))):i.createElement(C,{testId:"core__page-layer-loading-".concat(F)}))},nl=function(m,w){var P=w.rect;return m.height!==P.height||m.width!==P.width?P:m};(function(m){m.Horizontal="Horizontal",m.Vertical="Vertical",m.Both="Both"})(Ge||(Ge={}));var il=function(m){return 1-Math.pow(1-m,4)},$i=1e-4,Ns={left:0,top:0},Bs={capture:!1,passive:!0},rl=function(m){var w=m.elementRef,P=m.enableSmoothScroll,R=m.isRtl,F=m.scrollDirection,O=m.onSmoothScroll,G=i.useState(Ns),V=G[0],I=G[1],$=i.useState(w.current),W=$[0],Z=$[1],Y=R?-1:1,K=i.useRef(F);K.current=F;var se=i.useRef(Ns),ie=i.useRef(!0),ne=i.useCallback((function(){ie.current=!0,P&&I(se.current),O(!1)}),[]),Fe=i.useCallback((function(){if(W){switch(K.current){case Ge.Horizontal:se.current={left:Y*W.scrollLeft,top:0};break;case Ge.Both:se.current={left:Y*W.scrollLeft,top:W.scrollTop};break;case Ge.Vertical:default:se.current={left:0,top:W.scrollTop}}P&&!ie.current||I(se.current)}}),[W]);g((function(){Z(w.current)})),g((function(){if(W)return W.addEventListener("scroll",Fe,Bs),function(){W.removeEventListener("scroll",Fe,Bs)}}),[W]);var me=i.useCallback((function(ve,Se){var ue=w.current;if(!ue)return Promise.resolve();var ke={left:0,top:0};switch(K.current){case Ge.Horizontal:ke.left=Y*ve.left;break;case Ge.Both:ke.left=Y*ve.left,ke.top=ve.top;break;case Ge.Vertical:default:ke.top=ve.top}return Se?(ie.current=!1,O(!0),new Promise((function(we,Ue){(function($e,qe,Ye,et,Mt,ut){Mt===void 0&&(Mt=function(sn){return sn}),ut===void 0&&(ut=function(){});var Dt=0,yt=0,kt=!1;switch(qe){case Ge.Horizontal:yt=$e.scrollLeft,Dt=0;case Ge.Both:yt=$e.scrollLeft,Dt=$e.scrollTop;break;case Ge.Vertical:default:yt=0,Dt=$e.scrollTop}var xt=function(){kt||(kt=!0,$e.scrollLeft=Ye.left,$e.scrollTop=Ye.top,ut())};if(Math.abs(Dt-Ye.top)<=$i&&qe===Ge.Vertical)xt();else if(Math.abs(yt-Ye.left)<=$i&&qe===Ge.Horizontal)xt();else{var Et,Zt=-1,En=yt-Ye.left,vn=Dt-Ye.top,Wt=function(sn){Zt===-1&&(Zt=sn);var kn=sn-Zt,ye=Math.min(kn/et,1),be=Mt(ye),he={left:yt-En*be,top:Dt-vn*be};switch(qe){case Ge.Horizontal:$e.scrollLeft=he.left;break;case Ge.Both:$e.scrollLeft=he.left,$e.scrollTop=he.top;break;case Ge.Vertical:default:$e.scrollTop=he.top}Math.abs(he.top-Ye.top)<=$i&&Math.abs(he.left-Ye.left)<=$i&&!kt&&(window.cancelAnimationFrame(Et),xt()),kn<et?Et=window.requestAnimationFrame(Wt):window.cancelAnimationFrame(Et)};Et=window.requestAnimationFrame(Wt)}})(ue,K.current,ke,400,il,(function(){ne(),we()}))}))):new Promise((function(we,Ue){switch(K.current){case Ge.Horizontal:ue.scrollLeft=ke.left;break;case Ge.Both:ue.scrollLeft=ke.left,ue.scrollTop=ke.top;break;case Ge.Vertical:default:ue.scrollTop=ke.top}we()}))}),[w]);return{scrollOffset:V,scrollTo:me}},wi=function(m,w,P){return Math.max(m,Math.min(P,w))},sl=function(m,w){if(w!==a.ViewMode.DualPageWithCover)return 0;if(!(function(F){var O=F.length;if(O===1)return!1;for(var G=1;G<O;G++)if(F[G].height!==F[0].height||F[G].width!==F[0].width)return!0;return!1})(m))return 2*m[0].width;var P=_t(m.slice(1),2).map((function(F){return F.length===2?F[0].width+F[1].width:F[0].width})),R=[m[0].width].concat(P);return Math.max.apply(Math,R)},al={left:0,top:0},ol={left:0,top:0},Ar={left:0,top:0},ll={left:0,top:0},cl={height:0,width:0},zs={left:0,top:0},Hs="data-virtual-index",ul=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],hl=function(m){var w=m.enableSmoothScroll,P=m.isRtl,R=m.numberOfItems,F=m.parentRef,O=m.setRenderRange,G=m.sizes,V=m.scrollMode,I=m.viewMode,$=i.useState(!1),W=$[0],Z=$[1],Y=i.useCallback((function(ye){return Z(ye)}),[]),K=i.useRef(V);K.current=V;var se=i.useRef(I);se.current=I;var ie=V===a.ScrollMode.Wrapped||I===a.ViewMode.DualPageWithCover||I===a.ViewMode.DualPage?Ge.Both:V===a.ScrollMode.Horizontal?Ge.Horizontal:Ge.Vertical,ne=rl({elementRef:F,enableSmoothScroll:w,isRtl:P,scrollDirection:ie,onSmoothScroll:Y}),Fe=ne.scrollOffset,me=ne.scrollTo,ve=(function(ye){var be=ye.elementRef,he=i.useState(be.current),fe=he[0],de=he[1],xe=i.useRef(!1),Me=i.useReducer(nl,{height:0,width:0}),pe=Me[0],ae=Me[1];return g((function(){be.current!==fe&&de(be.current)})),g((function(){if(fe&&!xe.current){xe.current=!0;var Ie=fe.getBoundingClientRect(),Ne=Ie.height,lt=Ie.width;ae({rect:{height:Ne,width:lt}})}}),[fe]),i.useEffect((function(){if(fe){var Ie=new ResizeObserver((function(Ne,lt){Ne.forEach((function(st){if(st.target===fe){var qt=st.contentRect,cn=qt.height,De=qt.width;ae({rect:{height:cn,width:De}})}}))}));return Ie.observe(fe),function(){Ie.unobserve(fe)}}}),[fe]),pe})({elementRef:F}),Se=i.useRef({scrollOffset:zs,measurements:[]});Se.current.scrollOffset=Fe;var ue=i.useMemo((function(){return Array(R).fill(-1)}),[]),ke=i.useState(ue),we=ke[0],Ue=ke[1],$e=i.useMemo((function(){var ye=new IntersectionObserver((function(be){be.forEach((function(he){var fe=he.isIntersecting?he.intersectionRatio:-1,de=he.target.getAttribute(Hs);if(de){var xe=parseInt(de,10);0<=xe&&xe<R&&Ue((function(Me){return Me[xe]=fe,(function(pe,ae,Ie){for(var Ne,lt=0,st=ae.length;lt<st;lt++)!Ne&&lt in ae||(Ne||(Ne=Array.prototype.slice.call(ae,0,lt)),Ne[lt]=ae[lt]);return pe.concat(Ne||Array.prototype.slice.call(ae))})([],Me)}))}}))}),{threshold:ul});return ye}),[]),qe=i.useMemo((function(){return V===a.ScrollMode.Page&&I===a.ViewMode.SinglePage?(function(ye,be,he){for(var fe=[],de=0;de<ye;de++){var xe={height:Math.max(be.height,he[de].height),width:Math.max(be.width,he[de].width)},Me=de===0?ll:fe[de-1].end,pe={left:Me.left+xe.width,top:Me.top+xe.height};fe[de]={index:de,start:Me,size:xe,end:pe,visibility:-1}}return fe})(R,ve,G):I===a.ViewMode.DualPageWithCover?(function(ye,be,he,fe){for(var de=[],xe=0,Me=0,pe=Ar,ae=0;ae<ye;ae++){var Ie=ae===0?{height:fe===a.ScrollMode.Page?Math.max(be.height,he[ae].height):he[ae].height,width:fe===a.ScrollMode.Page?Math.max(be.width,he[ae].width):he[ae].width}:{height:fe===a.ScrollMode.Page?Math.max(be.height,he[ae].height):he[ae].height,width:Math.max(be.width/2,he[ae].width)};fe===a.ScrollMode.Page?pe=ae===0?Ar:{left:ae%2==0?Ie.width:0,top:Math.floor((ae-1)/2)*Ie.height+de[0].end.top}:ae===0?(pe=Ar,xe=he[0].height,Me=0):ae%2==1?(pe={left:0,top:xe+=Me},Me=ae===ye-1?he[ae].height:Math.max(he[ae].height,he[ae+1].height)):pe={left:de[ae-1].end.left,top:xe};var Ne={left:pe.left+Ie.width,top:pe.top+Ie.height};de[ae]={index:ae,start:pe,size:Ie,end:Ne,visibility:-1}}return de})(R,ve,G,V):I===a.ViewMode.DualPage?(function(ye,be,he,fe){for(var de=[],xe=0,Me=0,pe=ol,ae=0;ae<ye;ae++){var Ie={height:fe===a.ScrollMode.Page?Math.max(be.height,he[ae].height):he[ae].height,width:Math.max(be.width/2,he[ae].width)};fe===a.ScrollMode.Page?pe={left:ae%2==0?0:Ie.width,top:Math.floor(ae/2)*Ie.height}:ae%2==0?(pe={left:0,top:xe+=Me},Me=ae===ye-1?he[ae].height:Math.max(he[ae].height,he[ae+1].height)):pe={left:de[ae-1].end.left,top:xe};var Ne={left:pe.left+Ie.width,top:pe.top+Ie.height};de[ae]={index:ae,start:pe,size:Ie,end:Ne,visibility:-1}}return de})(R,ve,G,V):(function(ye,be,he,fe){for(var de=[],xe=0,Me={left:0,top:0},pe=0,ae=al,Ie=0;Ie<ye;Ie++){var Ne=he[Ie];if(Ie===0)xe=Ne.width,Me={left:0,top:0},pe=Ne.height;else switch(fe){case a.ScrollMode.Wrapped:(xe+=Ne.width)<be.width?(ae={left:de[Ie-1].end.left,top:Me.top},pe=Math.max(pe,Ne.height)):(xe=Ne.width,Me={left:(ae={left:Me.left,top:Me.top+pe}).left,top:ae.top},pe=Ne.height);break;case a.ScrollMode.Horizontal:case a.ScrollMode.Vertical:default:ae=de[Ie-1].end}var lt={left:ae.left+Ne.width,top:ae.top+Ne.height};de[Ie]={index:Ie,start:ae,size:Ne,end:lt,visibility:-1}}return de})(R,ve,G,V)}),[V,G,I,ve]),Ye=qe[R-1]?{height:qe[R-1].end.top,width:qe[R-1].end.left}:cl;Se.current.measurements=qe;var et=i.useMemo((function(){var ye=(function(Ie,Ne,lt,st){var qt=0;switch(Ie){case Ge.Horizontal:qt=st.left;break;case Ge.Vertical:default:qt=st.top}var cn=Ne.length-1,De=(function(nt,Rn,ai,Ui){for(;nt<=Rn;){var Wn=(nt+Rn)/2|0,yi=Ui(Wn);if(yi<ai)nt=Wn+1;else{if(!(yi>ai))return Wn;Rn=Wn-1}}return nt>0?nt-1:0})(0,cn,qt,(function(nt){switch(Ie){case Ge.Horizontal:return Ne[nt].start.left;case Ge.Both:case Ge.Vertical:default:return Ne[nt].start.top}}));if(Ie===Ge.Both)for(var Xt=Ne[De].start.top;De-1>=0&&Ne[De-1].start.top===Xt&&Ne[De-1].start.left>=st.left;)De--;for(var ct=De;ct<=cn;){var ht={top:Ne[ct].start.top-st.top,left:Ne[ct].start.left-st.left},zt={height:lt.height-ht.top,width:lt.width-ht.left};if(Ie===Ge.Horizontal&&zt.width<0||Ie===Ge.Vertical&&zt.height<0||Ie===Ge.Both&&(zt.width<0||zt.height<0))break;ct++}return{start:De,end:ct}})(ie,qe,ve,Fe),be=ye.start,he=ye.end,fe=we.slice(wi(0,R,be),wi(0,R,he)),de=be+fe.reduce((function(Ie,Ne,lt,st){return Ne>st[Ie]?lt:Ie}),0),xe=de=wi(0,R-1,de),Me=O({endPage:he,numPages:R,startPage:be}),pe=Me.startPage,ae=Me.endPage;switch(pe=Math.max(pe,0),ae=Math.min(ae,R-1),I){case a.ViewMode.DualPageWithCover:de>0&&(xe=de%2==1?de:de-1),pe=pe===0?0:pe%2==1?pe:pe-1,R-(ae=ae%2==1?ae-1:ae)<=2&&(ae=R-1);break;case a.ViewMode.DualPage:xe=de%2==0?de:de-1,pe=pe%2==0?pe:pe-1,ae=ae%2==1?ae:ae-1;break;case a.ViewMode.SinglePage:default:xe=de}return{startPage:pe,endPage:ae,maxVisbilityIndex:xe}}),[qe,ve,Fe,I,we]),Mt=et.startPage,ut=et.endPage,Dt=et.maxVisbilityIndex,yt=i.useMemo((function(){for(var ye=[],be=function(fe){var de=qe[fe],xe=c(c({},de),{visibility:we[fe]!==void 0?we[fe]:-1,measureRef:function(Me){Me&&(Me.setAttribute(Hs,"".concat(fe)),$e.observe(Me))}});ye.push(xe)},he=Mt;he<=ut;he++)be(he);return ye}),[Mt,ut,we,qe]),kt=i.useCallback((function(ye,be){var he=Se.current.measurements[wi(0,R-1,ye)],fe=K.current===a.ScrollMode.Page?zs:be;return he?me({left:fe.left+he.start.left,top:fe.top+he.start.top},w):Promise.resolve()}),[me,w]),xt=i.useCallback((function(ye,be){var he=Se.current.measurements,fe=he[ye].start,de=he.find((function(Me){return Me.start.top-fe.top>1e-12}));if(!de)return Promise.resolve();var xe=de.index;switch(se.current){case a.ViewMode.DualPage:xe=xe%2==0?xe:xe+1;break;case a.ViewMode.DualPageWithCover:xe=xe%2==1?xe:xe+1}return kt(xe,be)}),[]),Et=i.useCallback((function(ye,be){for(var he=Se.current.measurements,fe=he[ye].start,de=ye,xe=!1,Me=R-1;Me>=0;Me--)if(fe.top-he[Me].start.top>1e-12){xe=!0,de=he[Me].index;break}if(!xe)return Promise.resolve();switch(se.current){case a.ViewMode.DualPage:de=de%2==0?de:de-1;break;case a.ViewMode.DualPageWithCover:de=de%2==0?de-1:de}return de===ye&&(de=ye-1),kt(de,be)}),[]),Zt=i.useCallback((function(ye,be){if(se.current===a.ViewMode.DualPageWithCover||se.current===a.ViewMode.DualPage)return xt(ye,be);switch(K.current){case a.ScrollMode.Wrapped:return xt(ye,be);case a.ScrollMode.Horizontal:case a.ScrollMode.Vertical:default:return kt(ye+1,be)}}),[]),En=i.useCallback((function(ye,be){if(se.current===a.ViewMode.DualPageWithCover||se.current===a.ViewMode.DualPage)return Et(ye,be);switch(K.current){case a.ScrollMode.Wrapped:return Et(ye,be);case a.ScrollMode.Horizontal:case a.ScrollMode.Vertical:default:return kt(ye-1,be)}}),[]),vn=i.useCallback((function(){return(function(ye,be){switch(be){case a.ScrollMode.Horizontal:return{position:"relative",height:"100%",width:"".concat(ye.width,"px")};case a.ScrollMode.Vertical:default:return{position:"relative",height:"".concat(ye.height,"px"),width:"100%"}}})(Ye,K.current)}),[Ye]),Wt=i.useCallback((function(ye){return(function(be,he,fe){return fe!==a.ScrollMode.Page?{}:{height:"".concat(he.height,"px"),width:"100%",position:"absolute",top:0,transform:"translateY(".concat(be.start.top,"px)")}})(ye,ve,K.current)}),[ve]),sn=i.useCallback((function(ye){return(function(be,he,fe,de,xe){var Me,pe,ae,Ie,Ne,lt,st,qt=he?"right":"left",cn=he?-1:1,De=fe.length,Xt=be.start.left*cn,ct=be.size,ht=ct.height,zt=ct.width;if(de===a.ViewMode.DualPageWithCover){var nt=xe===a.ScrollMode.Page?0:be.start.top;return be.index===0||De%2==0&&be.index===De-1?((Me={height:"".concat(ht,"px"),minWidth:"".concat(sl(fe,de),"px"),width:"100%"})[qt]=0,Me.position="absolute",Me.top=0,Me.transform="translate(".concat(Xt,"px, ").concat(nt,"px)"),Me):((pe={height:"".concat(ht,"px"),width:"".concat(zt,"px")})[qt]=0,pe.position="absolute",pe.top=0,pe.transform="translate(".concat(Xt,"px, ").concat(nt,"px)"),pe)}if(de===a.ViewMode.DualPage)return(ae={height:"".concat(ht,"px"),width:"".concat(zt,"px")})[qt]=0,ae.position="absolute",ae.top=0,ae.transform="translate(".concat(Xt,"px, ").concat(xe===a.ScrollMode.Page?0:be.start.top,"px)"),ae;switch(xe){case a.ScrollMode.Horizontal:return(Ie={height:"100%",width:"".concat(zt,"px")})[qt]=0,Ie.position="absolute",Ie.top=0,Ie.transform="translateX(".concat(Xt,"px)"),Ie;case a.ScrollMode.Page:return(Ne={height:"".concat(ht,"px"),width:"".concat(zt,"px")})[qt]=0,Ne.position="absolute",Ne.top=0,Ne;case a.ScrollMode.Wrapped:return(lt={height:"".concat(ht,"px"),width:"".concat(zt,"px")})[qt]=0,lt.position="absolute",lt.top=0,lt.transform="translate(".concat(Xt,"px, ").concat(be.start.top,"px)"),lt;case a.ScrollMode.Vertical:default:return(st={height:"".concat(ht,"px"),width:"100%"})[qt]=0,st.position="absolute",st.top=0,st.transform="translateY(".concat(be.start.top,"px)"),st}})(ye,P,G,se.current,K.current)}),[P,G]),kn=i.useCallback((function(ye,be){var he=Se.current,fe=he.measurements,de=he.scrollOffset,xe=fe[wi(0,R-1,be)];if(xe){var Me=K.current===a.ScrollMode.Page?{left:xe.start.left,top:xe.start.top}:{left:de.left*ye,top:de.top*ye};return me(Me,!1)}return Promise.resolve()}),[]);return i.useEffect((function(){return function(){$e.disconnect()}}),[]),{boundingClientRect:ve,isSmoothScrolling:W,startPage:Mt,endPage:ut,maxVisbilityIndex:Dt,virtualItems:yt,getContainerStyles:vn,getItemContainerStyles:Wt,getItemStyles:sn,scrollToItem:kt,scrollToNextItem:Zt,scrollToPreviousItem:En,zoom:kn}},Cr=function(m,w,P,R,F,O){var G=P;switch(!0){case(F===a.ViewMode.DualPageWithCover&&O>=3):case(F===a.ViewMode.DualPage&&O>=3):G=2*P;break;default:G=P}switch(R){case a.SpecialZoomLevel.ActualSize:return 1;case a.SpecialZoomLevel.PageFit:return Math.min((m.clientWidth-17)/G,(m.clientHeight-16)/w);case a.SpecialZoomLevel.PageWidth:return(m.clientWidth-17)/G}},dl=function(m){var w,P,R=m.getCurrentPage,F=(w=50,P=i.useRef([]),i.useEffect((function(){return function(){P.current=[]}}),[]),{push:function($){var W=P.current;W.length+1>w&&W.shift(),W.push($),P.current=W},map:function($){return P.current.map((function(W){return $(W)}))},pop:function(){var $=P.current;if($.length===0)return null;var W=$.pop();return P.current=$,W}}),O=(function($){var W=i.useRef([]);return i.useEffect((function(){return function(){W.current=[]}}),[]),{dequeue:function(){var Z=W.current;if(Z.length===0)return null;var Y=Z.shift();return W.current=Z,Y||null},enqueue:function(Z){var Y=W.current;Y.length+1>$&&Y.pop(),W.current=[Z].concat(Y)},map:function(Z){return W.current.map((function(Y){return Z(Y)}))}}})(50),G=function(){var $=O.dequeue();return $&&F.push($),$&&$.pageIndex===R()?G():$},V=function(){var $=F.pop();return $&&O.enqueue($),$&&$.pageIndex===R()?V():$},I=i.useCallback((function($){F.push($)}),[]);return{getNextDestination:G,getPreviousDestination:V,markVisitedDestination:I}},js=function(m){var w=[];return m.map((function(P){w=w.concat(P).concat((function(R){var F=[];return R.items&&R.items.length>0&&(F=F.concat(js(R.items))),F})(P))})),w},Vs={capture:!1,passive:!0},fl={height:0,width:0},Pr={height:0,width:0},pl=function(m){var w=m.getCurrentPage,P=m.getCurrentScrollMode,R=m.jumpToPage,F=m.targetRef,O=i.useState(a.FullScreenMode.Normal),G=O[0],V=O[1],I=(function(){var we=i.useState(fl),Ue=we[0],$e=we[1],qe=N((function(){$e({height:window.innerHeight,width:window.innerWidth})}),100);return g((function(){return window.addEventListener("resize",qe,Vs),function(){window.removeEventListener("resize",qe,Vs)}}),[]),Ue})(),$=i.useState(Pr),W=$[0],Z=$[1],Y=i.useRef(Pr),K=i.useRef(w()),se=i.useRef(Pr),ie=i.useState(F.current),ne=ie[0],Fe=ie[1],me=i.useRef();g((function(){F.current!==ne&&Fe(F.current)}),[]),g((function(){if(ne){var we=new ResizeObserver((function(Ue){Ue.forEach((function($e){var qe=$e.target.getBoundingClientRect(),Ye=qe.height,et=qe.width;Z({height:Ye,width:et})}))}));return we.observe(ne),function(){we.unobserve(ne),we.disconnect()}}}),[ne]);var ve=i.useCallback((function(we){var Ue=L();return Ue&&Ue!==we?(V(a.FullScreenMode.Normal),S(Ue)):Promise.resolve()}),[]),Se=i.useCallback((function(we){we&&y()&&(Fe(we),ve(we).then((function(){me.current=we,V(a.FullScreenMode.Entering),(function(Ue){B&&Ue[z.RequestFullScreen]()})(we)})))}),[]),ue=i.useCallback((function(){L()&&(V(a.FullScreenMode.Exitting),S(document))}),[]),ke=i.useCallback((function(){ne&&L()!==ne&&V(a.FullScreenMode.Exitting)}),[ne]);return i.useEffect((function(){switch(G){case a.FullScreenMode.Entering:me.current&&(me.current.style.backgroundColor="var(--rpv-core__full-screen-target-background-color)"),K.current=w(),Y.current={height:window.innerHeight,width:window.innerWidth};break;case a.FullScreenMode.Entered:P()===a.ScrollMode.Page?R(K.current).then((function(){V(a.FullScreenMode.EnteredCompletely)})):V(a.FullScreenMode.EnteredCompletely);break;case a.FullScreenMode.Exitting:me.current&&(me.current.style.backgroundColor="",me.current=null),K.current=w();break;case a.FullScreenMode.Exited:V(a.FullScreenMode.Normal),P()===a.ScrollMode.Page&&R(K.current)}}),[G]),i.useEffect((function(){if(G!==a.FullScreenMode.Normal)return G===a.FullScreenMode.Entering&&I.height===W.height&&I.width===W.width&&I.height>0&&I.width>0&&(se.current.height===0||I.height==se.current.height)?(se.current={height:window.innerHeight,width:window.innerWidth},void V(a.FullScreenMode.Entered)):void(G===a.FullScreenMode.Exitting&&Y.current.height===I.height&&Y.current.width===I.width&&I.height>0&&I.width>0&&V(a.FullScreenMode.Exited))}),[G,I,W]),i.useEffect((function(){var we;return we=ke,B&&document.addEventListener(z.FullScreenChange,we),function(){(function(Ue){B&&document.removeEventListener(z.FullScreenChange,Ue)})(ke)}}),[ne]),{enterFullScreenMode:Se,exitFullScreenMode:ue,fullScreenMode:G}},gl={buildPageStyles:function(){return{}},transformSize:function(m){return m.size}},si={left:0,top:0},ml=function(m){var w=m.currentFile,P=m.defaultScale,R=m.doc,F=m.enableSmoothScroll,O=m.initialPage,G=m.initialRotation,V=m.initialScale,I=m.pageLayout,$=m.pageSizes,W=m.plugins,Z=m.renderPage,Y=m.scrollMode,K=m.setRenderRange,se=m.viewMode,ie=m.viewerState,ne=m.onDocumentLoad,Fe=m.onOpenFile,me=m.onPageChange,ve=m.onRotate,Se=m.onRotatePage,ue=m.onZoom,ke=R.numPages,we=R.loadingTask.docId,Ue=i.useContext(Q).l10n,$e=i.useContext(f),qe=$e.direction===a.TextDirection.RightToLeft,Ye=i.useRef(),et=i.useRef(),Mt=i.useState(O),ut=Mt[0],Dt=Mt[1],yt=i.useRef(null),kt=dl({getCurrentPage:function(){return De.current.pageIndex}}),xt=i.useState(G),Et=xt[0],Zt=xt[1],En=M(Et),vn=i.useState(!1),Wt=vn[0],sn=vn[1],kn=i.useState(new Map),ye=kn[0],be=kn[1],he=i.useState(Y),fe=he[0],de=he[1],xe=M(fe),Me=i.useState(se),pe=Me[0],ae=Me[1],Ie=M(pe),Ne=(function(ee){var Te=D(),je=i.useState([]),tt=je[0],Ze=je[1];return i.useEffect((function(){ee.getOutline().then((function(Ve){if(Te.current&&Ve!==null){var Ht=js(Ve);Ze(Ht)}}))}),[]),tt})(R),lt=i.useState(V),st=lt[0],qt=lt[1],cn=M(st),De=i.useRef(ie),Xt=i.useRef(typeof P=="string"?P:null),ct=i.useRef(-1),ht=i.useRef(-1),zt=i.useRef(O),nt=pl({getCurrentPage:function(){return De.current.pageIndex},getCurrentScrollMode:function(){return De.current.scrollMode},jumpToPage:function(ee){return In(ee)},targetRef:et}),Rn=i.useState(-1),ai=Rn[0],Ui=Rn[1],Wn=i.useState(0),yi=Wn[0],El=Wn[1],un=U({doc:R});i.useEffect((function(){return function(){gt.clear(),Rt.clear()}}),[we]);var Us=i.useMemo((function(){return Object.assign({},gl,I)}),[]),Sl=i.useMemo((function(){return Array(ke).fill(0).map((function(ee,Te){var je=[$[Te].pageHeight,$[Te].pageWidth],tt=Math.abs(Et)%180==0?{height:je[0],width:je[1]}:{height:je[1],width:je[0]},Ze={height:tt.height*st,width:tt.width*st};return Us.transformSize({numPages:ke,pageIndex:Te,size:Ze})}))}),[Et,st]),ot=hl({enableSmoothScroll:F,isRtl:qe,numberOfItems:ke,parentRef:et,scrollMode:fe,setRenderRange:K,sizes:Sl,viewMode:pe}),Al=N((function(){!Xt.current||De.current.fullScreenMode!==a.FullScreenMode.Normal||O>0&&zt.current===O||$n(Xt.current)}),200);(function(ee){var Te=ee.targetRef,je=ee.onResize;g((function(){var tt=new ResizeObserver((function(Ve){Ve.forEach((function(Ht){je(Ht.target)}))})),Ze=Te.current;if(Ze)return tt.observe(Ze),function(){tt.unobserve(Ze)}}),[])})({targetRef:et,onResize:Al});var Ln=function(ee){var Te=ee;W.forEach((function(je){je.onViewerStateChange&&(Te=je.onViewerStateChange(Te))})),De.current=Te},Cl=function(){return et.current},Pl=function(){return De.current},kl=i.useCallback((function(ee){kt.markVisitedDestination(ee)}),[]),Mr=i.useCallback((function(ee){var Te=ee.pageIndex,je=ee.bottomOffset,tt=ee.leftOffset,Ze=ee.scaleTo,Ve=et.current,Ht=De.current;return Ve&&Ht?new Promise((function(Dn,Fr){rt(R,Te).then((function(qi){var Fn=qi.getViewport({scale:1}),Xi=0,ea=(typeof je=="function"?je(Fn.width,Fn.height):je)||0,Ki=(typeof tt=="function"?tt(Fn.width,Fn.height):tt)||0,oi=Ht.scale;switch(Ze){case a.SpecialZoomLevel.PageFit:Xi=0,Ki=0,$n(a.SpecialZoomLevel.PageFit);break;case a.SpecialZoomLevel.PageWidth:oi=Cr(Ve,$[Te].pageHeight,$[Te].pageWidth,a.SpecialZoomLevel.PageWidth,se,ke),Xi=(Fn.height-ea)*oi,Ki*=oi,$n(oi);break;default:Xi=(Fn.height-ea)*oi,Ki*=oi}switch(Ht.scrollMode){case a.ScrollMode.Horizontal:ot.scrollToItem(Te,{left:Ki,top:0}).then((function(){Dn()}));break;case a.ScrollMode.Vertical:default:ot.scrollToItem(Te,{left:0,top:Xi}).then((function(){Dn()}))}}))})):Promise.resolve()}),[]),qs=i.useCallback((function(ee){return kt.markVisitedDestination(ee),Mr(ee)}),[]),xl=i.useCallback((function(){var ee=kt.getNextDestination();return ee?Mr(ee):Promise.resolve()}),[]),Ml=i.useCallback((function(){var ee=kt.getPreviousDestination();return ee?Mr(ee):Promise.resolve()}),[]),Tl=i.useCallback((function(){return ot.scrollToNextItem(De.current.pageIndex,si)}),[]),In=i.useCallback((function(ee){return 0<=ee&&ee<ke?ot.scrollToItem(ee,si):Promise.resolve()}),[]),Rl=i.useCallback((function(){return ot.scrollToPreviousItem(De.current.pageIndex,si)}),[]),Xs=i.useCallback((function(ee){var Te,je;(Te=ee.name,je=Te.split(/\./).pop(),je?je.toLowerCase():"").toLowerCase()==="pdf"&&new Promise((function(tt){var Ze=new FileReader;Ze.readAsArrayBuffer(ee),Ze.onload=function(){var Ve=new Uint8Array(Ze.result);tt(Ve)}})).then((function(tt){Fe(ee.name,tt)}))}),[Fe]),Ks=i.useCallback((function(ee){var Te=ee===a.RotateDirection.Backward?-90:90,je=De.current.rotation,tt=je===360||je===-360?Te:je+Te;un.markNotRendered(),Zt(tt),Ln(c(c({},De.current),{rotation:tt})),ve({direction:ee,doc:R,rotation:tt})}),[]),Tr=i.useCallback((function(ee,Te){var je=Te===a.RotateDirection.Backward?-90:90,tt=De.current.pagesRotation,Ze=(tt.has(ee)?tt.get(ee):G)+je,Ve=tt.set(ee,Ze);be(Ve),sn((function(Ht){return!Ht})),Ln(c(c({},De.current),{pagesRotation:Ve,rotatedPage:ee})),Se({direction:Te,doc:R,pageIndex:ee,rotation:Ze}),un.markRendering(ee),Ui(ee)}),[]),Ys=i.useCallback((function(ee){Ln(c(c({},De.current),{scrollMode:ee})),de(ee)}),[]),Zs=i.useCallback((function(ee){Ln(c(c({},De.current),{viewMode:ee})),ae(ee)}),[]),$n=i.useCallback((function(ee){var Te=et.current,je=De.current.pageIndex;if(!(je<0||je>=ke)){var tt=$[je].pageHeight,Ze=$[je].pageWidth,Ve=Te?typeof ee=="string"?Cr(Te,tt,Ze,ee,De.current.viewMode,ke):ee:1;Xt.current=typeof ee=="string"?ee:null,Ve!==De.current.scale&&(El((function(Ht){return Ht+1})),un.markNotRendered(),qt(Ve),ue({doc:R,scale:Ve}),Ln(c(c({},De.current),{scale:Ve})))}}),[]),Ll=i.useCallback((function(ee){nt.enterFullScreenMode(ee)}),[]),Il=i.useCallback((function(){nt.exitFullScreenMode()}),[]);i.useEffect((function(){Ln(c(c({},De.current),{fullScreenMode:nt.fullScreenMode}))}),[nt.fullScreenMode]),i.useEffect((function(){var ee={enterFullScreenMode:Ll,exitFullScreenMode:Il,getPagesContainer:Cl,getViewerState:Pl,jumpToDestination:qs,jumpToNextDestination:xl,jumpToPreviousDestination:Ml,jumpToNextPage:Tl,jumpToPreviousPage:Rl,jumpToPage:In,openFile:Xs,rotate:Ks,rotatePage:Tr,setViewerState:Ln,switchScrollMode:Ys,switchViewMode:Zs,zoom:$n};return W.forEach((function(Te){Te.install&&Te.install(ee)})),function(){W.forEach((function(Te){Te.uninstall&&Te.uninstall(ee)}))}}),[we]),i.useEffect((function(){ne({doc:R,file:w}),W.forEach((function(ee){ee.onDocumentLoad&&ee.onDocumentLoad({doc:R,file:w})}))}),[we]);var Rr,Lr,Ir,Js=ot.boundingClientRect;Rr=function(){O&&In(O)},Lr=Js.height>0&&Js.width>0,Ir=i.useRef(!1),g((function(){Lr&&!Ir.current&&(Ir.current=!0,Rr())}),[Rr,Lr]),g((function(){var ee=De.current.pageIndex;ee>-1&&xe!==fe&&ot.scrollToItem(ee,si).then((function(){nt.fullScreenMode===a.FullScreenMode.EnteredCompletely&&(F||un.markNotRendered(),ct.current=-1)}))}),[fe]),g((function(){var ee=De.current.pageIndex;ee>-1&&En!==Et&&ot.scrollToItem(ee,si)}),[Et]),g((function(){cn!=0&&cn!=De.current.scale&&ot.zoom(De.current.scale/cn,De.current.pageIndex).then((function(){nt.fullScreenMode===a.FullScreenMode.EnteredCompletely&&(ht.current=-1)}))}),[st]),g((function(){if(Ie!==De.current.viewMode){var ee=ot.startPage,Te=ot.endPage,je=ot.virtualItems;un.markNotRendered(),un.setRange(ee,Te);for(var tt=function(Ve){var Ht=je.find((function(Dn){return Dn.index===Ve}));Ht&&un.setVisibility(Ve,Ht.visibility)},Ze=ee;Ze<=Te;Ze++)tt(Ze);Dr()}}),[pe]),g((function(){var ee=De.current.pageIndex;ee>-1&&Ie!==pe&&ot.scrollToItem(ee,si)}),[pe]),g((function(){var ee=De.current.pageIndex;ee>0&&ee===O&&zt.current===O&&Xt.current&&(zt.current=-1,$n(Xt.current))}),[ut]),i.useEffect((function(){ot.isSmoothScrolling||yt.current!==null&&yt.current===ut||(yt.current=ut,me({currentPage:ut,doc:R}))}),[ut,ot.isSmoothScrolling]),i.useEffect((function(){nt.fullScreenMode===a.FullScreenMode.Entering&&De.current.scrollMode===a.ScrollMode.Page&&(ct.current=De.current.pageIndex),nt.fullScreenMode===a.FullScreenMode.EnteredCompletely&&De.current.scrollMode===a.ScrollMode.Page&&F&&(ct.current=-1),nt.fullScreenMode===a.FullScreenMode.EnteredCompletely&&Xt.current&&(ht.current=De.current.pageIndex,$n(Xt.current))}),[nt.fullScreenMode]),i.useEffect((function(){if(nt.fullScreenMode!==a.FullScreenMode.Entering&&nt.fullScreenMode!==a.FullScreenMode.Exitting&&!ot.isSmoothScrolling){var ee=ot.startPage,Te=ot.endPage,je=ot.maxVisbilityIndex,tt=ot.virtualItems,Ze=je,Ve=nt.fullScreenMode===a.FullScreenMode.Entered||nt.fullScreenMode===a.FullScreenMode.EnteredCompletely;if(!(Ve&&Ze!==ct.current&&ct.current>-1||Ve&&Ze!==ht.current&&ht.current>-1)){Dt(Ze),Ln(c(c({},De.current),{pageIndex:Ze})),un.setRange(ee,Te);for(var Ht=function(Fr){var qi=tt.find((function(Fn){return Fn.index===Fr}));qi&&un.setVisibility(Fr,qi.visibility)},Dn=ee;Dn<=Te;Dn++)Ht(Dn);Dr()}}}),[ot.startPage,ot.endPage,ot.isSmoothScrolling,ot.maxVisbilityIndex,nt.fullScreenMode,Wt,Et,st]);var Dl=i.useCallback((function(ee){un.markRendered(ee),Dr()}),[yi]),Dr=function(){var ee=un.getHighestPriorityPage();ee>-1&&un.isInRange(ee)&&(un.markRendering(ee),Ui(ee))},Fl=function(ee){var Te=ut-1,je=ut+1;switch(ee){case"FirstPage":In(0);break;case"LastPage":In(ke-1);break;case"NextPage":je<ke&&In(je);break;case"PrevPage":Te>=0&&In(Te)}},Ol=i.useCallback((function(){var ee=ot.virtualItems,Te=[];switch(pe){case a.ViewMode.DualPage:Te=_t(ee,2);break;case a.ViewMode.DualPageWithCover:ee.length&&(Te=ee[0].index===0?[[ee[0]]].concat(_t(ee.slice(1),2)):_t(ee,2));break;case a.ViewMode.SinglePage:default:Te=_t(ee,1)}var je=Ue&&Ue.core?Ue.core.pageLabel:"Page {{pageIndex}}",tt={attrs:{className:"rpv-core__inner-container","data-testid":"core__inner-container",ref:Ye,style:{height:"100%"}},children:i.createElement(i.Fragment,null),subSlot:{attrs:{"data-testid":"core__inner-pages",className:p({"rpv-core__inner-pages":!0,"rpv-core__inner-pages--horizontal":fe===a.ScrollMode.Horizontal,"rpv-core__inner-pages--rtl":qe,"rpv-core__inner-pages--single":fe===a.ScrollMode.Page,"rpv-core__inner-pages--vertical":fe===a.ScrollMode.Vertical,"rpv-core__inner-pages--wrapped":fe===a.ScrollMode.Wrapped}),ref:et,style:{height:"100%",position:"relative"}},children:i.createElement("div",{"data-testid":"core__inner-current-page-".concat(ut),style:Object.assign({"--scale-factor":st},ot.getContainerStyles())},Te.map((function(Ze){return i.createElement("div",{className:p({"rpv-core__inner-page-container":!0,"rpv-core__inner-page-container--single":fe===a.ScrollMode.Page}),style:ot.getItemContainerStyles(Ze[0]),key:"".concat(Ze[0].index,"-").concat(pe)},Ze.map((function(Ve){var Ht=pe===a.ViewMode.DualPageWithCover&&(Ve.index===0||ke%2==0&&Ve.index===ke-1);return i.createElement("div",{"aria-label":je.replace("{{pageIndex}}","".concat(Ve.index+1)),className:p({"rpv-core__inner-page":!0,"rpv-core__inner-page--dual-even":pe===a.ViewMode.DualPage&&Ve.index%2==0,"rpv-core__inner-page--dual-odd":pe===a.ViewMode.DualPage&&Ve.index%2==1,"rpv-core__inner-page--dual-cover":Ht,"rpv-core__inner-page--dual-cover-even":pe===a.ViewMode.DualPageWithCover&&!Ht&&Ve.index%2==0,"rpv-core__inner-page--dual-cover-odd":pe===a.ViewMode.DualPageWithCover&&!Ht&&Ve.index%2==1,"rpv-core__inner-page--single":pe===a.ViewMode.SinglePage&&fe===a.ScrollMode.Page}),role:"region",key:"".concat(Ve.index,"-").concat(pe),style:Object.assign({},ot.getItemStyles(Ve),Us.buildPageStyles({numPages:ke,pageIndex:Ve.index,scrollMode:fe,viewMode:pe}))},i.createElement(tl,{doc:R,measureRef:Ve.measureRef,outlines:Ne,pageIndex:Ve.index,pageRotation:ye.has(Ve.index)?ye.get(Ve.index):0,pageSize:$[Ve.index],plugins:W,renderPage:Z,renderQueueKey:yi,rotation:Et,scale:st,shouldRender:ai===Ve.index,viewMode:pe,onExecuteNamedAction:Fl,onJumpFromLinkAnnotation:kl,onJumpToDest:qs,onRenderCompleted:Dl,onRotatePage:Tr}))})))})))}};return W.forEach((function(Ze){Ze.renderViewer&&(tt=Ze.renderViewer({containerRef:Ye,doc:R,pagesContainerRef:et,pagesRotation:ye,pageSizes:$,rotation:Et,slot:tt,themeContext:$e,jumpToPage:In,openFile:Xs,rotate:Ks,rotatePage:Tr,switchScrollMode:Ys,switchViewMode:Zs,zoom:$n}))})),tt}),[W,ot]),Qs=i.useCallback((function(ee){return i.createElement("div",c({},ee.attrs,{style:ee.attrs&&ee.attrs.style?ee.attrs.style:{}}),ee.children,ee.subSlot&&Qs(ee.subSlot))}),[]);return Qs(Ol())},Ws=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.3,1.5,1.7,1.9,2.1,2.4,2.7,3,3.3,3.7,4.1,4.6,5.1,5.7,6.3,7,7.7,8.5,9.4,10],vl=function(m){var w=m.defaultScale,P=m.doc,R=m.render,F=m.scrollMode,O=m.viewMode,G=i.useRef(),V=i.useState({pageSizes:[],scale:0}),I=V[0],$=V[1];return i.useLayoutEffect((function(){var W=Array(P.numPages).fill(0).map((function(Z,Y){return new Promise((function(K,se){rt(P,Y).then((function(ie){var ne=ie.getViewport({scale:1});K({pageHeight:ne.height,pageWidth:ne.width,rotation:ne.rotation})}))}))}));Promise.all(W).then((function(Z){var Y=G.current;if(Y&&Z.length!==0){var K=Z[0].pageWidth,se=Z[0].pageHeight,ie=Y.parentElement,ne=(ie.clientWidth-45)/K,Fe=(ie.clientHeight-45)/se,me=ne;switch(F){case a.ScrollMode.Horizontal:me=Math.min(ne,Fe);break;case a.ScrollMode.Vertical:default:me=ne}var ve,Se,ue=w?typeof w=="string"?Cr(ie,se,K,w,O,P.numPages):w:(ve=me,(Se=Ws.findIndex((function(ke){return ke>=ve})))===-1||Se===0?ve:Ws[Se-1]);$({pageSizes:Z,scale:ue})}}))}),[P.loadingTask.docId]),I.pageSizes.length===0||I.scale===0?i.createElement("div",{className:"rpv-core__page-size-calculator","data-testid":"core__page-size-calculating",ref:G},i.createElement(C,null)):R(I.pageSizes,I.scale)},Gi=function(){},kr=(function(m){function w(P,R){var F=m.call(this)||this;return F.verifyPassword=P,F.passwordStatus=R,F}return l(w,m),w})(Gi),bl=function(m){var w=m.passwordStatus,P=m.renderProtectedView,R=m.verifyPassword,F=m.onDocumentAskPassword,O=i.useContext(Q).l10n,G=i.useState(""),V=G[0],I=G[1],$=i.useContext(f).direction===a.TextDirection.RightToLeft,W=function(){return R(V)};return i.useEffect((function(){F&&F({verifyPassword:R})}),[]),P?P({passwordStatus:w,verifyPassword:R}):i.createElement("div",{className:"rpv-core__asking-password-wrapper"},i.createElement("div",{className:p({"rpv-core__asking-password":!0,"rpv-core__asking-password--rtl":$})},i.createElement("div",{className:"rpv-core__asking-password-message"},w===a.PasswordStatus.RequiredPassword&&O.core.askingPassword.requirePasswordToOpen,w===a.PasswordStatus.WrongPassword&&O.core.wrongPassword.tryAgain),i.createElement("div",{className:"rpv-core__asking-password-body"},i.createElement("div",{className:p({"rpv-core__asking-password-input":!0,"rpv-core__asking-password-input--ltr":!$,"rpv-core__asking-password-input--rtl":$})},i.createElement(E,{testId:"core__asking-password-input",type:"password",value:V,onChange:I,onKeyDown:function(Z){Z.key==="Enter"&&W()}})),i.createElement(_,{onClick:W},O.core.askingPassword.submit))))},$s=(function(m){function w(P){var R=m.call(this)||this;return R.doc=P,R}return l(w,m),w})(Gi),Gs=(function(m){function w(P){var R=m.call(this)||this;return R.error=P,R}return l(w,m),w})(Gi),xr=(function(m){function w(P){var R=m.call(this)||this;return R.percentages=P,R}return l(w,m),w})(Gi),_l=function(m){var w=m.characterMap,P=m.file,R=m.httpHeaders,F=m.render,O=m.renderError,G=m.renderLoader,V=m.renderProtectedView,I=m.transformGetDocumentParams,$=m.withCredentials,W=m.onDocumentAskPassword,Z=i.useContext(f).direction===a.TextDirection.RightToLeft,Y=i.useState(new xr(0)),K=Y[0],se=Y[1],ie=i.useRef(""),ne=D();return i.useEffect((function(){ie.current="",se(new xr(0));var Fe=new s.PDFWorker({name:"PDFWorker_".concat(Date.now())}),me=Object.assign({httpHeaders:R,withCredentials:$,worker:Fe},typeof P=="string"?{url:P}:{data:P},w?{cMapUrl:w.url,cMapPacked:w.isCompressed}:{}),ve=I?I(me):me,Se=s.getDocument(ve);return Se.onPassword=function(ue,ke){switch(ke){case s.PasswordResponses.NEED_PASSWORD:ne.current&&se(new kr(ue,a.PasswordStatus.RequiredPassword));break;case s.PasswordResponses.INCORRECT_PASSWORD:ne.current&&se(new kr(ue,a.PasswordStatus.WrongPassword))}},Se.onProgress=function(ue){var ke=ue.total>0?Math.min(100,100*ue.loaded/ue.total):100;ne.current&&ie.current===""&&se(new xr(ke))},Se.promise.then((function(ue){ie.current=ue.loadingTask.docId,ne.current&&se(new $s(ue))}),(function(ue){return ne.current&&!Fe.destroyed&&se(new Gs({message:ue.message||"Cannot load document",name:ue.name}))})),function(){Se.destroy(),Fe.destroy()}}),[P]),K instanceof kr?i.createElement(bl,{passwordStatus:K.passwordStatus,renderProtectedView:V,verifyPassword:K.verifyPassword,onDocumentAskPassword:W}):K instanceof $s?F(K.doc):K instanceof Gs?O?O(K.error):i.createElement("div",{className:p({"rpv-core__doc-error":!0,"rpv-core__doc-error--rtl":Z})},i.createElement("div",{className:"rpv-core__doc-error-text"},K.error.message)):i.createElement("div",{"data-testid":"core__doc-loading",className:p({"rpv-core__doc-loading":!0,"rpv-core__doc-loading--rtl":Z})},G?G(K.percentages):i.createElement(C,null))},wl=function(m,w){var P=i.useMemo((function(){return m==="auto"?typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":m}),[]),R=i.useState(P),F=R[0],O=R[1],G=M(F);return i.useEffect((function(){if(m==="auto"){var V=window.matchMedia("(prefers-color-scheme: dark)"),I=function($){O($.matches?"dark":"light")};return V.addEventListener("change",I),function(){return V.removeEventListener("change",I)}}}),[]),i.useEffect((function(){F!==G&&w&&w(F)}),[F]),i.useEffect((function(){m!==F&&O(m)}),[m]),{currentTheme:F,setCurrentTheme:O}},yl=function(m){return{startPage:m.startPage-3,endPage:m.endPage+3}};a.Button=function(m){var w=m.children,P=m.testId,R=m.onClick,F=i.useContext(f).direction===a.TextDirection.RightToLeft,O=P?{"data-testid":P}:{};return i.createElement("button",c({className:p({"rpv-core__button":!0,"rpv-core__button--rtl":F}),type:"button",onClick:R},O),w)},a.Icon=v,a.LazyRender=function(m){var w=m.attrs,P=m.children,R=m.testId,F=i.useState(!1),O=F[0],G=F[1],V=R?c(c({},w),{"data-testid":R}):w,I=h({once:!0,onVisibilityChanged:function($){$.isVisible&&G(!0)}});return i.createElement("div",c({ref:I},V),O&&P)},a.LocalizationContext=Q,a.Menu=function(m){var w=m.children,P=i.useRef(),R=i.useRef([]),F=i.useContext(f).direction===a.TextDirection.RightToLeft,O=function(V){if(P.current)switch(V.key){case"Tab":V.preventDefault();break;case"ArrowDown":V.preventDefault(),G((function(I,$){return $+1}));break;case"ArrowUp":V.preventDefault(),G((function(I,$){return $-1}));break;case"End":V.preventDefault(),G((function(I,$){return I.length-1}));break;case"Home":V.preventDefault(),G((function(I,$){return 0}))}},G=function(V){if(P.current){var I=R.current,$=I.findIndex((function(Z){return Z.getAttribute("tabindex")==="0"})),W=Math.min(I.length-1,Math.max(0,V(I,$)));$>=0&&$<=I.length-1&&I[$].setAttribute("tabindex","-1"),I[W].setAttribute("tabindex","0"),I[W].focus()}};return g((function(){var V=P.current;if(V){var I=(function($){var W=[];return $.querySelectorAll('.rpv-core__menu-item[role="menuitem"]').forEach((function(Z){if(Z instanceof HTMLElement){var Y=Z.parentElement;(Y===$||window.getComputedStyle(Y).display!=="none")&&W.push(Z)}})),W})(V);R.current=I}}),[]),g((function(){return document.addEventListener("keydown",O),function(){document.removeEventListener("keydown",O)}}),[]),i.createElement("div",{ref:P,"aria-orientation":"vertical",className:p({"rpv-core__menu":!0,"rpv-core__menu--rtl":F}),role:"menu",tabIndex:0},w)},a.MenuDivider=function(){return i.createElement("div",{"aria-orientation":"horizontal",className:"rpv-core__menu-divider",role:"separator"})},a.MenuItem=function(m){var w=m.checked,P=w!==void 0&&w,R=m.children,F=m.icon,O=F===void 0?null:F,G=m.isDisabled,V=G!==void 0&&G,I=m.testId,$=m.onClick,W=i.useContext(f).direction===a.TextDirection.RightToLeft,Z=I?{"data-testid":I}:{};return i.createElement("button",c({className:p({"rpv-core__menu-item":!0,"rpv-core__menu-item--disabled":V,"rpv-core__menu-item--ltr":!W,"rpv-core__menu-item--rtl":W}),role:"menuitem",tabIndex:-1,type:"button",onClick:$},Z),i.createElement("div",{className:p({"rpv-core__menu-item-icon":!0,"rpv-core__menu-item-icon--ltr":!W,"rpv-core__menu-item-icon--rtl":W})},O),i.createElement("div",{className:p({"rpv-core__menu-item-label":!0,"rpv-core__menu-item-label--ltr":!W,"rpv-core__menu-item-label--rtl":W})},R),i.createElement("div",{className:p({"rpv-core__menu-item-check":!0,"rpv-core__menu-item-check--ltr":!W,"rpv-core__menu-item-check--rtl":W})},P&&i.createElement(b,null)))},a.MinimalButton=function(m){var w=m.ariaLabel,P=w===void 0?"":w,R=m.ariaKeyShortcuts,F=R===void 0?"":R,O=m.children,G=m.isDisabled,V=G!==void 0&&G,I=m.isSelected,$=I!==void 0&&I,W=m.testId,Z=m.onClick,Y=i.useContext(f).direction===a.TextDirection.RightToLeft,K=W?{"data-testid":W}:{};return i.createElement("button",c({"aria-label":P},F&&{"aria-keyshortcuts":F},V&&{"aria-disabled":!0},{className:p({"rpv-core__minimal-button":!0,"rpv-core__minimal-button--disabled":V,"rpv-core__minimal-button--rtl":Y,"rpv-core__minimal-button--selected":$}),type:"button",onClick:Z},K),O)},a.Modal=function(m){var w=m.ariaControlsSuffix,P=m.closeOnClickOutside,R=m.closeOnEscape,F=m.content,O=m.isOpened,G=O!==void 0&&O,V=m.target,I=w||"".concat(q());return i.createElement(it,{target:V?function($,W){return i.createElement("div",{"aria-expanded":W?"true":"false","aria-haspopup":"dialog","aria-controls":"rpv-core__modal-body-".concat(I)},V($,W))}:null,content:function($){return i.createElement(te,null,i.createElement(Ae,{ariaControlsSuffix:I,closeOnClickOutside:P,closeOnEscape:R,onToggle:$},F($)))},isOpened:G})},a.Popover=function(m){var w=m.ariaHasPopup,P=w===void 0?"dialog":w,R=m.ariaControlsSuffix,F=m.closeOnClickOutside,O=m.closeOnEscape,G=m.content,V=m.lockScroll,I=V===void 0||V,$=m.offset,W=m.position,Z=m.target,Y=Be(!1),K=Y.opened,se=Y.toggle,ie=i.useRef(),ne=i.useMemo((function(){return R||"".concat(q())}),[]);return i.createElement("div",{ref:ie,"aria-expanded":K?"true":"false","aria-haspopup":P,"aria-controls":"rpv-core__popver-body-".concat(ne)},Z(se,K),K&&i.createElement(i.Fragment,null,I&&i.createElement(_e,{closeOnEscape:O,onClose:se}),i.createElement(Ce,{ariaControlsSuffix:ne,closeOnClickOutside:F,offset:$,position:W,targetRef:ie,onClose:se},G(se))))},a.PrimaryButton=_,a.ProgressBar=function(m){var w=m.progress,P=i.useContext(f).direction===a.TextDirection.RightToLeft;return i.createElement("div",{className:p({"rpv-core__progress-bar":!0,"rpv-core__progress-bar--rtl":P})},i.createElement("div",{className:"rpv-core__progress-bar-progress",style:{width:"".concat(w,"%")}},w,"%"))},a.Separator=function(){return i.createElement("div",{className:"rpv-core__separator"})},a.Spinner=C,a.Splitter=function(m){var w=m.constrain,P=i.useContext(f).direction===a.TextDirection.RightToLeft,R=i.useRef(),F=i.useRef(),O=i.useRef(),G=i.useRef(0),V=i.useRef(0),I=i.useRef(0),$=i.useRef(0),W={capture:!0},Z=function(K){var se=R.current,ie=F.current,ne=O.current;if(se&&ie&&ne){var Fe=$.current,me=K.clientX-G.current,ve=I.current+(P?-me:me),Se=se.parentElement.getBoundingClientRect().width,ue=100*ve/Se;if(se.classList.add("rpv-core__splitter--resizing"),w){var ke=Se-ve-Fe;if(!w({firstHalfPercentage:ue,firstHalfSize:ve,secondHalfPercentage:100*ke/Se,secondHalfSize:ke}))return}ie.style.width="".concat(ue,"%"),document.body.classList.add("rpv-core__splitter-body--resizing"),ie.classList.add("rpv-core__splitter-sibling--resizing"),ne.classList.add("rpv-core__splitter-sibling--resizing")}},Y=function(K){var se=R.current,ie=F.current,ne=O.current;se&&ie&&ne&&(document.body.classList.remove("rpv-core__splitter-body--resizing"),se.classList.remove("rpv-core__splitter--resizing"),ie.classList.remove("rpv-core__splitter-sibling--resizing"),ne.classList.remove("rpv-core__splitter-sibling--resizing"),document.removeEventListener("mousemove",Z,W),document.removeEventListener("mouseup",Y,W))};return i.useEffect((function(){var K=R.current;K&&($.current=K.getBoundingClientRect().width,F.current=K.previousElementSibling,O.current=K.nextElementSibling)}),[]),i.createElement("div",{ref:R,className:"rpv-core__splitter",onMouseDown:function(K){var se=F.current;se&&(G.current=K.clientX,V.current=K.clientY,I.current=se.getBoundingClientRect().width,document.addEventListener("mousemove",Z,W),document.addEventListener("mouseup",Y,W))}})},a.TextBox=E,a.ThemeContext=f,a.Tooltip=function(m){var w=m.ariaControlsSuffix,P=m.content,R=m.offset,F=m.position,O=m.target,G=Be(!1),V=G.opened,I=G.toggle,$=i.useRef(),W=i.useRef(),Z=i.useMemo((function(){return w||"".concat(q())}),[]);oe((function(){$.current&&document.activeElement&&$.current.contains(document.activeElement)&&K()}));var Y=function(){I(a.ToggleStatus.Open)},K=function(){I(a.ToggleStatus.Close)};return i.createElement(i.Fragment,null,i.createElement("div",{ref:$,"aria-describedby":"rpv-core__tooltip-body-".concat(Z),onBlur:function(se){se.relatedTarget instanceof HTMLElement&&se.currentTarget.parentElement&&se.currentTarget.parentElement.contains(se.relatedTarget)?W.current&&(W.current.style.display="none"):K()},onFocus:Y,onMouseEnter:Y,onMouseLeave:K},O),V&&i.createElement(Qe,{ariaControlsSuffix:Z,contentRef:W,offset:R,position:F,targetRef:$},P()))},a.Viewer=function(m){var w=m.characterMap,P=m.defaultScale,R=m.enableSmoothScroll,F=R===void 0||R,O=m.fileUrl,G=m.httpHeaders,V=G===void 0?{}:G,I=m.initialPage,$=I===void 0?0:I,W=m.pageLayout,Z=m.initialRotation,Y=Z===void 0?0:Z,K=m.localization,se=m.plugins,ie=se===void 0?[]:se,ne=m.renderError,Fe=m.renderLoader,me=m.renderPage,ve=m.renderProtectedView,Se=m.scrollMode,ue=Se===void 0?a.ScrollMode.Vertical:Se,ke=m.setRenderRange,we=ke===void 0?yl:ke,Ue=m.transformGetDocumentParams,$e=m.theme,qe=$e===void 0?{direction:a.TextDirection.LeftToRight,theme:"light"}:$e,Ye=m.viewMode,et=Ye===void 0?a.ViewMode.SinglePage:Ye,Mt=m.withCredentials,ut=Mt!==void 0&&Mt,Dt=m.onDocumentAskPassword,yt=m.onDocumentLoad,kt=yt===void 0?function(){}:yt,xt=m.onPageChange,Et=xt===void 0?function(){}:xt,Zt=m.onRotate,En=Zt===void 0?function(){}:Zt,vn=m.onRotatePage,Wt=vn===void 0?function(){}:vn,sn=m.onSwitchTheme,kn=sn===void 0?function(){}:sn,ye=m.onZoom,be=ye===void 0?function(){}:ye,he=i.useState({data:O,name:typeof O=="string"?O:"",shouldLoad:!1}),fe=he[0],de=he[1],xe=function(ct,ht){de({data:ht,name:ct,shouldLoad:!0})},Me=i.useState(!1),pe=Me[0],ae=Me[1],Ie=M(fe);i.useEffect((function(){var ct,ht,zt,nt;ct=Ie.data,nt=typeof(ht=O),(zt=typeof ct)=="string"&&nt==="string"&&ct===ht||zt==="object"&&nt==="object"&&ct.length===ht.length&&ct.every((function(Rn,ai){return Rn===ht[ai]}))||de({data:O,name:typeof O=="string"?O:"",shouldLoad:pe})}),[O,pe]);var Ne=h({onVisibilityChanged:function(ct){ae(ct.isVisible),ct.isVisible&&de((function(ht){return Object.assign({},ht,{shouldLoad:!0})}))}}),lt=typeof qe=="string"?{direction:a.TextDirection.LeftToRight,theme:qe}:qe,st=i.useState(K||J),qt=st[0],cn=st[1],De={l10n:qt,setL10n:cn},Xt=Object.assign({},{direction:lt.direction},wl(lt.theme||"light",kn));return i.useEffect((function(){K&&cn(K)}),[K]),i.createElement(Q.Provider,{value:De},i.createElement(f.Provider,{value:Xt},i.createElement("div",{ref:Ne,className:"rpv-core__viewer rpv-core__viewer--".concat(Xt.currentTheme),"data-testid":"core__viewer",style:{height:"100%",width:"100%"}},fe.shouldLoad&&i.createElement(_l,{characterMap:w,file:fe.data,httpHeaders:V,render:function(ct){return i.createElement(vl,{defaultScale:P,doc:ct,render:function(ht,zt){return i.createElement(ml,{currentFile:{data:fe.data,name:fe.name},defaultScale:P,doc:ct,enableSmoothScroll:F,initialPage:$,initialRotation:Y,initialScale:zt,pageLayout:W,pageSizes:ht,plugins:ie,renderPage:me,scrollMode:ue,setRenderRange:we,viewMode:et,viewerState:{file:fe,fullScreenMode:a.FullScreenMode.Normal,pageIndex:-1,pageHeight:ht[0].pageHeight,pageWidth:ht[0].pageWidth,pagesRotation:new Map,rotation:Y,scale:zt,scrollMode:ue,viewMode:et},onDocumentLoad:kt,onOpenFile:xe,onPageChange:Et,onRotate:En,onRotatePage:Wt,onZoom:be})},scrollMode:ue,viewMode:et})},renderError:ne,renderLoader:Fe,renderProtectedView:ve,transformGetDocumentParams:Ue,withCredentials:ut,onDocumentAskPassword:Dt}))))},a.Worker=function(m){var w=m.children,P=m.workerUrl;return s.GlobalWorkerOptions.workerSrc=P,i.createElement(i.Fragment,null,w)},a.chunk=_t,a.classNames=p,a.createStore=function(m){var w=m||{},P={},R=function(O,G){var V;w=c(c({},w),((V={})[O]=G,V)),(P[O]||[]).forEach((function(I){return I(w[O])}))},F=function(O){return w[O]};return{subscribe:function(O,G){P[O]=(P[O]||[]).concat(G)},unsubscribe:function(O,G){P[O]=(P[O]||[]).filter((function(V){return V!==G}))},update:function(O,G){R(O,G)},updateCurrentValue:function(O,G){var V=F(O);V!==void 0&&R(O,G(V))},get:function(O){return F(O)}}},a.getDestination=fn,a.getPage=rt,a.isFullScreenEnabled=y,a.isMac=function(){return typeof window<"u"&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)},a.useDebounceCallback=N,a.useIntersectionObserver=h,a.useIsMounted=D,a.useIsomorphicLayoutEffect=g,a.usePrevious=M,a.useRenderQueue=U})(zr)),zr}var Aa;function Yt(){if(Aa)return Br.exports;Aa=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return Br.exports=Bh(),Br.exports}var Ca=Yt(),qr={exports:{}},Gn={},Xr={exports:{}},Kr={},Pa;function zh(){if(Pa)return Kr;Pa=1;var a=Yt();function e(s){var o=Object.create(null);return s&&Object.keys(s).forEach((function(l){if(l!=="default"){var u=Object.getOwnPropertyDescriptor(s,l);Object.defineProperty(o,l,u.get?u:{enumerable:!0,get:function(){return s[l]}})}})),o.default=s,Object.freeze(o)}var t=e(Kt()),n=function(s){var o=s.files,l=t.useRef(),u=t.useContext(a.LocalizationContext).l10n,c=t.useContext(a.ThemeContext).direction===a.TextDirection.RightToLeft,d=t.useRef([]),f=u&&u.attachment?u.attachment.clickToDownload:"Click to download",p=function(g){var h=l.current,v=[].slice.call(h.getElementsByClassName("rpv-attachment__item"));if(v.length!==0){v.forEach((function(C){return C.setAttribute("tabindex","-1")}));var b=document.activeElement,_=v[Math.min(v.length-1,Math.max(0,g(v,b)))];_.setAttribute("tabindex","0"),_.focus()}};return a.useIsomorphicLayoutEffect((function(){var g=l.current;if(g){var h=[].slice.call(g.getElementsByClassName("rpv-attachment__item"));if(d.current=h,h.length>0){var v=h[0];v.focus(),v.setAttribute("tabindex","0")}}}),[]),t.createElement("div",{"data-testid":"attachment__list",className:a.classNames({"rpv-attachment__list":!0,"rpv-attachment__list--rtl":c}),ref:l,tabIndex:-1,onKeyDown:function(g){switch(g.key){case"ArrowDown":g.preventDefault(),p((function(h,v){return h.indexOf(v)+1}));break;case"ArrowUp":g.preventDefault(),p((function(h,v){return h.indexOf(v)-1}));break;case"End":g.preventDefault(),p((function(h,v){return h.length-1}));break;case"Home":g.preventDefault(),p((function(h,v){return 0}))}}},o.map((function(g){return t.createElement("button",{className:"rpv-attachment__item",key:g.fileName,tabIndex:-1,title:f,type:"button",onClick:function(){return h=g.fileName,v=g.data,b=typeof v=="string"?"":URL.createObjectURL(new Blob([v],{type:""})),(_=document.createElement("a")).style.display="none",_.href=b||h,_.setAttribute("download",(function(C){var E=C.split("/").pop();return E?E.split("#")[0].split("?")[0]:C})(h)),document.body.appendChild(_),_.click(),document.body.removeChild(_),void(b&&URL.revokeObjectURL(b));var h,v,b,_}},g.fileName)})))},r=function(s){var o=s.doc,l=t.useContext(a.LocalizationContext).l10n,u=t.useContext(a.ThemeContext).direction===a.TextDirection.RightToLeft,c=l&&l.attachment?l.attachment.noAttachment:"There is no attachment",d=t.useState({files:[],isLoaded:!1}),f=d[0],p=d[1];return t.useEffect((function(){o.getAttachments().then((function(g){var h=g?Object.keys(g).map((function(v){return{data:g[v].content,fileName:g[v].filename}})):[];p({files:h,isLoaded:!0})}))}),[o]),f.isLoaded?f.files.length===0?t.createElement("div",{"data-testid":"attachment__empty",className:a.classNames({"rpv-attachment__empty":!0,"rpv-attachment__empty--rtl":u})},c):t.createElement(n,{files:f.files}):t.createElement(a.Spinner,null)},i=function(s){var o=s.store,l=t.useState(o.get("doc")),u=l[0],c=l[1],d=function(f){c(f)};return t.useEffect((function(){return o.subscribe("doc",d),function(){o.unsubscribe("doc",d)}}),[]),u?t.createElement(r,{doc:u}):t.createElement("div",{className:"rpv-attachment__loader"},t.createElement(a.Spinner,null))};return Kr.attachmentPlugin=function(){var s=t.useMemo((function(){return a.createStore({})}),[]);return{onDocumentLoad:function(o){s.update("doc",o.doc)},Attachments:function(){return t.createElement(i,{store:s})}}},Kr}var ka;function Hh(){if(ka)return Xr.exports;ka=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return Xr.exports=zh(),Xr.exports}var Yr={exports:{}},ki={},xa;function jh(){if(xa)return ki;xa=1;var a=Yt();function e(f){var p=Object.create(null);return f&&Object.keys(f).forEach((function(g){if(g!=="default"){var h=Object.getOwnPropertyDescriptor(f,g);Object.defineProperty(p,g,h.get?h:{enumerable:!0,get:function(){return f[g]}})}})),p.default=f,Object.freeze(p)}var t,n=e(Kt()),r=function(){return r=Object.assign||function(f){for(var p,g=1,h=arguments.length;g<h;g++)for(var v in p=arguments[g])Object.prototype.hasOwnProperty.call(p,v)&&(f[v]=p[v]);return f},r.apply(this,arguments)},i=function(){return n.createElement(a.Icon,{size:16},n.createElement("path",{d:"M6.427,8.245A.5.5,0,0,1,6.862,7.5H17.138a.5.5,0,0,1,.435.749l-5.139,9a.5.5,0,0,1-.868,0Z"}))},s=function(){return n.createElement(a.Icon,{size:16},n.createElement("path",{d:"M9.248,17.572a.5.5,0,0,1-.748-.434V6.862a.5.5,0,0,1,.748-.434l8.992,5.138a.5.5,0,0,1,0,.868Z"}))},o=function(f){var p=f.bookmark,g=f.depth,h=f.doc,v=f.index,b=f.isBookmarkExpanded,_=f.numberOfSiblings,C=f.pathFromRoot,E=f.renderBookmarkItem,k=f.store,H=C?"".concat(C,".").concat(v):"".concat(v),T=n.useMemo((function(){return(function(Q){var X=Q.count,q=Q.items;if(X>=0)return!1;var re=q.length;if(re===0)return!1;for(var oe=q.concat([]);oe.length>0;){var Ae=oe.shift(),te=Ae.items;Ae.count&&te&&Ae.count>0&&te.length>0&&(re+=te.length,oe=oe.concat(te))}return Math.abs(X)===re})(p)}),[p]),A=k.get("bookmarkExpandedMap"),B=b?b({bookmark:p,doc:h,depth:g,index:v}):A.has(H)?A.get(H):!T,z=n.useState(B),y=z[0],S=z[1],L=p.items&&p.items.length>0,N=function(){var Q=!y;k.updateCurrentValue("bookmarkExpandedMap",(function(X){return X.set(H,Q)})),S(Q)},D=function(){var Q=p.dest,X=k.get("jumpToDestination");a.getDestination(h,Q).then((function(q){X&&X(r({label:p.title},q))}))},M=function(){L&&p.dest&&D()},x=function(){!L&&p.dest&&D()},j=function(Q,X){return n.createElement("div",{className:"rpv-bookmark__item",style:{paddingLeft:"".concat(1.25*g,"rem")},onClick:Q},X)},U=function(Q,X){return L?n.createElement("span",{className:"rpv-bookmark__toggle","data-testid":"bookmark__toggle-".concat(g,"-").concat(v),onClick:N},y?Q:X):n.createElement("span",{className:"rpv-bookmark__toggle"})},J=function(Q){return p.url?n.createElement("a",{className:"rpv-bookmark__title",href:p.url,rel:"noopener noreferrer nofollow",target:p.newWindow?"_blank":""},p.title):n.createElement("div",{className:"rpv-bookmark__title","aria-label":p.title,onClick:Q},p.title)};return n.createElement("li",{"aria-expanded":y?"true":"false","aria-label":p.title,"aria-level":g+1,"aria-posinset":v+1,"aria-setsize":_,role:"treeitem",tabIndex:-1},E?E({bookmark:p,depth:g,hasSubItems:L,index:v,isExpanded:y,path:H,defaultRenderItem:j,defaultRenderTitle:J,defaultRenderToggle:U,onClickItem:x,onClickTitle:M,onToggleSubItems:N}):j(x,n.createElement(n.Fragment,null,U(n.createElement(i,null),n.createElement(s,null)),J(M))),L&&y&&n.createElement(l,{bookmarks:p.items,depth:g+1,doc:h,isBookmarkExpanded:b,isRoot:!1,pathFromRoot:H,renderBookmarkItem:E,store:k}))},l=function(f){var p=f.bookmarks,g=f.depth,h=g===void 0?0:g,v=f.doc,b=f.isBookmarkExpanded,_=f.isRoot,C=f.pathFromRoot,E=f.renderBookmarkItem,k=f.store;return n.createElement("ul",{className:"rpv-bookmark__list",role:_?"tree":"group",tabIndex:-1},p.map((function(H,T){return n.createElement(o,{bookmark:H,depth:h,doc:v,index:T,isBookmarkExpanded:b,key:T,numberOfSiblings:p.length,pathFromRoot:C,renderBookmarkItem:E,store:k})})))};(function(f){f[f.Collapse=0]="Collapse",f[f.Expand=1]="Expand"})(t||(t={}));var u=function(f){var p=f.bookmarks,g=f.doc,h=f.isBookmarkExpanded,v=f.renderBookmarkItem,b=f.store,_=n.useRef(),C=function(T){var A=_.current;if(A&&T.target instanceof HTMLElement&&A.contains(T.target))switch(T.key){case"ArrowDown":T.preventDefault(),k((function(B,z){return B.indexOf(z)+1}));break;case"ArrowLeft":T.preventDefault(),H(t.Collapse);break;case"ArrowRight":T.preventDefault(),H(t.Expand);break;case"ArrowUp":T.preventDefault,k((function(B,z){return B.indexOf(z)-1}));break;case"End":T.preventDefault(),k((function(B,z){return B.length-1}));break;case" ":case"Enter":case"Space":T.preventDefault(),E();break;case"Home":T.preventDefault(),k((function(B,z){return 0}))}},E=function(){var T=document.activeElement.closest(".rpv-bookmark__item").querySelector(".rpv-bookmark__title");T&&T.click()},k=function(T){var A=_.current,B=[].slice.call(A.getElementsByClassName("rpv-bookmark__item"));if(B.length!==0){var z=document.activeElement,y=B[Math.min(B.length-1,Math.max(0,T(B,z)))];z.setAttribute("tabindex","-1"),y.setAttribute("tabindex","0"),y.focus()}},H=function(T){var A=_.current;if([].slice.call(A.getElementsByClassName("rpv-bookmark__item")).length!==0){var B=document.activeElement.closest(".rpv-bookmark__item"),z=T===t.Collapse?"true":"false";if(B&&B.parentElement.getAttribute("aria-expanded")===z){var y=B.querySelector(".rpv-bookmark__toggle");y&&y.click()}}};return n.useEffect((function(){return document.addEventListener("keydown",C),function(){document.removeEventListener("keydown",C)}}),[]),n.useEffect((function(){var T=_.current;if(T){var A=[].slice.call(T.getElementsByClassName("rpv-bookmark__item"));A.length>0&&(A[0].focus(),A[0].setAttribute("tabindex","0"))}}),[]),n.createElement("div",{ref:_},n.createElement(l,{bookmarks:p,depth:0,doc:g,isBookmarkExpanded:h,isRoot:!0,pathFromRoot:"",renderBookmarkItem:v,store:b}))},c=function(f){var p=f.doc,g=f.isBookmarkExpanded,h=f.renderBookmarkItem,v=f.store,b=n.useContext(a.LocalizationContext).l10n,_=n.useContext(a.ThemeContext).direction===a.TextDirection.RightToLeft,C=n.useState({isLoaded:!1,items:[]}),E=C[0],k=C[1];return n.useEffect((function(){k({isLoaded:!1,items:[]}),p.getOutline().then((function(H){k({isLoaded:!0,items:H||[]})}))}),[p]),E.isLoaded?E.items.length===0?n.createElement("div",{"data-testid":"bookmark__empty",className:a.classNames({"rpv-bookmark__empty":!0,"rpv-bookmark__empty--rtl":_})},b&&b.bookmark?b.bookmark.noBookmark:"There is no bookmark"):n.createElement("div",{"data-testid":"bookmark__container",className:a.classNames({"rpv-bookmark__container":!0,"rpv-bookmark__container--rtl":_})},n.createElement(u,{bookmarks:E.items,doc:p,isBookmarkExpanded:g,renderBookmarkItem:h,store:v})):n.createElement("div",{className:"rpv-bookmark__loader"},n.createElement(a.Spinner,null))},d=function(f){var p=f.isBookmarkExpanded,g=f.renderBookmarkItem,h=f.store,v=n.useState(h.get("doc")),b=v[0],_=v[1],C=function(E){_(E)};return n.useEffect((function(){return h.subscribe("doc",C),function(){h.unsubscribe("doc",C)}}),[]),b?n.createElement(c,{doc:b,isBookmarkExpanded:p,renderBookmarkItem:g,store:h}):n.createElement("div",{className:"rpv-bookmark__loader"},n.createElement(a.Spinner,null))};return ki.DownArrowIcon=i,ki.RightArrowIcon=s,ki.bookmarkPlugin=function(){var f=n.useMemo((function(){return a.createStore({bookmarkExpandedMap:new Map})}),[]);return{install:function(p){f.update("jumpToDestination",p.jumpToDestination)},onDocumentLoad:function(p){f.update("doc",p.doc)},Bookmarks:function(p){return n.createElement(d,{isBookmarkExpanded:p?.isBookmarkExpanded,renderBookmarkItem:p?.renderBookmarkItem,store:f})}}},ki}var Ma;function Vh(){if(Ma)return Yr.exports;Ma=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return Yr.exports=jh(),Yr.exports}var Zr={exports:{}},Jr={},Ta;function Wh(){return Ta||(Ta=1,(function(a){var e=Yt();function t(h){var v=Object.create(null);return h&&Object.keys(h).forEach((function(b){if(b!=="default"){var _=Object.getOwnPropertyDescriptor(h,b);Object.defineProperty(v,b,_.get?_:{enumerable:!0,get:function(){return h[b]}})}})),v.default=h,Object.freeze(v)}var n,r=t(Kt());a.ThumbnailDirection=void 0,(n=a.ThumbnailDirection||(a.ThumbnailDirection={})).Horizontal="Horizontal",n.Vertical="Vertical";var i=function(){return i=Object.assign||function(h){for(var v,b=1,_=arguments.length;b<_;b++)for(var C in v=arguments[b])Object.prototype.hasOwnProperty.call(v,C)&&(h[C]=v[C]);return h},i.apply(this,arguments)},s=function(h){var v=h.doc,b=h.getPageIndex,_=h.renderSpinner,C=h.store,E=h.width,k=v.numPages,H=b?b({numPages:k}):0,T=Math.max(0,Math.min(H,k-1)),A=C.get("pagesRotation")||new Map,B=A.has(T)?A.get(T):0,z=r.useState(""),y=z[0],S=z[1],L=e.useIsMounted(),N=r.useRef(),D=r.useState(C.get("rotation")||0),M=D[0],x=D[1],j=r.useState(B),U=j[0],J=j[1],Q=r.useState(!1),X=Q[0],q=Q[1],re=function(te){var Pe=te.has(T)?te.get(T):0;J(Pe)},oe=function(te){x(te)},Ae=e.useIntersectionObserver({onVisibilityChanged:function(te){q(te.isVisible)}});return r.useEffect((function(){if(X){var te=Ae.current;te&&(S(""),e.getPage(v,T).then((function(Pe){var Be=Pe.getViewport({scale:1}),it=(Be.rotation+M+U)%360,ft=Math.abs(M+U)%180==0,Je=ft?Be.width:Be.height,pt=ft?Be.height:Be.width,mt=document.createElement("canvas"),Ut=mt.getContext("2d",{alpha:!1}),Tt=te.clientWidth,bt=te.clientHeight,le=E?E/Je:Math.min(Tt/Je,bt/pt),ce=le*Je,Ke=le*pt;mt.height=Ke,mt.width=ce,mt.style.opacity="0";var Ce=Pe.getViewport({rotation:it,scale:le});N.current=Pe.render({canvasContext:Ut,viewport:Ce}),N.current.promise.then((function(){L.current&&S(mt.toDataURL()),mt.width=0,mt.height=0}),(function(){}))})))}}),[U,X]),r.useEffect((function(){return C.subscribe("pagesRotation",re),C.subscribe("rotation",oe),function(){C.unsubscribe("pagesRotation",re),C.unsubscribe("rotation",oe)}}),[]),r.useEffect((function(){return function(){var te;(te=N.current)===null||te===void 0||te.cancel()}}),[]),r.createElement("div",{ref:Ae,className:"rpv-thumbnail__cover-inner","data-testid":"thumbnail__cover-inner"},y?r.createElement("img",{className:"rpv-thumbnail__cover-image","data-testid":"thumbnail__cover-image",src:y}):r.createElement("div",{className:"rpv-thumbnail__cover-loader","data-testid":"thumbnail__cover-loader"},_?_():r.createElement(e.Spinner,null)))},o=function(h){var v=h.getPageIndex,b=h.renderSpinner,_=h.store,C=h.width,E=r.useState(_.get("doc")),k=E[0],H=E[1],T=function(A){H(A)};return r.useEffect((function(){return _.subscribe("doc",T),function(){_.unsubscribe("doc",T)}}),[]),r.createElement("div",{className:"rpv-thumbnail__cover"},k?r.createElement(s,{doc:k,getPageIndex:v,renderSpinner:b,store:_,width:C}):r.createElement("div",{className:"rpv-thumbnail__cover-loader"},b?b():r.createElement(e.Spinner,null)))},l=function(){return r.createElement(e.Spinner,null)},u=r.createContext({renderSpinner:l}),c=function(h){var v=h.children,b=h.doc,_=e.useIsMounted(),C=r.useState({loading:!0,labels:[]}),E=C[0],k=C[1];return r.useEffect((function(){b.getPageLabels().then((function(H){_.current&&k({loading:!1,labels:H||[]})}))}),[b.loadingTask.docId]),E.loading?r.createElement(r.Fragment,null):v(E.labels)},d=function(h){var v=h.page,b=h.pageHeight,_=h.pageIndex,C=h.pageWidth,E=h.rotation,k=h.thumbnailHeight,H=h.thumbnailWidth,T=h.onRenderCompleted,A=r.useContext(e.LocalizationContext).l10n,B=r.useRef(),z=r.useState(""),y=z[0],S=z[1],L=A&&A.thumbnail?A.thumbnail.thumbnailLabel:"Thumbnail of page {{pageIndex}}";return r.useEffect((function(){var N=B.current;N&&N.cancel();var D=document.createElement("canvas"),M=D.getContext("2d",{alpha:!1}),x=H,j=x/(C/b),U=x/C;D.height=j,D.width=x,D.style.height="".concat(j,"px"),D.style.width="".concat(x,"px");var J=v.getViewport({rotation:E,scale:U});return B.current=v.render({canvasContext:M,viewport:J}),B.current.promise.then((function(){S(D.toDataURL()),T(_)}),(function(){T(_)})),function(){var Q;(Q=B.current)===null||Q===void 0||Q.cancel()}}),[E]),y?r.createElement("img",{"aria-label":L.replace("{{pageIndex}}","".concat(_+1)),src:y,height:"".concat(k,"px"),width:"".concat(H,"px")}):r.useContext(u).renderSpinner()},f=function(h){var v=h.doc,b=h.pageHeight,_=h.pageIndex,C=h.pageRotation,E=h.pageWidth,k=h.rotation,H=h.shouldRender,T=h.thumbnailWidth,A=h.onRenderCompleted,B=h.onVisibilityChanged,z=e.useIsMounted(),y=r.useState({height:b,page:null,viewportRotation:0,width:E}),S=y[0],L=y[1],N=S.page,D=S.height,M=S.width,x=M/D,j=Math.abs(k+C)%180==0,U=j?T:T/x,J=j?T/x:T;r.useEffect((function(){H&&e.getPage(v,_).then((function(q){var re=q.getViewport({scale:1});z.current&&L({height:re.height,page:q,viewportRotation:re.rotation,width:re.width})}))}),[H]);var Q=(S.viewportRotation+k+C)%360,X=e.useIntersectionObserver({onVisibilityChanged:function(q){B(_,q)}});return r.createElement("div",{className:"rpv-thumbnail__container","data-testid":"thumbnail__container-".concat(_),ref:X,style:{height:"".concat(J,"px"),width:"".concat(U,"px")}},N?r.createElement(d,{page:N,pageHeight:j?D:M,pageIndex:_,pageWidth:j?M:D,rotation:Q,thumbnailHeight:J,thumbnailWidth:U,onRenderCompleted:A}):r.useContext(u).renderSpinner())},p=function(h){var v=h.currentPage,b=h.doc,_=h.labels,C=h.pagesRotation,E=h.pageHeight,k=h.pageWidth,H=h.renderCurrentPageLabel,T=h.renderThumbnailItem,A=h.rotatedPage,B=h.rotation,z=h.thumbnailDirection,y=h.thumbnailWidth,S=h.viewMode,L=h.onJumpToPage,N=h.onRotatePage,D=b.numPages,M=b.loadingTask.docId,x=r.useRef(null),j=r.useRef([]),U=r.useState(v),J=U[0],Q=U[1],X=r.useContext(e.ThemeContext).direction===e.TextDirection.RightToLeft,q=r.useState(-1),re=q[0],oe=q[1],Ae=e.useIsMounted(),te=e.usePrevious(S),Pe=r.useRef(!1),Be=e.useRenderQueue({doc:b}),it=r.useMemo((function(){return Array(D).fill(0).map((function(le,ce){return ce}))}),[M]),ft=r.useMemo((function(){switch(S){case e.ViewMode.DualPage:return e.chunk(it,2);case e.ViewMode.DualPageWithCover:return[[it[0]]].concat(e.chunk(it.slice(1),2));case e.ViewMode.SinglePage:default:return e.chunk(it,1)}}),[M,S]),Je=function(){if(x.current){var le=j.current,ce=J+1;ce<le.length&&(J>=0&&le[J].setAttribute("tabindex","-1"),Q(ce))}},pt=function(){if(x.current){var le=j.current,ce=J-1;ce>=0&&(J>=0&&le[J].setAttribute("tabindex","-1"),Q(ce))}},mt=function(){J>=0&&J<D&&L(J)};e.useIsomorphicLayoutEffect((function(){var le=x.current;le&&(j.current=Array.from(le.querySelectorAll(".rpv-thumbnail__item")))}),[S]),r.useEffect((function(){var le=j.current;if(!(le.length===0||J<0||J>le.length)){var ce=le[J];ce.setAttribute("tabindex","0"),ce.focus()}}),[J]),e.useIsomorphicLayoutEffect((function(){var le=x.current,ce=j.current;if(!(!le||ce.length===0||v<0||v>ce.length)){var Ke=ce[v].closest(".rpv-thumbnail__items");Ke&&(z===a.ThumbnailDirection.Vertical?(function(Ce,_e){var Qe=Ce.getBoundingClientRect().top-_e.getBoundingClientRect().top,at=Ce.clientHeight,_t=_e.clientHeight;Qe<0?_e.scrollTop+=Qe:Qe+at<=_t||(_e.scrollTop+=Qe+at-_t)})(Ke,le):(function(Ce,_e){var Qe=Ce.getBoundingClientRect().left-_e.getBoundingClientRect().left,at=Ce.clientWidth,_t=_e.clientWidth;Qe<0?_e.scrollLeft+=Qe:Qe+at<=_t||(_e.scrollLeft+=Qe+at-_t)})(Ke,le))}}),[v,z]);var Ut=r.useCallback((function(le){Ae.current&&(Be.markRendered(le),Pe.current=!1,bt())}),[M]),Tt=r.useCallback((function(le,ce){ce.isVisible?Be.setVisibility(le,ce.ratio):Be.setOutOfRange(le),bt()}),[M]),bt=r.useCallback((function(){if(!Pe.current){var le=Be.getHighestPriorityPage();le>-1&&(Be.markRendering(le),Pe.current=!0,oe(le))}}),[M]);return r.useEffect((function(){A>=0&&(Be.markRendering(A),Pe.current=!0,oe(A))}),[M,A]),e.useIsomorphicLayoutEffect((function(){te!==S&&(Be.markNotRendered(),bt())}),[S]),r.createElement("div",{ref:x,"data-testid":"thumbnail__list",className:e.classNames({"rpv-thumbnail__list":!0,"rpv-thumbnail__list--horizontal":z===a.ThumbnailDirection.Horizontal,"rpv-thumbnail__list--rtl":X,"rpv-thumbnail__list--vertical":z===a.ThumbnailDirection.Vertical}),onKeyDown:function(le){switch(le.key){case"ArrowDown":Je();break;case"ArrowUp":pt();break;case"Enter":mt()}}},ft.map((function(le,ce){var Ke=!1;switch(S){case e.ViewMode.DualPage:Ke=v===2*ce||v===2*ce+1;break;case e.ViewMode.DualPageWithCover:Ke=v===0&&ce===0||ce>0&&v===2*ce-1||ce>0&&v===2*ce;break;case e.ViewMode.SinglePage:default:Ke=v===ce}return r.createElement("div",{className:e.classNames({"rpv-thumbnail__items":!0,"rpv-thumbnail__items--dual":S===e.ViewMode.DualPage,"rpv-thumbnail__items--dual-cover":S===e.ViewMode.DualPageWithCover,"rpv-thumbnail__items--single":S===e.ViewMode.SinglePage,"rpv-thumbnail__items--selected":Ke}),key:"".concat(ce,"___").concat(S)},le.map((function(Ce){return(function(_e){var Qe=S===e.ViewMode.DualPageWithCover&&(_e===0||D%2==0&&_e===D-1),at="".concat(b.loadingTask.docId,"___").concat(_e),_t=_.length===D?_[_e]:"".concat(_e+1),Pt=H?H({currentPage:v,pageIndex:_e,numPages:D,pageLabel:_t}):_t,gt=C.has(_e)?C.get(_e):0,Rt=r.createElement(f,{doc:b,pageHeight:E,pageIndex:_e,pageRotation:gt,pageWidth:k,rotation:B,shouldRender:re===_e,thumbnailWidth:y,onRenderCompleted:Ut,onVisibilityChanged:Tt});return T?T({currentPage:v,key:at,numPages:D,pageIndex:_e,renderPageLabel:r.createElement(r.Fragment,null,Pt),renderPageThumbnail:Rt,onJumpToPage:function(){return L(_e)},onRotatePage:function(Nt){return N(_e,Nt)}}):r.createElement("div",{key:at},r.createElement("div",{className:e.classNames({"rpv-thumbnail__item":!0,"rpv-thumbnail__item--dual-even":S===e.ViewMode.DualPage&&_e%2==0,"rpv-thumbnail__item--dual-odd":S===e.ViewMode.DualPage&&_e%2==1,"rpv-thumbnail__item--dual-cover":Qe,"rpv-thumbnail__item--dual-cover-even":S===e.ViewMode.DualPageWithCover&&!Qe&&_e%2==0,"rpv-thumbnail__item--dual-cover-odd":S===e.ViewMode.DualPageWithCover&&!Qe&&_e%2==1,"rpv-thumbnail__item--single":S===e.ViewMode.SinglePage,"rpv-thumbnail__item--selected":v===_e}),role:"button",tabIndex:v===_e?0:-1,onClick:function(){return L(_e)}},Rt),r.createElement("div",{"data-testid":"thumbnail__label-".concat(_e),className:"rpv-thumbnail__label"},Pt))})(Ce)})))})))},g=function(h){var v=h.renderCurrentPageLabel,b=h.renderThumbnailItem,_=h.store,C=h.thumbnailDirection,E=h.thumbnailWidth,k=r.useState(_.get("doc")),H=k[0],T=k[1],A=r.useState(_.get("currentPage")||0),B=A[0],z=A[1],y=r.useState(_.get("pageHeight")||0),S=y[0],L=y[1],N=r.useState(_.get("pageWidth")||0),D=N[0],M=N[1],x=r.useState(_.get("rotation")||0),j=x[0],U=x[1],J=r.useState(_.get("pagesRotation")||new Map),Q=J[0],X=J[1],q=r.useState(_.get("rotatedPage")||-1),re=q[0],oe=q[1],Ae=r.useState(_.get("viewMode")),te=Ae[0],Pe=Ae[1],Be=function(ce){z(ce)},it=function(ce){T(ce)},ft=function(ce){L(ce)},Je=function(ce){M(ce)},pt=function(ce){U(ce)},mt=function(ce){X(ce)},Ut=function(ce){oe(ce)},Tt=function(ce){Pe(ce)},bt=function(ce){var Ke=_.get("jumpToPage");Ke&&Ke(ce)},le=function(ce,Ke){_.get("rotatePage")(ce,Ke)};return r.useEffect((function(){return _.subscribe("doc",it),_.subscribe("pageHeight",ft),_.subscribe("pageWidth",Je),_.subscribe("rotatedPage",Ut),_.subscribe("rotation",pt),_.subscribe("pagesRotation",mt),_.subscribe("viewMode",Tt),function(){_.unsubscribe("doc",it),_.unsubscribe("pageHeight",ft),_.unsubscribe("pageWidth",Je),_.unsubscribe("rotatedPage",Ut),_.unsubscribe("rotation",pt),_.unsubscribe("pagesRotation",mt),_.unsubscribe("viewMode",Tt)}}),[]),e.useIsomorphicLayoutEffect((function(){return _.subscribe("currentPage",Be),function(){_.unsubscribe("currentPage",Be)}}),[]),H?r.createElement(e.LazyRender,{testId:"thumbnail__list-container",attrs:{className:"rpv-thumbnail__list-container"}},r.createElement(c,{doc:H},(function(ce){return r.createElement(p,{currentPage:B,doc:H,labels:ce,pagesRotation:Q,pageHeight:S,pageWidth:D,renderCurrentPageLabel:v,renderThumbnailItem:b,rotatedPage:re,rotation:j,thumbnailDirection:C,thumbnailWidth:E,viewMode:te,onJumpToPage:bt,onRotatePage:le})}))):r.createElement("div",{"data-testid":"thumbnail-list__loader",className:"rpv-thumbnail__loader"},r.useContext(u).renderSpinner())};a.thumbnailPlugin=function(h){var v=r.useMemo((function(){return e.createStore({rotatePage:function(){},viewMode:e.ViewMode.SinglePage})}),[]),b=r.useState(""),_=b[0],C=b[1];return{install:function(E){v.update("jumpToPage",E.jumpToPage),v.update("rotatePage",E.rotatePage)},onDocumentLoad:function(E){C(E.doc.loadingTask.docId),v.update("doc",E.doc)},onViewerStateChange:function(E){return v.update("currentPage",E.pageIndex),v.update("pagesRotation",E.pagesRotation),v.update("pageHeight",E.pageHeight),v.update("pageWidth",E.pageWidth),v.update("rotation",E.rotation),v.update("rotatedPage",E.rotatedPage),v.update("viewMode",E.viewMode),E},Cover:function(E){return r.createElement(o,i({},E,{renderSpinner:h?.renderSpinner,store:v}))},Thumbnails:r.useCallback((function(E){return r.createElement(u.Provider,{value:{renderSpinner:h?.renderSpinner||l}},r.createElement(g,{renderCurrentPageLabel:h?.renderCurrentPageLabel,renderThumbnailItem:E?.renderThumbnailItem,store:v,thumbnailDirection:E?.thumbnailDirection||a.ThumbnailDirection.Vertical,thumbnailWidth:h?.thumbnailWidth||100}))}),[_])}}})(Jr)),Jr}var Ra;function $h(){if(Ra)return Zr.exports;Ra=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return Zr.exports=Wh(),Zr.exports}var Qr={exports:{}},xi={},es={exports:{}},ts={},La;function Gh(){return La||(La=1,(function(a){var e=Yt();function t(g){var h=Object.create(null);return g&&Object.keys(g).forEach((function(v){if(v!=="default"){var b=Object.getOwnPropertyDescriptor(g,v);Object.defineProperty(h,v,b.get?b:{enumerable:!0,get:function(){return g[v]}})}})),h.default=g,Object.freeze(h)}var n,r=t(Kt()),i=function(){return r.createElement(e.Icon,{size:16},r.createElement("path",{d:`M11.5,5.5v-2C11.5,2.672,12.172,2,13,2s1.5,0.672,1.5,1.5v2 M14.5,11.5v-6C14.5,4.672,15.172,4,16,4
            c0.828,0,1.5,0.672,1.5,1.5v3 M17.5,13V8.5C17.5,7.672,18.172,7,19,7s1.5,0.672,1.5,1.5v10c0,2.761-2.239,5-5,5h-3.335
            c-1.712-0.001-3.305-0.876-4.223-2.321C6.22,18.467,4.083,14,4.083,14c-0.378-0.545-0.242-1.292,0.303-1.67
            c0.446-0.309,1.044-0.281,1.458,0.07L8.5,15.5v-10C8.5,4.672,9.172,4,10,4s1.5,0.672,1.5,1.5v6`}))},s=function(){return s=Object.assign||function(g){for(var h,v=1,b=arguments.length;v<b;v++)for(var _ in h=arguments[v])Object.prototype.hasOwnProperty.call(h,_)&&(g[_]=h[_]);return g},s.apply(this,arguments)};a.SelectionMode=void 0,(n=a.SelectionMode||(a.SelectionMode={})).Hand="Hand",n.Text="Text";var o=function(){return r.createElement(e.Icon,{size:16},r.createElement("path",{d:`M13.675,11.671l2.941-2.941c0.195-0.196,0.195-0.512-0.001-0.707C16.563,7.971,16.5,7.931,16.43,7.906
            L4.168,3.527C3.908,3.434,3.622,3.57,3.529,3.83c-0.039,0.109-0.039,0.228,0,0.336l4.379,12.262
            c0.093,0.26,0.379,0.396,0.639,0.303c0.07-0.025,0.133-0.065,0.185-0.117l2.943-2.943l6.146,6.146c0.195,0.195,0.512,0.195,0.707,0
            l1.293-1.293c0.195-0.195,0.195-0.512,0-0.707L13.675,11.671z`}))},l=function(g){var h=g.children,v=g.mode,b=g.onClick,_=r.useContext(e.LocalizationContext).l10n,C="",E=r.createElement(o,null);switch(v){case a.SelectionMode.Hand:C=_&&_.selectionMode?_.selectionMode.handTool:"Hand tool",E=r.createElement(i,null);break;case a.SelectionMode.Text:default:C=_&&_.selectionMode?_.selectionMode.textSelectionTool:"Text selection tool",E=r.createElement(o,null)}return h({icon:E,label:C,onClick:b})},u={left:0,top:8},c=function(g){var h=g.isSelected,v=g.mode,b=g.onClick,_="";switch(v){case a.SelectionMode.Hand:_="selection-mode__hand-button";break;case a.SelectionMode.Text:default:_="selection-mode__text-button"}return r.createElement(l,{mode:v,onClick:b},(function(C){return r.createElement(e.Tooltip,{ariaControlsSuffix:"selection-mode-switch",position:e.Position.BottomCenter,target:r.createElement(e.MinimalButton,{ariaLabel:C.label,isSelected:h,testId:_,onClick:C.onClick},C.icon),content:function(){return C.label},offset:u})}))},d=function(g){var h=g.children,v=g.mode,b=g.store,_=v===b.get("selectionMode");return(h||function(C){return r.createElement(c,{isSelected:_,mode:C.mode,onClick:C.onClick})})({isSelected:_,mode:v,onClick:function(){return b.update("selectionMode",v)}})},f=function(g){var h=g.isSelected,v=g.mode,b=g.onClick,_="";switch(v){case a.SelectionMode.Hand:_="selection-mode__hand-menu";break;case a.SelectionMode.Text:default:_="selection-mode__text-menu"}return r.createElement(l,{mode:v,onClick:b},(function(C){return r.createElement(e.MenuItem,{checked:h,icon:C.icon,testId:_,onClick:C.onClick},C.label)}))},p=function(g){var h=g.store,v=r.useRef(null),b=r.useState(a.SelectionMode.Text),_=b[0],C=b[1],E=r.useRef({top:0,left:0,x:0,y:0}),k=function(z){var y=v.current;y&&(y.scrollTop=E.current.top-(z.clientY-E.current.y),y.scrollLeft=E.current.left-(z.clientX-E.current.x))},H=function(){var z=v.current;z&&(z.classList.add("rpv-selection-mode__grab"),z.classList.remove("rpv-selection-mode__grabbing"),document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",H))},T=function(z){var y=v.current;y&&_!==a.SelectionMode.Text&&(y.classList.remove("rpv-selection-mode__grab"),y.classList.add("rpv-selection-mode__grabbing"),z.preventDefault(),z.stopPropagation(),E.current={left:y.scrollLeft,top:y.scrollTop,x:z.clientX,y:z.clientY},document.addEventListener("mousemove",k),document.addEventListener("mouseup",H))},A=function(z){v.current=z()},B=function(z){C(z)};return r.useEffect((function(){var z=v.current;if(z)return _===a.SelectionMode.Hand?z.classList.add("rpv-selection-mode__grab"):z.classList.remove("rpv-selection-mode__grab"),z.addEventListener("mousedown",T),function(){z.removeEventListener("mousedown",T)}}),[_]),r.useEffect((function(){return h.subscribe("getPagesContainer",A),h.subscribe("selectionMode",B),function(){h.unsubscribe("getPagesContainer",A),h.unsubscribe("selectionMode",B)}}),[]),r.createElement(r.Fragment,null)};a.HandToolIcon=i,a.TextSelectionIcon=o,a.selectionModePlugin=function(g){var h=r.useMemo((function(){return e.createStore()}),[]),v=function(b){return r.createElement(d,s({},b,{store:h}))};return{install:function(b){h.update("selectionMode",g&&g.selectionMode?g.selectionMode:a.SelectionMode.Text),h.update("getPagesContainer",b.getPagesContainer)},renderViewer:function(b){var _=b.slot;return _.subSlot&&_.subSlot.children&&(_.subSlot.children=r.createElement(r.Fragment,null,r.createElement(p,{store:h}),_.subSlot.children)),_},SwitchSelectionMode:v,SwitchSelectionModeButton:function(b){return r.createElement(v,{mode:b.mode},(function(_){return r.createElement(c,{isSelected:_.isSelected,mode:_.mode,onClick:function(){_.onClick()}})}))},SwitchSelectionModeMenuItem:function(b){return r.createElement(v,{mode:b.mode},(function(_){return r.createElement(f,{isSelected:_.isSelected,mode:_.mode,onClick:function(){_.onClick(),b.onClick()}})}))}}}})(ts)),ts}var Ia;function Uh(){if(Ia)return es.exports;Ia=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return es.exports=Gh(),es.exports}var ns={exports:{}},Mi={},Da;function qh(){if(Da)return Mi;Da=1;var a=Yt();function e(b){var _=Object.create(null);return b&&Object.keys(b).forEach((function(C){if(C!=="default"){var E=Object.getOwnPropertyDescriptor(b,C);Object.defineProperty(_,C,E.get?E:{enumerable:!0,get:function(){return b[C]}})}})),_.default=b,Object.freeze(_)}var t=e(Kt()),n=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:"M11.5 23.499L11.5 14.499"}),t.createElement("path",{d:"M7.5 18.499L11.5 14.499 15.5 18.499"}),t.createElement("path",{d:"M11.5 1.499L11.5 10.499"}),t.createElement("path",{d:"M7.5 6.499L11.5 10.499 15.5 6.499"}),t.createElement("path",{d:"M20.5 12.499L1.5 12.499"}))},r=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:"M0.5 12L23.5 12"}),t.createElement("path",{d:"M11.5 1L11.5 23"}),t.createElement("path",{d:"M8.5 4L11.5 1 14.5 4"}),t.createElement("path",{d:"M20.5 9L23.5 12 20.5 15"}),t.createElement("path",{d:"M3.5 15L0.5 12 3.5 9"}),t.createElement("path",{d:"M14.5 20L11.5 23 8.5 20"}))},i=function(){return i=Object.assign||function(b){for(var _,C=1,E=arguments.length;C<E;C++)for(var k in _=arguments[C])Object.prototype.hasOwnProperty.call(_,k)&&(b[k]=_[k]);return b},i.apply(this,arguments)},s={left:0,top:8},o=function(b){var _=b.enableShortcuts,C=b.onClick,E=t.useContext(a.LocalizationContext).l10n,k=E&&E.fullScreen?E.fullScreen.enterFullScreen:"Full screen",H=_?a.isMac()?"Meta+Ctrl+F":"F11":"";return t.createElement(a.Tooltip,{ariaControlsSuffix:"full-screen-enter",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaKeyShortcuts:H,ariaLabel:k,isDisabled:!a.isFullScreenEnabled(),testId:"full-screen__enter-button",onClick:C},t.createElement(r,null)),content:function(){return k},offset:s})},l={left:0,top:8},u=function(b){var _=b.onClick,C=t.useContext(a.LocalizationContext).l10n,E=C&&C.fullScreen?C.fullScreen.exitFullScreen:"Exit full screen";return t.createElement(a.Tooltip,{ariaControlsSuffix:"full-screen-exit",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaKeyShortcuts:"Esc",ariaLabel:E,testId:"full-screen__exit-button-with-tooltip",onClick:_},t.createElement(n,null)),content:function(){return E},offset:l})},c=function(b,_){var C=t.useState(_.get("fullScreenMode")),E=C[0],k=C[1],H=t.useCallback((function(T){k(T)}),[]);return t.useEffect((function(){return _.subscribe("fullScreenMode",H),function(){_.unsubscribe("fullScreenMode",H)}}),[]),{enterFullScreen:function(){var T=_.get("getPagesContainer");if(T){var A=b(T());_.get("enterFullScreenMode")(A)}},exitFullScreen:function(){_.get("exitFullScreenMode")()},isFullScreen:E===a.FullScreenMode.Entering||E===a.FullScreenMode.EnteredCompletely}},d=function(b){var _=b.children,C=b.enableShortcuts,E=b.getFullScreenTarget,k=b.store,H=c(E,k),T=H.enterFullScreen,A=H.exitFullScreen,B=H.isFullScreen;return(_||function(z){return B?t.createElement(u,{onClick:z.onClick}):t.createElement(o,{enableShortcuts:C,onClick:z.onClick})})({onClick:B?A:T})},f=function(b){var _=b.onClick,C=t.useContext(a.LocalizationContext).l10n,E=C&&C.fullScreen?C.fullScreen.enterFullScreen:"Full screen";return t.createElement(a.MenuItem,{icon:t.createElement(r,null),isDisabled:!a.isFullScreenEnabled(),testId:"full-screen__enter-menu",onClick:_},E)},p=function(b){var _=b.onClick,C=t.useContext(a.LocalizationContext).l10n,E=t.useContext(a.ThemeContext).direction===a.TextDirection.RightToLeft,k=C&&C.fullScreen?C.fullScreen.exitFullScreen:"Exit full screen";return t.createElement("div",{className:a.classNames({"rpv-full-screen__exit-button":!0,"rpv-full-screen__exit-button--ltr":!E,"rpv-full-screen__exit-button--rtl":E})},t.createElement(a.MinimalButton,{ariaLabel:k,testId:"full-screen__exit-button",onClick:_},t.createElement(n,null)))},g=function(b){var _=b.children,C=b.getFullScreenTarget,E=b.store,k=c(C,E),H=k.enterFullScreen,T=k.exitFullScreen,A=k.isFullScreen;return A&&(_||function(B){return t.createElement(p,{onClick:B.onClick})})({onClick:A?T:H})},h=function(b){var _=b.store,C=b.onEnterFullScreen,E=b.onExitFullScreen,k=t.useState(_.get("fullScreenMode")),H=k[0],T=k[1],A=t.useCallback((function(B){T(B)}),[]);return t.useEffect((function(){switch(H){case a.FullScreenMode.EnteredCompletely:C(_.get("zoom"));break;case a.FullScreenMode.Exited:E(_.get("zoom"))}}),[H]),t.useEffect((function(){return _.subscribe("fullScreenMode",A),function(){_.unsubscribe("fullScreenMode",A)}}),[]),(H===a.FullScreenMode.Entering||H===a.FullScreenMode.Entered)&&t.createElement("div",{className:"rpv-full-screen__overlay"},t.createElement(a.Spinner,null))},v=function(b){var _=b.containerRef,C=b.getFullScreenTarget,E=b.store,k=c(C,E).enterFullScreen,H=function(T){if(!T.shiftKey&&!T.altKey&&(a.isMac()?T.metaKey&&T.ctrlKey&&T.key==="f":T.key==="F11")){var A=_.current;A&&document.activeElement&&A.contains(document.activeElement)&&(T.preventDefault(),k())}};return t.useEffect((function(){if(_.current)return document.addEventListener("keydown",H),function(){document.removeEventListener("keydown",H)}}),[_.current]),t.createElement(t.Fragment,null)};return Mi.ExitFullScreenIcon=n,Mi.FullScreenIcon=r,Mi.fullScreenPlugin=function(b){var _=b?.getFullScreenTarget||function(T){return T},C=t.useMemo((function(){return Object.assign({},{enableShortcuts:!0,onEnterFullScreen:function(){},onExitFullScreen:function(){}},b)}),[]),E=t.useMemo((function(){return a.createStore({enterFullScreenMode:function(){},exitFullScreenMode:function(){},fullScreenMode:a.FullScreenMode.Normal,zoom:function(){}})}),[]),k=function(T){return t.createElement(d,i({},T,{enableShortcuts:C.enableShortcuts,getFullScreenTarget:_,store:E}))},H=function(){return t.createElement(g,{getFullScreenTarget:_,store:E},b?.renderExitFullScreenButton)};return{install:function(T){E.update("enterFullScreenMode",T.enterFullScreenMode),E.update("exitFullScreenMode",T.exitFullScreenMode),E.update("getPagesContainer",T.getPagesContainer),E.update("zoom",T.zoom)},onViewerStateChange:function(T){return E.update("fullScreenMode",T.fullScreenMode),T},renderViewer:function(T){var A=T.slot;return A.subSlot&&(A.subSlot.children=t.createElement(t.Fragment,null,C.enableShortcuts&&t.createElement(v,{containerRef:T.containerRef,getFullScreenTarget:_,store:E}),t.createElement(h,{store:E,onEnterFullScreen:C.onEnterFullScreen,onExitFullScreen:C.onExitFullScreen}),t.createElement(H,null),A.subSlot.children)),A},EnterFullScreen:k,EnterFullScreenButton:function(){return t.createElement(k,null,(function(T){return t.createElement(o,i({enableShortcuts:C.enableShortcuts},T))}))},EnterFullScreenMenuItem:function(T){return t.createElement(k,null,(function(A){return t.createElement(f,{onClick:function(){A.onClick(),T.onClick()}})}))}}},Mi}var Fa;function Xh(){if(Fa)return ns.exports;Fa=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return ns.exports=qh(),ns.exports}var is={exports:{}},tr={},Oa;function Kh(){if(Oa)return tr;Oa=1;var a=Yt();function e(f){var p=Object.create(null);return f&&Object.keys(f).forEach((function(g){if(g!=="default"){var h=Object.getOwnPropertyDescriptor(f,g);Object.defineProperty(p,g,h.get?h:{enumerable:!0,get:function(){return f[g]}})}})),p.default=f,Object.freeze(p)}var t=e(Kt()),n=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:"M5.5,11.5c-.275,0-.341.159-.146.354l6.292,6.293a.5.5,0,0,0,.709,0l6.311-6.275c.2-.193.13-.353-.145-.355L15.5,11.5V1.5a1,1,0,0,0-1-1h-5a1,1,0,0,0-1,1V11a.5.5,0,0,1-.5.5Z"}),t.createElement("path",{d:"M23.5,18.5v4a1,1,0,0,1-1,1H1.5a1,1,0,0,1-1-1v-4"}))},r=function(){return r=Object.assign||function(f){for(var p,g=1,h=arguments.length;g<h;g++)for(var v in p=arguments[g])Object.prototype.hasOwnProperty.call(p,v)&&(f[v]=p[v]);return f},r.apply(this,arguments)},i={left:0,top:8},s=function(f){var p=f.onClick,g=t.useContext(a.LocalizationContext).l10n,h=g&&g.download?g.download.download:"Download";return t.createElement(a.Tooltip,{ariaControlsSuffix:"get-file",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaLabel:h,testId:"get-file__download-button",onClick:p},t.createElement(n,null)),content:function(){return h},offset:i})},o=function(f,p){var g=document.createElement("a");g.style.display="none",g.href=f,g.setAttribute("download",p),document.body.appendChild(g),g.click(),document.body.removeChild(g)},l=function(f,p,g){var h=URL.createObjectURL(new Blob([f],{type:g}));o(h,p),h&&URL.revokeObjectURL(h)},u=function(f,p){f.getData().then((function(g){/iphone|ipod|ipad/i.test(navigator.userAgent)&&!/CriOS/i.test(navigator.userAgent)?l(g,p,"application/octet-stream"):/iphone|ipod|ipad/i.test(navigator.userAgent)&&/CriOS/i.test(navigator.userAgent)?o("data:application/pdf;base64,".concat((function(h){return btoa(Array(h.length).fill("").map((function(v,b){return String.fromCharCode(h[b])})).join(""))})(g)),p):l(g,p,"application/pdf")}))},c=function(f){var p=f.children,g=f.fileNameGenerator,h=f.store,v=t.useState(h.get("file")),b=v[0],_=v[1],C=t.useState(h.get("doc")),E=C[0],k=C[1],H=function(A){k(A)},T=function(A){_(A)};return t.useEffect((function(){return h.subscribe("doc",H),h.subscribe("file",T),function(){h.subscribe("doc",H),h.unsubscribe("file",T)}}),[]),(p||function(A){return t.createElement(s,{onClick:A.onClick})})({onClick:function(){E&&b&&u(E,g(b))}})},d=function(f){var p=f.onClick,g=t.useContext(a.LocalizationContext).l10n,h=g&&g.download?g.download.download:"Download";return t.createElement(a.MenuItem,{icon:t.createElement(n,null),testId:"get-file__download-menu",onClick:p},h)};return tr.DownloadIcon=n,tr.getFilePlugin=function(f){var p=t.useMemo((function(){return a.createStore({})}),[]),g=function(v){return v.name?(b=v.name,(_=b.split("/").pop())?_.split("#")[0].split("?")[0]:b):"document.pdf";var b,_},h=function(v){return t.createElement(c,r({},v,{fileNameGenerator:f&&f.fileNameGenerator||g,store:p}))};return{onDocumentLoad:function(v){p.update("doc",v.doc),p.update("file",v.file)},Download:h,DownloadButton:function(){return t.createElement(h,null,(function(v){return t.createElement(s,r({},v))}))},DownloadMenuItem:function(v){return t.createElement(h,null,(function(b){return t.createElement(d,{onClick:function(){b.onClick(),v.onClick()}})}))}}},tr}var Na;function Yh(){if(Na)return is.exports;Na=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return is.exports=Kh(),is.exports}var rs={exports:{}},nr={},Ba;function Zh(){if(Ba)return nr;Ba=1;var a=Yt();function e(d){var f=Object.create(null);return d&&Object.keys(d).forEach((function(p){if(p!=="default"){var g=Object.getOwnPropertyDescriptor(d,p);Object.defineProperty(f,p,g.get?g:{enumerable:!0,get:function(){return d[p]}})}})),f.default=d,Object.freeze(f)}var t=e(Kt()),n=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:"M18.5,7.5c.275,0,.341-.159.146-.354L12.354.854a.5.5,0,0,0-.708,0L5.354,7.147c-.2.195-.129.354.146.354h3v10a1,1,0,0,0,1,1h5a1,1,0,0,0,1-1V7.5Z"}),t.createElement("path",{d:"M23.5,18.5v4a1,1,0,0,1-1,1H1.5a1,1,0,0,1-1-1v-4"}))},r=function(){return r=Object.assign||function(d){for(var f,p=1,g=arguments.length;p<g;p++)for(var h in f=arguments[p])Object.prototype.hasOwnProperty.call(f,h)&&(d[h]=f[h]);return d},r.apply(this,arguments)},i=function(d){var f=t.useRef(),p=function(){var h=f.current;h&&(h.click(),d.get("triggerOpenFile")&&d.update("triggerOpenFile",!1))},g=function(h){h&&p()};return t.useEffect((function(){return d.subscribe("triggerOpenFile",g),function(){d.unsubscribe("triggerOpenFile",g)}}),[]),{inputRef:f,openFile:p}},s={left:0,top:8},o=function(d){var f=d.enableShortcuts,p=d.store,g=d.onClick,h=t.useContext(a.LocalizationContext).l10n,v=h&&h.open?h.open.openFile:"Open file",b=i(p),_=b.inputRef,C=b.openFile,E=f?a.isMac()?"Meta+O":"Ctrl+O":"";return t.createElement(a.Tooltip,{ariaControlsSuffix:"open",position:a.Position.BottomCenter,target:t.createElement("div",{className:"rpv-open__input-wrapper"},t.createElement("input",{accept:".pdf",ref:_,className:"rpv-open__input",multiple:!1,tabIndex:-1,title:"",type:"file",onChange:g}),t.createElement(a.MinimalButton,{ariaKeyShortcuts:E,ariaLabel:v,testId:"open__button",onClick:C},t.createElement(n,null))),content:function(){return v},offset:s})},l=function(d){var f=d.children,p=d.enableShortcuts,g=d.store;return(f||function(h){return t.createElement(o,{enableShortcuts:p,store:g,onClick:h.onClick})})({onClick:function(h){var v=h.target.files;if(v&&v.length){var b=g.get("openFile");b&&b(v[0])}}})},u=function(d){var f=d.store,p=d.onClick,g=t.useContext(a.LocalizationContext).l10n,h=g&&g.open?g.open.openFile:"Open file",v=i(f),b=v.inputRef,_=v.openFile;return t.createElement(a.MenuItem,{icon:t.createElement(n,null),testId:"open__menu",onClick:_},t.createElement("div",{className:"rpv-open__input-wrapper"},t.createElement("input",{accept:".pdf",ref:b,className:"rpv-open__input",multiple:!1,tabIndex:-1,title:"",type:"file",onChange:p}),h))},c=function(d){var f=d.containerRef,p=d.store,g=function(h){if(!h.shiftKey&&!h.altKey&&h.key==="o"&&(a.isMac()?h.metaKey:h.ctrlKey)){var v=f.current;v&&document.activeElement&&v.contains(document.activeElement)&&(h.preventDefault(),p.update("triggerOpenFile",!0))}};return t.useEffect((function(){if(f.current)return document.addEventListener("keydown",g),function(){document.removeEventListener("keydown",g)}}),[f.current]),t.createElement(t.Fragment,null)};return nr.OpenFileIcon=n,nr.openPlugin=function(d){var f=t.useMemo((function(){return Object.assign({},{enableShortcuts:!0},d)}),[]),p=t.useMemo((function(){return a.createStore({})}),[]),g=function(h){return t.createElement(l,r({enableShortcuts:f.enableShortcuts},h,{store:p}))};return{install:function(h){p.update("openFile",h.openFile)},renderViewer:function(h){var v=h.slot,b={children:t.createElement(t.Fragment,null,f.enableShortcuts&&t.createElement(c,{containerRef:h.containerRef,store:p}),v.children)};return r(r({},v),b)},Open:g,OpenButton:function(){return t.createElement(g,null)},OpenMenuItem:function(){return t.createElement(g,null,(function(h){return t.createElement(u,{store:p,onClick:h.onClick})}))}}},nr}var za;function Jh(){if(za)return rs.exports;za=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return rs.exports=Zh(),rs.exports}var ss={exports:{}},Un={},Ha;function Qh(){if(Ha)return Un;Ha=1;var a=Yt();function e(D){var M=Object.create(null);return D&&Object.keys(D).forEach((function(x){if(x!=="default"){var j=Object.getOwnPropertyDescriptor(D,x);Object.defineProperty(M,x,j.get?j:{enumerable:!0,get:function(){return D[x]}})}})),M.default=D,Object.freeze(M)}var t=e(Kt()),n=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:`M2.32,2.966h19.452c0.552,0.001,1,0.449,0.999,1.001c0,0.182-0.05,0.36-0.144,0.516L12.9,20.552
            c-0.286,0.472-0.901,0.624-1.373,0.338c-0.138-0.084-0.254-0.2-0.338-0.338L1.465,4.483C1.179,4.01,1.331,3.396,1.804,3.11
            C1.96,3.016,2.138,2.966,2.32,2.966z`}))},r=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:`M0.541,5.627L11.666,18.2c0.183,0.207,0.499,0.226,0.706,0.043c0.015-0.014,0.03-0.028,0.043-0.043
            L23.541,5.627`}))},i=function(){return i=Object.assign||function(D){for(var M,x=1,j=arguments.length;x<j;x++)for(var U in M=arguments[x])Object.prototype.hasOwnProperty.call(M,U)&&(D[U]=M[U]);return D},i.apply(this,arguments)},s=function(D){var M=t.useState(D.get("currentPage")||0),x=M[0],j=M[1],U=function(J){j(J)};return a.useIsomorphicLayoutEffect((function(){return D.subscribe("currentPage",U),function(){D.unsubscribe("currentPage",U)}}),[]),{currentPage:x}},o=function(D){var M=t.useState(D.get("numberOfPages")||0),x=M[0],j=M[1],U=function(J){j(J)};return t.useEffect((function(){return D.subscribe("numberOfPages",U),function(){D.unsubscribe("numberOfPages",U)}}),[]),{numberOfPages:x}},l=function(D){var M=D.store,x=t.useContext(a.LocalizationContext).l10n,j=t.useState("1"),U=j[0],J=j[1],Q=s(M).currentPage,X=o(M).numberOfPages;t.useEffect((function(){return J("".concat(Q+1))}),[Q]);var q=function(oe){var Ae=M.get("jumpToPage");Ae&&Ae(oe)},re=x&&x.pageNavigation?x.pageNavigation.enterPageNumber:"Enter a page number";return t.createElement("span",{className:"rpv-page-navigation__current-page-input"},t.createElement(a.TextBox,{ariaLabel:re,testId:"page-navigation__current-page-input",type:"text",value:U,onChange:J,onKeyDown:function(oe){switch(oe.key){case"ArrowUp":(Pe=Q-1)>=0&&(J("".concat(Pe+1)),q(Pe));break;case"ArrowDown":(te=Q+1)<X&&(J("".concat(te+1)),q(te));break;case"Enter":Ae=parseInt(U,10),U===""||Ae<1||Ae>X?J("".concat(Q+1)):q(Ae-1)}var Ae,te,Pe}}))},u=function(D){var M=D.children,x=D.doc,j=a.useIsMounted(),U=t.useState({loading:!0,labels:[]}),J=U[0],Q=U[1];return t.useEffect((function(){x.getPageLabels().then((function(X){j.current&&Q({loading:!1,labels:X||[]})}))}),[x.loadingTask.docId]),J.loading?t.createElement(t.Fragment,null):M(J.labels)},c=function(D){var M=D.children,x=D.store,j=(function(X){var q=t.useState(X.get("doc")),re=q[0],oe=q[1],Ae=function(te){oe(te)};return t.useEffect((function(){return X.subscribe("doc",Ae),function(){X.unsubscribe("doc",Ae)}}),[]),re})(x),U=s(x).currentPage,J=o(x).numberOfPages,Q=M||function(X){return t.createElement(t.Fragment,null,X.currentPage+1)};return j?t.createElement(u,{doc:j},(function(X){var q=X.length===J&&J>0?X[U]:"";return Q({currentPage:U,numberOfPages:J,pageLabel:q})})):t.createElement(t.Fragment,null)},d=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:`M21.783,21.034H2.332c-0.552,0-1-0.448-1-1c0-0.182,0.05-0.361,0.144-0.517L11.2,3.448
            c0.286-0.472,0.901-0.624,1.373-0.338c0.138,0.084,0.254,0.2,0.338,0.338l9.726,16.069c0.286,0.473,0.134,1.087-0.339,1.373
            C22.143,20.984,21.965,21.034,21.783,21.034z`}))},f={left:0,top:8},p=function(D){var M=D.isDisabled,x=D.onClick,j=t.useContext(a.LocalizationContext).l10n,U=j&&j.pageNavigation?j.pageNavigation.goToFirstPage:"First page";return t.createElement(a.Tooltip,{ariaControlsSuffix:"page-navigation-first",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaLabel:U,isDisabled:M,testId:"page-navigation__first-button",onClick:x},t.createElement(d,null)),content:function(){return U},offset:f})},g=function(D){var M=D.children,x=D.store;return(M||function(j){return t.createElement(p,{isDisabled:j.isDisabled,onClick:j.onClick})})({isDisabled:s(x).currentPage===0,onClick:function(){var j=x.get("jumpToPage");j&&j(0)}})},h=function(D){var M=D.isDisabled,x=D.onClick,j=t.useContext(a.LocalizationContext).l10n,U=j&&j.pageNavigation?j.pageNavigation.goToFirstPage:"First page";return t.createElement(a.MenuItem,{icon:t.createElement(d,null),isDisabled:M,testId:"page-navigation__first-menu",onClick:x},U)},v={left:0,top:8},b=function(D){var M=D.isDisabled,x=D.onClick,j=t.useContext(a.LocalizationContext).l10n,U=j&&j.pageNavigation?j.pageNavigation.goToLastPage:"Last page";return t.createElement(a.Tooltip,{ariaControlsSuffix:"page-navigation-last",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaLabel:U,isDisabled:M,testId:"page-navigation__last-button",onClick:x},t.createElement(n,null)),content:function(){return U},offset:v})},_=function(D){var M=D.children,x=D.store,j=s(x).currentPage,U=o(x).numberOfPages;return(M||function(J){return t.createElement(b,{isDisabled:J.isDisabled,onClick:J.onClick})})({isDisabled:j+1>=U,onClick:function(){var J=x.get("jumpToPage");J&&J(U-1)}})},C=function(D){var M=D.isDisabled,x=D.onClick,j=t.useContext(a.LocalizationContext).l10n,U=j&&j.pageNavigation?j.pageNavigation.goToLastPage:"Last page";return t.createElement(a.MenuItem,{icon:t.createElement(n,null),isDisabled:M,testId:"page-navigation__last-menu",onClick:x},U)},E={left:0,top:8},k=function(D){var M=D.isDisabled,x=D.onClick,j=t.useContext(a.LocalizationContext).l10n,U=j&&j.pageNavigation?j.pageNavigation.goToNextPage:"Next page";return t.createElement(a.Tooltip,{ariaControlsSuffix:"page-navigation-next",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaLabel:U,isDisabled:M,testId:"page-navigation__next-button",onClick:x},t.createElement(r,null)),content:function(){return U},offset:E})},H=function(D){var M=D.children,x=D.store;return(M||function(j){return t.createElement(k,{onClick:j.onClick,isDisabled:j.isDisabled})})({isDisabled:s(x).currentPage+1>=o(x).numberOfPages,onClick:function(){var j=x.get("jumpToNextPage");j&&j()}})},T=function(D){var M=D.isDisabled,x=D.onClick,j=t.useContext(a.LocalizationContext).l10n,U=j&&j.pageNavigation?j.pageNavigation.goToNextPage:"Next page";return t.createElement(a.MenuItem,{icon:t.createElement(r,null),isDisabled:M,testId:"page-navigation__next-menu",onClick:x},U)},A=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:`M23.535,18.373L12.409,5.8c-0.183-0.207-0.499-0.226-0.706-0.043C11.688,5.77,11.674,5.785,11.66,5.8
            L0.535,18.373`}))},B={left:0,top:8},z=function(D){var M=D.isDisabled,x=D.onClick,j=t.useContext(a.LocalizationContext).l10n,U=j&&j.pageNavigation?j.pageNavigation.goToPreviousPage:"Previous page";return t.createElement(a.Tooltip,{ariaControlsSuffix:"page-navigation-previous",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaLabel:U,isDisabled:M,testId:"page-navigation__previous-button",onClick:x},t.createElement(A,null)),content:function(){return U},offset:B})},y=function(D){var M=D.store;return(D.children||function(x){return t.createElement(z,{isDisabled:x.isDisabled,onClick:x.onClick})})({isDisabled:s(M).currentPage<=0,onClick:function(){var x=M.get("jumpToPreviousPage");x&&x()}})},S=function(D){var M=D.isDisabled,x=D.onClick,j=t.useContext(a.LocalizationContext).l10n,U=j&&j.pageNavigation?j.pageNavigation.goToPreviousPage:"Previous page";return t.createElement(a.MenuItem,{icon:t.createElement(A,null),isDisabled:M,testId:"page-navigation__previous-menu",onClick:x},U)},L=function(D){var M=D.children,x=D.store,j=o(x).numberOfPages;return M?M({numberOfPages:j}):t.createElement(t.Fragment,null,j)},N=function(D){var M=D.containerRef,x=D.numPages,j=D.store,U=s(j).currentPage,J=t.useRef(U);J.current=U;var Q=t.useRef(!1),X=function(){Q.current=!0},q=function(){Q.current=!1},re=function(oe){var Ae=M.current,te=Q.current||document.activeElement&&Ae.contains(document.activeElement);if(Ae&&te){var Pe,Be,it=oe.altKey&&oe.key==="ArrowDown"||!oe.shiftKey&&!oe.altKey&&oe.key==="PageDown",ft=oe.altKey&&oe.key==="ArrowUp"||!oe.shiftKey&&!oe.altKey&&oe.key==="PageUp";if(it)return oe.preventDefault(),Pe=j.get("jumpToPage"),Be=J.current+1,void(Pe&&Be<x&&Pe(Be));if(ft)return oe.preventDefault(),void(function(){var Je=j.get("jumpToPage"),pt=J.current-1;Je&&pt>=0&&Je(pt)})();if(a.isMac()?oe.metaKey&&!oe.ctrlKey:oe.altKey)switch(oe.key){case"ArrowLeft":oe.preventDefault(),(function(){var Je=j.get("jumpToPreviousDestination");Je&&Je()})();break;case"ArrowRight":oe.preventDefault(),(function(){var Je=j.get("jumpToNextDestination");Je&&Je()})()}}};return t.useEffect((function(){var oe=M.current;if(oe)return document.addEventListener("keydown",re),oe.addEventListener("mouseenter",X),oe.addEventListener("mouseleave",q),function(){document.removeEventListener("keydown",re),oe.removeEventListener("mouseenter",X),oe.removeEventListener("mouseleave",q)}}),[M.current]),t.createElement(t.Fragment,null)};return Un.DownArrowIcon=n,Un.NextIcon=r,Un.PreviousIcon=A,Un.UpArrowIcon=d,Un.pageNavigationPlugin=function(D){var M=t.useMemo((function(){return Object.assign({},{enableShortcuts:!0},D)}),[]),x=t.useMemo((function(){return a.createStore()}),[]),j=function(X){return t.createElement(g,i({},X,{store:x}))},U=function(X){return t.createElement(_,i({},X,{store:x}))},J=function(X){return t.createElement(H,i({},X,{store:x}))},Q=function(X){return t.createElement(y,i({},X,{store:x}))};return{install:function(X){x.update("jumpToDestination",X.jumpToDestination),x.update("jumpToNextDestination",X.jumpToNextDestination),x.update("jumpToNextPage",X.jumpToNextPage),x.update("jumpToPage",X.jumpToPage),x.update("jumpToPreviousDestination",X.jumpToPreviousDestination),x.update("jumpToPreviousPage",X.jumpToPreviousPage)},renderViewer:function(X){var q=X.slot;if(!M.enableShortcuts)return q;var re={children:t.createElement(t.Fragment,null,t.createElement(N,{containerRef:X.containerRef,numPages:X.doc.numPages,store:x}),q.children)};return i(i({},q),re)},onDocumentLoad:function(X){x.update("doc",X.doc),x.update("numberOfPages",X.doc.numPages)},onViewerStateChange:function(X){return x.update("currentPage",X.pageIndex),X},jumpToNextPage:function(){var X=x.get("jumpToNextPage");X&&X()},jumpToPage:function(X){var q=x.get("jumpToPage");q&&q(X)},jumpToPreviousPage:function(){var X=x.get("jumpToPreviousPage");X&&X()},CurrentPageInput:function(){return t.createElement(l,{store:x})},CurrentPageLabel:function(X){return t.createElement(c,i({},X,{store:x}))},GoToFirstPage:j,GoToFirstPageButton:function(){return t.createElement(j,null,(function(X){return t.createElement(p,i({},X))}))},GoToFirstPageMenuItem:function(X){return t.createElement(j,null,(function(q){return t.createElement(h,{isDisabled:q.isDisabled,onClick:function(){q.onClick(),X.onClick()}})}))},GoToLastPage:U,GoToLastPageButton:function(){return t.createElement(U,null,(function(X){return t.createElement(b,i({},X))}))},GoToLastPageMenuItem:function(X){return t.createElement(U,null,(function(q){return t.createElement(C,{isDisabled:q.isDisabled,onClick:function(){q.onClick(),X.onClick()}})}))},GoToNextPage:J,GoToNextPageButton:function(){return t.createElement(J,null,(function(X){return t.createElement(k,i({},X))}))},GoToNextPageMenuItem:function(X){return t.createElement(J,null,(function(q){return t.createElement(T,{isDisabled:q.isDisabled,onClick:function(){q.onClick(),X.onClick()}})}))},GoToPreviousPage:Q,GoToPreviousPageButton:function(){return t.createElement(Q,null,(function(X){return t.createElement(z,i({},X))}))},GoToPreviousPageMenuItem:function(X){return t.createElement(Q,null,(function(q){return t.createElement(S,{isDisabled:q.isDisabled,onClick:function(){q.onClick(),X.onClick()}})}))},NumberOfPages:function(X){return t.createElement(L,i({},X,{store:x}))}}},Un}var ja;function ed(){if(ja)return ss.exports;ja=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return ss.exports=Qh(),ss.exports}var as={exports:{}},On={},Va;function td(){if(Va)return On;Va=1;var a={},e=Yt(),t=Kt(),n=Bl();function r(E){var k=Object.create(null);return E&&Object.keys(E).forEach((function(H){if(H!=="default"){var T=Object.getOwnPropertyDescriptor(E,H);Object.defineProperty(k,H,T.get?T:{enumerable:!0,get:function(){return E[H]}})}})),k.default=E,Object.freeze(k)}var i,s=r(t),o=function(){return s.createElement(e.Icon,{size:16},s.createElement("path",{d:`M7.5,19.499h9 M7.5,16.499h9 M5.5,16.5h-3c-1.103-0.003-1.997-0.897-2-2v-6c0.003-1.103,0.897-1.997,2-2h19
            c1.103,0.003,1.997,0.897,2,2v6c-0.003,1.103-0.897,1.997-2,2h-3
            M5.5,4.5v-4h9.586c0.265,0,0.52,0.105,0.707,0.293l2.414,2.414
            C18.395,3.394,18.5,3.649,18.5,3.914V4.5
            M18.5,22.5c0,0.552-0.448,1-1,1h-11c-0.552,0-1-0.448-1-1v-9h13V22.5z
            M3.5,8.499
            c0.552,0,1,0.448,1,1s-0.448,1-1,1s-1-0.448-1-1S2.948,8.499,3.5,8.499z
            M14.5,0.499v4h4`}))},l=function(){return l=Object.assign||function(E){for(var k,H=1,T=arguments.length;H<T;H++)for(var A in k=arguments[H])Object.prototype.hasOwnProperty.call(k,A)&&(E[A]=k[A]);return E},l.apply(this,arguments)},u={left:0,top:8},c=function(E){var k=E.enableShortcuts,H=E.onClick,T=s.useContext(e.LocalizationContext).l10n,A=T&&T.print?T.print.print:"Print",B=k?e.isMac()?"Meta+P":"Ctrl+P":"";return s.createElement(e.Tooltip,{ariaControlsSuffix:"print",position:e.Position.BottomCenter,target:s.createElement(e.MinimalButton,{ariaKeyShortcuts:B,ariaLabel:A,testId:"print__button",onClick:H},s.createElement(o,null)),content:function(){return A},offset:u})};(function(E){E.CheckingPermission="CheckingPermission",E.Inactive="Inactive",E.Preparing="Preparing",E.Cancelled="Cancelled",E.Ready="Ready"})(i||(i={}));var d=function(E){var k=E.children,H=E.enableShortcuts,T=E.store;return(k||c)({enableShortcuts:H,onClick:function(){T.update("printStatus",i.CheckingPermission)}})},f=function(E){var k=E.doc,H=E.store,T=s.useContext(e.LocalizationContext).l10n,A=s.useState(!0),B=A[0],z=A[1];return s.useEffect((function(){k.getPermissions().then((function(y){y===null||y.includes(4)||y.includes(2048)?H.update("printStatus",i.Preparing):z(!1)}))}),[]),B?s.createElement(s.Fragment,null):s.createElement(e.Modal,{ariaControlsSuffix:"print-permission",closeOnClickOutside:!1,closeOnEscape:!1,content:function(y){return s.createElement(s.Fragment,null,s.createElement("div",{className:"rpv-print__permission-body"},T&&T.print?T.print.disallowPrint:"The document does not allow to print"),s.createElement("div",{className:"rpv-print__permission-footer"},s.createElement(e.Button,{onClick:function(){y(),H.update("printStatus",i.Cancelled)}},T&&T.print?T.print.close:"Close")))},isOpened:!0})},p=function(E){var k=E.numLoadedPages,H=E.numPages,T=E.onCancel,A=s.useContext(e.LocalizationContext).l10n,B=s.useContext(e.ThemeContext).direction===e.TextDirection.RightToLeft,z=Math.floor(100*k/H);return s.createElement("div",{className:"rpv-print__progress"},s.createElement("div",{className:e.classNames({"rpv-print__progress-body":!0,"rpv-print__progress-body--rtl":B})},s.createElement("div",{className:"rpv-print__progress-message"},A&&A.print?A.print.preparingDocument:"Preparing document ..."),s.createElement("div",{className:"rpv-print__progress-bar"},s.createElement(e.ProgressBar,{progress:z})),s.createElement(e.Button,{onClick:T},A&&A.print?A.print.cancel:"Cancel")))},g=function(E){var k=E.canvas,H=E.page,T=E.pageHeight,A=E.pageIndex,B=E.pageWidth,z=E.rotation,y=E.onLoad,S=e.useIsMounted(),L=s.useRef(),N=s.useState(""),D=N[0],M=N[1],x=s.useMemo((function(){return typeof process<"u"&&a.JEST_WORKER_ID!==void 0}),[]);return s.useEffect((function(){var j=L.current;j&&j.cancel();var U=150/72;k.height=Math.floor(T*U),k.width=Math.floor(B*U);var J=k.getContext("2d");J.save(),J.fillStyle="rgb(255, 255, 255)",J.fillRect(0,0,k.width,k.height),J.restore();var Q=H.getViewport({rotation:z,scale:1});L.current=H.render({canvasContext:J,intent:"print",transform:[U,0,0,U,0,0],viewport:Q}),L.current.promise.then((function(){"toBlob"in k&&"createObjectURL"in URL?k.toBlob((function(X){S.current&&M(URL.createObjectURL(X)),x&&y()})):(S.current&&M(k.toDataURL()),x&&y())}),(function(){}))}),[]),D&&s.createElement("div",{className:"rpv-print__page"},s.createElement("img",{"data-testid":"print__thumbnail-".concat(A),src:D,onLoad:function(){x||y()}}))},h=function(E){var k=E.canvas,H=E.doc,T=E.pageIndex,A=E.pageRotation,B=E.pageSize,z=E.rotation,y=E.shouldRender,S=E.onLoad,L=e.useIsMounted(),N=s.useState(null),D=N[0],M=N[1],x=Math.abs(z+A)%180==0;s.useEffect((function(){y&&e.getPage(H,T).then((function(U){L.current&&M(U)}))}),[y]);var j=(B.rotation+z+A)%360;return D&&s.createElement(g,{canvas:k,page:D,pageHeight:x?B.pageHeight:B.pageWidth,pageIndex:T,pageWidth:x?B.pageWidth:B.pageHeight,rotation:j,onLoad:S})},v=function(E){var k=E.doc,H=E.numLoadedPages,T=E.pagesRotation,A=E.pageSizes,B=E.printPages,z=E.printStatus,y=E.rotation,S=E.onCancel,L=E.onLoad,N=s.useMemo((function(){return document.createElement("canvas")}),[]),D=s.useMemo((function(){var j=document.querySelector(".rpv-print__zone");if(j)return j;var U=document.createElement("div");return U.classList.add("rpv-print__zone"),U.setAttribute("data-testid","print__zone"),document.body.appendChild(U),U}),[]);s.useEffect((function(){z===i.Ready&&(document.documentElement.classList.add("rpv-print__html-printing"),document.body.classList.add("rpv-print__body-printing"),window.print());var j=function(){if(z===i.Ready){document.documentElement.classList.remove("rpv-print__html-printing"),document.body.classList.remove("rpv-print__body-printing");var U=document.querySelectorAll(".rpv-print__zone");U&&U.forEach((function(J){J.parentElement.removeChild(J)})),N.height=0,N.width=0,document.removeEventListener("mousemove",j),S()}};return document.addEventListener("mousemove",j),function(){return document.removeEventListener("mousemove",j)}}),[z]);var M=A[0].pageHeight,x=A[0].pageWidth;return n.createPortal(s.createElement(s.Fragment,null,B.map((function(j,U){return s.createElement(h,{key:j,canvas:N,doc:k,pageIndex:j,pageRotation:T.has(j)?T.get(j):0,pageSize:A[j],rotation:y,shouldRender:U===H,onLoad:L})})),s.createElement("style",{dangerouslySetInnerHTML:{__html:"@page { size: ".concat(x,"pt ").concat(M,"pt }")}})),D)},b=function(E){var k=E.doc,H=E.pagesRotation,T=E.pageSizes,A=E.renderProgressBar,B=E.rotation,z=E.setPages,y=E.store,S=s.useState(i.Inactive),L=S[0],N=S[1],D=s.useState(0),M=D[0],x=D[1],j=s.useMemo((function(){var X=k.numPages;return z(k).filter((function(q){return q>=0&&q<X}))}),[k,z]),U=j.length,J=function(){x(0),N(i.Inactive)},Q=function(X){return N(X)};return s.useEffect((function(){return y.subscribe("printStatus",Q),function(){y.unsubscribe("printStatus",Q)}}),[]),s.createElement(s.Fragment,null,L===i.CheckingPermission&&s.createElement(f,{doc:k,store:y}),L===i.Preparing&&(A?A(M,U,J):s.createElement(p,{numLoadedPages:M,numPages:U,onCancel:J})),(L===i.Preparing||L===i.Ready)&&M<=U&&s.createElement(v,{doc:k,numLoadedPages:M,pagesRotation:H,pageSizes:T,printPages:j,printStatus:L,rotation:B,onCancel:J,onLoad:function(){var X=M+1;X<=U&&(x(X),X===U&&N(i.Ready))}}))},_=function(E){var k=E.onClick,H=s.useContext(e.LocalizationContext).l10n,T=H&&H.print?H.print.print:"Print";return s.createElement(e.MenuItem,{icon:s.createElement(o,null),testId:"print__menu",onClick:k},T)},C=function(E){var k=E.containerRef,H=E.store,T=function(A){if(!A.shiftKey&&!A.altKey&&A.key==="p"&&(e.isMac()?A.metaKey:A.ctrlKey)){var B=k.current;B&&document.activeElement&&B.contains(document.activeElement)&&(A.preventDefault(),H.update("printStatus",i.Preparing))}};return s.useEffect((function(){if(k.current)return document.addEventListener("keydown",T),function(){document.removeEventListener("keydown",T)}}),[k.current]),s.createElement(s.Fragment,null)};return On.PrintIcon=o,On.getAllPagesNumbers=function(E){return Array(E.numPages).fill(0).map((function(k,H){return H}))},On.getCustomPagesNumbers=function(E){return function(k){var H,T=[];return E.replace(/\s+/g,"").split(",").forEach((function(A){var B,z,y=A.split("-").map((function(S){return parseInt(S,10)})).filter((function(S){return Number.isInteger(S)}));y.length===1?T.push(y[0]-1):y.length===2&&T.push.apply(T,(B=y[0]-1,z=y[1]-1,Array(z-B+1).fill(0).map((function(S,L){return B+L}))))})),(H=T,H.filter((function(A){return H.indexOf(A)===H.lastIndexOf(A)}))).filter((function(A){return A>=0&&A<k.numPages}))}},On.getEvenPagesNumbers=function(E){return Array(E.numPages).fill(0).map((function(k,H){return H})).filter((function(k){return(k+1)%2==0}))},On.getOddPagesNumbers=function(E){return Array(E.numPages).fill(0).map((function(k,H){return H})).filter((function(k){return(k+1)%2==1}))},On.printPlugin=function(E){var k=s.useMemo((function(){return Object.assign({},{enableShortcuts:!0,setPages:function(A){return Array(A.numPages).fill(0).map((function(B,z){return z}))}},E)}),[]),H=s.useMemo((function(){return e.createStore({printStatus:i.Inactive})}),[]),T=function(A){return s.createElement(d,l({enableShortcuts:k.enableShortcuts},A,{store:H}))};return{print:function(){H.update("printStatus",i.CheckingPermission)},renderViewer:function(A){var B=A.slot,z={children:s.createElement(s.Fragment,null,k.enableShortcuts&&s.createElement(C,{containerRef:A.containerRef,store:H}),s.createElement(b,{doc:A.doc,pagesRotation:A.pagesRotation,pageSizes:A.pageSizes,renderProgressBar:E?.renderProgressBar,rotation:A.rotation,setPages:k.setPages,store:H}),B.children)};return l(l({},B),z)},Print:T,PrintButton:function(){return s.createElement(T,null,(function(A){return s.createElement(c,l({},A))}))},PrintMenuItem:function(A){return s.createElement(T,null,(function(B){return s.createElement(_,{onClick:function(){B.onClick(),A.onClick()}})}))},setPages:function(A){k.setPages=A}}},On}var Wa;function nd(){if(Wa)return as.exports;Wa=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return as.exports=td(),as.exports}var os={exports:{}},ir={},$a;function id(){if($a)return ir;$a=1;var a=Yt();function e(g){var h=Object.create(null);return g&&Object.keys(g).forEach((function(v){if(v!=="default"){var b=Object.getOwnPropertyDescriptor(g,v);Object.defineProperty(h,v,b.get?b:{enumerable:!0,get:function(){return g[v]}})}})),h.default=g,Object.freeze(h)}var t=e(Kt()),n=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:`M12,1.001c6.075,0,11,4.925,11,11s-4.925,11-11,11s-11-4.925-11-11S5.925,1.001,12,1.001z
            M14.5,17.005H13
            c-0.552,0-1-0.448-1-1v-6.5c0-0.276-0.224-0.5-0.5-0.5H10
            M11.745,6.504L11.745,6.504
            M11.745,6.5c-0.138,0-0.25,0.112-0.25,0.25
            S11.607,7,11.745,7s0.25-0.112,0.25-0.25S11.883,6.5,11.745,6.5`}))},r=function(){return r=Object.assign||function(g){for(var h,v=1,b=arguments.length;v<b;v++)for(var _ in h=arguments[v])Object.prototype.hasOwnProperty.call(h,_)&&(g[_]=h[_]);return g},r.apply(this,arguments)},i=function(g){var h=g.doc,v=g.render,b=t.useState(),_=b[0],C=b[1];return t.useEffect((function(){h.getMetadata().then((function(E){return Promise.resolve(E)})).then((function(E){return h.getDownloadInfo().then((function(k){return Promise.resolve({fileName:E.contentDispositionFilename||"",info:E.info,length:k.length})}))})).then((function(E){C(E)}))}),[]),_?v(_):t.createElement("div",{className:"rpv-properties__loader"},t.createElement(a.Spinner,null))},s=function(g){var h=g.label,v=g.value,b=t.useContext(a.ThemeContext).direction===a.TextDirection.RightToLeft;return t.createElement("dl",{className:a.classNames({"rpv-properties__item":!0,"rpv-properties__item--rtl":b})},t.createElement("dt",{className:"rpv-properties__item-label"},h,":"),t.createElement("dd",{className:"rpv-properties__item-value"},v||"-"))},o=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"),l=function(g,h,v,b){var _=parseInt(g,10);return _>=h&&_<=v?_:b},u=function(g){var h=g.doc,v=g.fileName,b=g.onToggle,_=t.useContext(a.LocalizationContext).l10n,C=function(E){var k=(function(H){var T=o.exec(H);if(!T)return null;var A=parseInt(T[1],10),B=l(T[2],1,12,1)-1,z=l(T[3],1,31,1),y=l(T[4],0,23,0),S=l(T[5],0,59,0),L=l(T[6],0,59,0),N=T[7]||"Z",D=l(T[8],0,23,0),M=l(T[9],0,59,0);switch(N){case"-":y+=D,S+=M;break;case"+":y-=D,S-=M}return new Date(Date.UTC(A,B,z,y,S,L))})(E);return k?"".concat(k.toLocaleDateString(),", ").concat(k.toLocaleTimeString()):""};return t.createElement("div",{className:"rpv-properties__modal"},t.createElement(i,{doc:h,render:function(E){return t.createElement(t.Fragment,null,t.createElement("div",{className:"rpv-properties__modal-section"},t.createElement(s,{label:_&&_.properties?_.properties.fileName:"File name",value:E.fileName||(T=v,A=T.split("/").pop(),A?A.split("#")[0].split("?")[0]:T)}),t.createElement(s,{label:_&&_.properties?_.properties.fileSize:"File size",value:(k=E.length,H=Math.floor(Math.log(k)/Math.log(1024)),"".concat((k/Math.pow(1024,H)).toFixed(2)," ").concat(["B","kB","MB","GB","TB"][H]))})),t.createElement(a.Separator,null),t.createElement("div",{className:"rpv-properties__modal-section"},t.createElement(s,{label:_&&_.properties?_.properties.title:"Title",value:E.info.Title}),t.createElement(s,{label:_&&_.properties?_.properties.author:"Author",value:E.info.Author}),t.createElement(s,{label:_&&_.properties?_.properties.subject:"Subject",value:E.info.Subject}),t.createElement(s,{label:_&&_.properties?_.properties.keywords:"Keywords",value:E.info.Keywords}),t.createElement(s,{label:_&&_.properties?_.properties.creator:"Creator",value:E.info.Creator}),t.createElement(s,{label:_&&_.properties?_.properties.creationDate:"Creation date",value:C(E.info.CreationDate)}),t.createElement(s,{label:_&&_.properties?_.properties.modificationDate:"Modification date",value:C(E.info.ModDate)})),t.createElement(a.Separator,null),t.createElement("div",{className:"rpv-properties__modal-section"},t.createElement(s,{label:_&&_.properties?_.properties.pdfProducer:"PDF producer",value:E.info.Producer}),t.createElement(s,{label:_&&_.properties?_.properties.pdfVersion:"PDF version",value:E.info.PDFFormatVersion}),t.createElement(s,{label:_&&_.properties?_.properties.pageCount:"Page count",value:"".concat(h.numPages)})));var k,H,T,A}}),t.createElement("div",{className:"rpv-properties__modal-footer"},t.createElement(a.Button,{onClick:b},_&&_.properties?_.properties.close:"Close")))},c={left:0,top:8},d=function(g){var h=g.onClick,v=t.useContext(a.LocalizationContext).l10n,b=v&&v.properties?v.properties.showProperties:"Show properties";return t.createElement(a.Tooltip,{ariaControlsSuffix:"properties",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaLabel:b,testId:"properties__button",onClick:h},t.createElement(n,null)),content:function(){return b},offset:c})},f=function(g){var h=g.children,v=g.store,b=(function(E){var k=t.useState(E.get("doc")),H=k[0],T=k[1],A=function(B){T(B)};return t.useEffect((function(){return E.subscribe("doc",A),function(){E.unsubscribe("doc",A)}}),[]),{currentDoc:H}})(v).currentDoc,_=v.get("fileName")||"",C=h||function(E){return t.createElement(d,r({},E))};return b?t.createElement(a.Modal,{ariaControlsSuffix:"properties",target:function(E){return C({onClick:E})},content:function(E){return t.createElement(u,{doc:b,fileName:_,onToggle:E})},closeOnClickOutside:!0,closeOnEscape:!0}):t.createElement(t.Fragment,null)},p=function(g){var h=g.onClick,v=t.useContext(a.LocalizationContext).l10n,b=v&&v.properties?v.properties.showProperties:"Show properties";return t.createElement(a.MenuItem,{icon:t.createElement(n,null),testId:"properties__menu",onClick:h},b)};return ir.InfoIcon=n,ir.propertiesPlugin=function(){var g=t.useMemo((function(){return a.createStore({fileName:""})}),[]),h=function(v){return t.createElement(f,r({},v,{store:g}))};return{onDocumentLoad:function(v){g.update("doc",v.doc)},onViewerStateChange:function(v){return g.update("fileName",v.file.name),v},ShowProperties:h,ShowPropertiesButton:function(){return t.createElement(f,{store:g})},ShowPropertiesMenuItem:function(v){return t.createElement(h,null,(function(b){return t.createElement(p,r({},b))}))}}},ir}var Ga;function rd(){if(Ga)return os.exports;Ga=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return os.exports=id(),os.exports}var ls={exports:{}},Ti={},Ua;function sd(){if(Ua)return Ti;Ua=1;var a=Yt();function e(d){var f=Object.create(null);return d&&Object.keys(d).forEach((function(p){if(p!=="default"){var g=Object.getOwnPropertyDescriptor(d,p);Object.defineProperty(f,p,g.get?g:{enumerable:!0,get:function(){return d[p]}})}})),f.default=d,Object.freeze(f)}var t=e(Kt()),n=function(){return t.createElement(a.Icon,{ignoreDirection:!0,size:16},t.createElement("path",{d:`M3.434,10.537c0.141-0.438,0.316-0.864,0.523-1.274
            M3.069,14.425C3.023,14.053,3,13.679,3,13.305 c0-0.291,0.014-0.579,0.041-0.863
            M4.389,18.111c-0.341-0.539-0.623-1.112-0.843-1.711
            M7.163,20.9 c-0.543-0.345-1.048-0.747-1.506-1.2
            M10.98,22.248c-0.65-0.074-1.29-0.218-1.909-0.431
            M10,4.25h2 c4.987,0.015,9.017,4.069,9.003,9.055c-0.013,4.581-3.456,8.426-8.008,8.945
            M13.5,1.75L10,4.25l3.5,2.5`}))},r=function(){return t.createElement(a.Icon,{ignoreDirection:!0,size:16},t.createElement("path",{d:`M20.566,10.537c-0.141-0.438-0.316-0.864-0.523-1.274
            M20.931,14.425C20.977,14.053,21,13.679,21,13.305 c0-0.291-0.014-0.579-0.041-0.863
            M19.611,18.111c0.341-0.539,0.624-1.114,0.843-1.713
            M16.837,20.9 c0.543-0.345,1.048-0.747,1.506-1.2
            M13.02,22.248c0.65-0.074,1.29-0.218,1.909-0.431
            M14,4.25h-2 c-4.987,0.015-9.017,4.069-9.003,9.055c0.013,4.581,3.456,8.426,8.008,8.945
            M10.5,1.75l3.5,2.5l-3.5,2.5`}))},i=function(){return i=Object.assign||function(d){for(var f,p=1,g=arguments.length;p<g;p++)for(var h in f=arguments[p])Object.prototype.hasOwnProperty.call(f,h)&&(d[h]=f[h]);return d},i.apply(this,arguments)},s={left:0,top:8},o=function(d){var f=d.direction,p=d.onClick,g=t.useContext(a.LocalizationContext).l10n,h=g&&g.rotate?g.rotate.rotateBackward:"Rotate counterclockwise",v=g&&g.rotate?g.rotate.rotateForward:"Rotate clockwise",b=f===a.RotateDirection.Backward?h:v,_=f===a.RotateDirection.Backward?t.createElement(n,null):t.createElement(r,null);return t.createElement(a.Tooltip,{ariaControlsSuffix:"rotate",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaLabel:b,testId:f===a.RotateDirection.Backward?"rotate__backward-button":"rotate__forward-button",onClick:p},_),content:function(){return b},offset:s})},l=function(d){var f=d.children,p=d.direction,g=d.store;return(f||function(h){return t.createElement(o,{direction:h.direction,onClick:h.onClick})})({direction:p,onClick:function(){var h=g.get("rotate");h&&h(p)}})},u=function(d){var f=d.direction,p=d.onClick,g=t.useContext(a.LocalizationContext).l10n,h=g&&g.rotate?g.rotate.rotateBackward:"Rotate counterclockwise",v=g&&g.rotate?g.rotate.rotateForward:"Rotate clockwise",b=f===a.RotateDirection.Backward?h:v,_=f===a.RotateDirection.Backward?t.createElement(n,null):t.createElement(r,null);return t.createElement(a.MenuItem,{icon:_,testId:f===a.RotateDirection.Backward?"rotate__backward-menu":"rotate__forward-menu",onClick:p},b)},c=function(d){var f=d.children,p=d.store;return f({onRotatePage:function(g,h){var v=p.get("rotatePage");v&&v(g,h)}})};return Ti.RotateBackwardIcon=n,Ti.RotateForwardIcon=r,Ti.rotatePlugin=function(){var d=t.useMemo((function(){return a.createStore()}),[]),f=function(p){return t.createElement(l,i({},p,{store:d}))};return{install:function(p){d.update("rotate",p.rotate),d.update("rotatePage",p.rotatePage)},Rotate:f,RotateBackwardButton:function(){return t.createElement(f,{direction:a.RotateDirection.Backward},(function(p){return t.createElement(o,i({},p))}))},RotateBackwardMenuItem:function(p){return t.createElement(f,{direction:a.RotateDirection.Backward},(function(g){return t.createElement(u,{direction:g.direction,onClick:function(){g.onClick(),p.onClick()}})}))},RotateForwardButton:function(){return t.createElement(f,{direction:a.RotateDirection.Forward},(function(p){return t.createElement(o,i({},p))}))},RotateForwardMenuItem:function(p){return t.createElement(f,{direction:a.RotateDirection.Forward},(function(g){return t.createElement(u,{direction:g.direction,onClick:function(){g.onClick(),p.onClick()}})}))},RotatePage:function(p){return t.createElement(c,i({},p,{store:d}))}}},Ti}var qa;function ad(){if(qa)return ls.exports;qa=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return ls.exports=sd(),ls.exports}var cs={exports:{}},xn={},Xa;function od(){if(Xa)return xn;Xa=1;var a=Yt();function e(A){var B=Object.create(null);return A&&Object.keys(A).forEach((function(z){if(z!=="default"){var y=Object.getOwnPropertyDescriptor(A,z);Object.defineProperty(B,z,y.get?y:{enumerable:!0,get:function(){return A[z]}})}})),B.default=A,Object.freeze(B)}var t=e(Kt()),n=function(){return t.createElement(a.Icon,{size:16},t.createElement("rect",{x:"0.5",y:"0.497",width:"22",height:"22",rx:"1",ry:"1"}),t.createElement("line",{x1:"0.5",y1:"6.497",x2:"22.5",y2:"6.497"}),t.createElement("line",{x1:"11.5",y1:"6.497",x2:"11.5",y2:"22.497"}))},r=function(){return t.createElement(a.Icon,{size:16},t.createElement("rect",{x:"0.5",y:"0.497",width:"22",height:"22",rx:"1",ry:"1"}),t.createElement("line",{x1:"11.5",y1:"0.497",x2:"11.5",y2:"22.497"}))},i=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:`M6.5,21.5c0,0.552-0.448,1-1,1h-4c-0.552,0-1-0.448-1-1v-20c0-0.552,0.448-1,1-1h4c0.552,0,1,0.448,1,1V21.5z
            M14.5,21.5c0,0.552-0.448,1-1,1h-4c-0.552,0-1-0.448-1-1v-20c0-0.552,0.448-1,1-1h4c0.552,0,1,0.448,1,1V21.5z
            M22.5,21.5 c0,0.552-0.448,1-1,1h-4c-0.552,0-1-0.448-1-1v-20c0-0.552,0.448-1,1-1h4c0.552,0,1,0.448,1,1V21.5z`}))},s=function(){return t.createElement(a.Icon,{size:16},t.createElement("rect",{x:"0.5",y:"0.497",width:"22",height:"22",rx:"1",ry:"1"}))},o=function(){return o=Object.assign||function(A){for(var B,z=1,y=arguments.length;z<y;z++)for(var S in B=arguments[z])Object.prototype.hasOwnProperty.call(B,S)&&(A[S]=B[S]);return A},o.apply(this,arguments)},l=function(A,B){A.get("switchScrollMode")(B);var z=A.get("viewMode");B!==a.ScrollMode.Horizontal&&B!==a.ScrollMode.Wrapped||z===a.ViewMode.SinglePage||A.get("switchViewMode")(a.ViewMode.SinglePage)},u=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:`M23.5,5.5c0,0.552-0.448,1-1,1h-21c-0.552,0-1-0.448-1-1v-3c0-0.552,0.448-1,1-1h21c0.552,0,1,0.448,1,1V5.5z
            M23.5,13.5c0,0.552-0.448,1-1,1h-21c-0.552,0-1-0.448-1-1v-3c0-0.552,0.448-1,1-1h21c0.552,0,1,0.448,1,1V13.5z
            M23.5,21.5 c0,0.552-0.448,1-1,1h-21c-0.552,0-1-0.448-1-1v-3c0-0.552,0.448-1,1-1h21c0.552,0,1,0.448,1,1V21.5z`}))},c=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:`M10.5,9.5c0,0.552-0.448,1-1,1h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V9.5z
            M23.5,9.5c0,0.552-0.448,1-1,1h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V9.5z
            M10.5,22.5 c0,0.552-0.448,1-1,1h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V22.5z
            M23.5,22.5c0,0.552-0.448,1-1,1 h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V22.5z`}))},d=function(A){var B=A.children,z=A.mode,y=A.onClick,S=t.useContext(a.LocalizationContext).l10n,L="",N=t.createElement(u,null);switch(z){case a.ScrollMode.Horizontal:L=S&&S.scrollMode?S.scrollMode.horizontalScrolling:"Horizontal scrolling",N=t.createElement(i,null);break;case a.ScrollMode.Page:L=S&&S.scrollMode?S.scrollMode.pageScrolling:"Page scrolling",N=t.createElement(s,null);break;case a.ScrollMode.Wrapped:L=S&&S.scrollMode?S.scrollMode.wrappedScrolling:"Wrapped scrolling",N=t.createElement(c,null);break;case a.ScrollMode.Vertical:default:L=S&&S.scrollMode?S.scrollMode.verticalScrolling:"Vertical scrolling",N=t.createElement(u,null)}return B({icon:N,label:L,onClick:y})},f={left:0,top:8},p=function(A){var B=A.isDisabled,z=A.isSelected,y=A.mode,S=A.onClick,L="";switch(y){case a.ScrollMode.Horizontal:L="scroll-mode__horizontal-button";break;case a.ScrollMode.Page:L="scroll-mode__page-button";break;case a.ScrollMode.Wrapped:L="scroll-mode__wrapped-button";break;case a.ScrollMode.Vertical:default:L="scroll-mode__vertical-button"}return t.createElement(d,{mode:y,onClick:S},(function(N){return t.createElement(a.Tooltip,{ariaControlsSuffix:"scroll-mode-switch",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaLabel:N.label,isDisabled:B,isSelected:z,testId:L,onClick:N.onClick},N.icon),content:function(){return N.label},offset:f})}))},g=function(A){var B=t.useState(A.get("scrollMode")||a.ScrollMode.Vertical),z=B[0],y=B[1],S=function(L){y(L)};return t.useEffect((function(){return A.subscribe("scrollMode",S),function(){A.unsubscribe("scrollMode",S)}}),[]),{scrollMode:z}},h=function(A){var B=t.useState(A.get("viewMode")||a.ViewMode.SinglePage),z=B[0],y=B[1],S=function(L){y(L)};return t.useEffect((function(){return A.subscribe("viewMode",S),function(){A.unsubscribe("viewMode",S)}}),[]),{viewMode:z}},v=function(A){var B=A.children,z=A.mode,y=A.store,S=h(y).viewMode,L=g(y).scrollMode===z,N=(z===a.ScrollMode.Horizontal||z===a.ScrollMode.Wrapped)&&S!==a.ViewMode.SinglePage;return(B||function(D){return t.createElement(p,{isDisabled:N,isSelected:L,mode:D.mode,onClick:D.onClick})})({isDisabled:N,isSelected:L,mode:z,onClick:function(){l(y,z)}})},b=function(A){var B=A.isDisabled,z=A.isSelected,y=A.mode,S=A.onClick,L="";switch(y){case a.ScrollMode.Horizontal:L="scroll-mode__horizontal-menu";break;case a.ScrollMode.Page:L="scroll-mode__page-menu";break;case a.ScrollMode.Wrapped:L="scroll-mode__wrapped-menu";break;case a.ScrollMode.Vertical:default:L="scroll-mode__vertical-menu"}return t.createElement(d,{mode:y,onClick:S},(function(N){return t.createElement(a.MenuItem,{checked:z,icon:N.icon,isDisabled:B,testId:L,onClick:N.onClick},N.label)}))},_=function(A,B){A.get("switchViewMode")(B);var z=A.get("scrollMode");z!==a.ScrollMode.Horizontal&&z!==a.ScrollMode.Wrapped||B===a.ViewMode.SinglePage||A.get("switchScrollMode")(a.ScrollMode.Vertical)},C=function(A){var B=A.children,z=A.mode,y=A.onClick,S=t.useContext(a.LocalizationContext).l10n,L="",N=t.createElement(s,null);switch(z){case a.ViewMode.DualPage:L=S&&S.scrollMode?S.scrollMode.dualPage:"Dual page",N=t.createElement(r,null);break;case a.ViewMode.DualPageWithCover:L=S&&S.scrollMode?S.scrollMode.dualPageCover:"Dual page with cover",N=t.createElement(n,null);break;case a.ViewMode.SinglePage:default:L=S&&S.scrollMode?S.scrollMode.singlePage:"Single page",N=t.createElement(s,null)}return B({icon:N,label:L,onClick:y})},E={left:0,top:8},k=function(A){var B=A.isDisabled,z=A.isSelected,y=A.mode,S=A.onClick,L="";switch(y){case a.ViewMode.DualPage:L="view-mode__dual-button";break;case a.ViewMode.DualPageWithCover:L="view-mode__dual-cover-button";break;case a.ViewMode.SinglePage:default:L="view-mode__single-button"}return t.createElement(C,{mode:y,onClick:S},(function(N){return t.createElement(a.Tooltip,{ariaControlsSuffix:"view-mode-switch",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaLabel:N.label,isDisabled:B,isSelected:z,testId:L,onClick:N.onClick},N.icon),content:function(){return N.label},offset:E})}))},H=function(A){var B=A.children,z=A.mode,y=A.store,S=h(y).viewMode,L=g(y).scrollMode,N=S===z,D=(L===a.ScrollMode.Horizontal||L===a.ScrollMode.Wrapped)&&z!==a.ViewMode.SinglePage;return(B||function(M){return t.createElement(k,{isDisabled:D,isSelected:N,mode:M.mode,onClick:M.onClick})})({isDisabled:D,isSelected:N,mode:z,onClick:function(){_(y,z)}})},T=function(A){var B=A.isDisabled,z=A.isSelected,y=A.mode,S=A.onClick,L="";switch(y){case a.ViewMode.DualPage:L="view-mode__dual-menu";break;case a.ViewMode.DualPageWithCover:L="view-mode__dual-cover-menu";break;case a.ViewMode.SinglePage:default:L="view-mode__single-menu"}return t.createElement(C,{mode:y,onClick:S},(function(N){return t.createElement(a.MenuItem,{checked:z,icon:N.icon,isDisabled:B,testId:L,onClick:N.onClick},N.label)}))};return xn.DualPageCoverViewModeIcon=n,xn.DualPageViewModeIcon=r,xn.HorizontalScrollingIcon=i,xn.PageScrollingIcon=s,xn.VerticalScrollingIcon=u,xn.WrappedScrollingIcon=c,xn.scrollModePlugin=function(){var A=t.useMemo((function(){return a.createStore({scrollMode:a.ScrollMode.Vertical,viewMode:a.ViewMode.SinglePage,switchScrollMode:function(){},switchViewMode:function(){}})}),[]),B=function(y){return t.createElement(v,o({},y,{store:A}))},z=function(y){return t.createElement(H,o({},y,{store:A}))};return{install:function(y){A.update("switchScrollMode",y.switchScrollMode),A.update("switchViewMode",y.switchViewMode)},onViewerStateChange:function(y){return A.update("scrollMode",y.scrollMode),A.update("viewMode",y.viewMode),y},switchScrollMode:function(y){l(A,y)},switchViewMode:function(y){_(A,y)},SwitchScrollMode:B,SwitchScrollModeButton:function(y){return t.createElement(B,{mode:y.mode},(function(S){return t.createElement(p,{isDisabled:S.isDisabled,isSelected:S.isSelected,mode:S.mode,onClick:function(){S.onClick()}})}))},SwitchScrollModeMenuItem:function(y){return t.createElement(B,{mode:y.mode},(function(S){return t.createElement(b,{isDisabled:S.isDisabled,isSelected:S.isSelected,mode:S.mode,onClick:function(){S.onClick(),y.onClick()}})}))},SwitchViewMode:z,SwitchViewModeButton:function(y){return t.createElement(z,{mode:y.mode},(function(S){return t.createElement(k,{isDisabled:S.isDisabled,isSelected:S.isSelected,mode:S.mode,onClick:function(){S.onClick()}})}))},SwitchViewModeMenuItem:function(y){return t.createElement(z,{mode:y.mode},(function(S){return t.createElement(T,{isDisabled:S.isDisabled,isSelected:S.isSelected,mode:S.mode,onClick:function(){S.onClick(),y.onClick()}})}))}}},xn}var Ka;function ld(){if(Ka)return cs.exports;Ka=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return cs.exports=od(),cs.exports}var us={exports:{}},ci={},Ya;function cd(){if(Ya)return ci;Ya=1;var a=Yt();function e(y){var S=Object.create(null);return y&&Object.keys(y).forEach((function(L){if(L!=="default"){var N=Object.getOwnPropertyDescriptor(y,L);Object.defineProperty(S,L,N.get?N:{enumerable:!0,get:function(){return y[L]}})}})),S.default=y,Object.freeze(S)}var t=e(Kt()),n=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:`M0.541,5.627L11.666,18.2c0.183,0.207,0.499,0.226,0.706,0.043c0.015-0.014,0.03-0.028,0.043-0.043
            L23.541,5.627`}))},r=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:`M23.535,18.373L12.409,5.8c-0.183-0.207-0.499-0.226-0.706-0.043C11.688,5.77,11.674,5.785,11.66,5.8
            L0.535,18.373`}))},i=function(){return t.createElement(a.Icon,{ignoreDirection:!0,size:16},t.createElement("path",{d:`M10.5,0.5c5.523,0,10,4.477,10,10s-4.477,10-10,10s-10-4.477-10-10S4.977,0.5,10.5,0.5z
            M23.5,23.5
            l-5.929-5.929`}))},s=function(){return s=Object.assign||function(y){for(var S,L=1,N=arguments.length;L<N;L++)for(var D in S=arguments[L])Object.prototype.hasOwnProperty.call(S,D)&&(y[D]=S[D]);return y},s.apply(this,arguments)},o={keyword:"",regExp:new RegExp(" "),wholeWords:!1},l=function(y){return{left:"".concat(y.left,"%"),top:"".concat(y.top,"%"),height:"".concat(y.height,"%"),width:"".concat(y.width,"%")}},u=function(y){var S=y.index,L=y.area,N=y.onHighlightKeyword,D=t.useRef();return a.useIsomorphicLayoutEffect((function(){var M=D.current;N&&M&&N({highlightEle:M,keyword:L.keyword})}),[]),t.createElement("div",{className:"rpv-search__highlight","data-index":S,ref:D,style:l(L),title:L.keywordStr.trim()})},c=function(y){var S=y.parentNode;S&&S.removeChild(y)},d=function(y){var S=y.parentNode;if(S){var L=document.createRange();L.selectNodeContents(y),(function(N,D){c(N);var M=D.parentNode;M&&M.insertBefore(N,D),c(D)})(L.extractContents(),y),S.normalize()}},f=function(y,S){return y.top<S.top?-1:y.top>S.top?1:y.left<S.left?-1:y.left>S.left?1:0},p=function(y){var S=y.numPages,L=y.pageIndex,N=y.renderHighlights,D=y.store,M=y.onHighlightKeyword,x=t.useRef(),j=t.useCallback((function(Ce){return t.createElement(t.Fragment,null,Ce.highlightAreas.map((function(_e,Qe){return t.createElement(u,{index:Qe,key:Qe,area:_e,onHighlightKeyword:M})})))}),[]),U=N||j,J=t.useState(D.get("matchPosition")),Q=J[0],X=J[1],q=t.useState(D.get("keyword")||[o]),re=q[0],oe=q[1],Ae=t.useState({pageIndex:L,scale:1,status:a.LayerRenderStatus.PreRender}),te=Ae[0],Pe=Ae[1],Be=t.useRef(null),it=t.useRef([]),ft=t.useState([]),Je=ft[0],pt=ft[1],mt=function(){return!0},Ut=t.useCallback((function(){return D.get("targetPageFilter")||mt}),[D.get("targetPageFilter")]),Tt=function(Ce){var _e=it.current;if(_e.length===0)return[];var Qe=[],at=[].slice.call(Ce.querySelectorAll(".rpv-core__text-layer-text")),_t=_e.map((function(Pt){return Pt.char})).join("");return re.forEach((function(Pt){var gt=Pt.keyword;if(gt.trim()){for(var Rt,Nt=Pt.regExp.flags.indexOf("g")===-1?new RegExp(Pt.regExp,"".concat(Pt.regExp.flags,"g")):Pt.regExp,Bt=[];(Rt=Nt.exec(_t))!==null;)Bt.push({keyword:Nt,startIndex:Rt.index,endIndex:Nt.lastIndex});Bt.map((function(rt){return{keyword:rt.keyword,indexes:_e.slice(rt.startIndex,rt.endIndex)}})).forEach((function(rt){var fn=rt.indexes.reduce((function(vt,yn){return vt[yn.spanIndex]=(vt[yn.spanIndex]||[]).concat([yn]),vt}),{});Object.values(fn).forEach((function(vt){if(vt.length!==1||vt[0].char.trim()!==""){var yn=Pt.wholeWords?vt.slice(1,-1):vt,pn=(function(Lt,It,Qn,Ge,wt){var Vn=document.createRange(),Pn=Ge.firstChild;if(!Pn||Pn.nodeType!==Node.TEXT_NODE)return null;var ei=Pn.textContent.length,vi=wt[0].charIndexInSpan,ti=wt.length===1?vi:wt[wt.length-1].charIndexInSpan;if(vi>ei||ti+1>ei)return null;Vn.setStart(Pn,vi),Vn.setEnd(Pn,ti+1);var ni=document.createElement("span");Vn.surroundContents(ni);var ii=ni.getBoundingClientRect(),ri=Qn.getBoundingClientRect(),bi=ri.height,_i=ri.width,wr=100*(ii.left-ri.left)/_i,yr=100*(ii.top-ri.top)/bi,Er=100*ii.height/bi,Sr=100*ii.width/_i;return d(ni),{keyword:It,keywordStr:Lt,numPages:S,pageIndex:L,left:wr,top:yr,height:Er,width:Sr,pageHeight:bi,pageWidth:_i}})(gt,rt.keyword,Ce,at[yn[0].spanIndex],yn);pn&&Qe.push(pn)}}))}))}})),Qe.sort(f)},bt=function(Ce){Ce&&Ce.length>0&&oe(Ce)},le=function(Ce){return X(Ce)},ce=function(Ce){if(Ce.has(L)){var _e=Ce.get(L);_e&&Pe({ele:_e.ele,pageIndex:L,scale:_e.scale,status:_e.status})}},Ke=function(){return re.length===0||re.length===1&&re[0].keyword.trim()===""};return t.useEffect((function(){if(!Ke()&&te.status===a.LayerRenderStatus.DidRender&&!it.current.length){var Ce=te.ele,_e=[].slice.call(Ce.querySelectorAll(".rpv-core__text-layer-text")).map((function(Qe){return Qe.textContent})).reduce((function(Qe,at,_t){return Qe.concat(at.split("").map((function(Pt,gt){return{char:Pt,charIndexInSpan:gt,spanIndex:_t}})))}),[{char:"",charIndexInSpan:0,spanIndex:0}]).slice(1);it.current=_e}}),[re,te.status]),t.useEffect((function(){if(!Ke()&&te.ele&&te.status===a.LayerRenderStatus.DidRender&&Ut()({pageIndex:L,numPages:S})){var Ce=te.ele,_e=Tt(Ce);pt(_e)}}),[re,Q,te.status,it.current]),t.useEffect((function(){Ke()&&te.ele&&te.status===a.LayerRenderStatus.DidRender&&pt([])}),[re,te.status]),t.useEffect((function(){if(Je.length!==0){var Ce=x.current;if(Q.pageIndex===L&&Ce&&te.status===a.LayerRenderStatus.DidRender){var _e=Ce.querySelector('.rpv-search__highlight[data-index="'.concat(Q.matchIndex,'"]'));if(_e){var Qe=(function(gt,Rt){for(var Nt=gt.offsetTop,Bt=gt.offsetLeft,rt=gt.parentElement;rt&&rt!==Rt;)Nt+=rt.offsetTop,Bt+=rt.offsetLeft,rt=rt.parentElement;return{left:Bt,top:Nt}})(_e,Ce),at=Qe.left,_t=Qe.top,Pt=D.get("jumpToDestination");Pt&&(Pt({pageIndex:L,bottomOffset:(Ce.getBoundingClientRect().height-_t)/te.scale,leftOffset:at/te.scale,scaleTo:te.scale}),Be.current&&Be.current.classList.remove("rpv-search__highlight--current"),Be.current=_e,_e.classList.add("rpv-search__highlight--current"))}}}}),[Je,Q]),t.useEffect((function(){return D.subscribe("keyword",bt),D.subscribe("matchPosition",le),D.subscribe("renderStatus",ce),function(){D.unsubscribe("keyword",bt),D.unsubscribe("matchPosition",le),D.unsubscribe("renderStatus",ce)}}),[]),t.createElement("div",{className:"rpv-search__highlights","data-testid":"search__highlights-".concat(L),ref:x},U({getCssProperties:l,highlightAreas:Je}))},g=function(y){var S,L=y.wholeWords?" ".concat(y.keyword," "):y.keyword,N=y.matchCase?"g":"gi";return{keyword:y.keyword,regExp:new RegExp((S=L,S.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),N),wholeWords:y.wholeWords||!1}},h=function(y,S,L){return y instanceof RegExp?{keyword:y.source,regExp:y,wholeWords:L||!1}:typeof y=="string"?y===""?o:g({keyword:y,matchCase:S||!1,wholeWords:L||!1}):(S!==void 0&&(y.matchCase=S),L!==void 0&&(y.wholeWords=L),g(y))},v=function(y){var S,L=y.get("initialKeyword"),N=t.useMemo((function(){if(L&&L.length===1){var le=h(L[0]);return{matchCase:le.regExp.flags.indexOf("i")===-1,wholeWords:le.wholeWords}}return{matchCase:!1,wholeWords:!1}}),[]),D=(function(le){var ce=t.useRef(le.get("doc")),Ke=function(Ce){ce.current=Ce};return t.useEffect((function(){return le.subscribe("doc",Ke),function(){le.unsubscribe("doc",Ke)}}),[]),ce})(y),M=t.useState(L),x=M[0],j=M[1],U=t.useState([]),J=U[0],Q=U[1],X=t.useState(0),q=X[0],re=X[1],oe=t.useState(N.matchCase),Ae=oe[0],te=oe[1],Pe=t.useRef([]),Be=t.useState(N.wholeWords),it=Be[0],ft=Be[1],Je=function(){return!0},pt=t.useCallback((function(){return y.get("targetPageFilter")||Je}),[y.get("targetPageFilter")]),mt=function(le){var ce=J.length;if(x.length===0||ce===0)return null;var Ke=le===ce+1?1:Math.max(1,Math.min(ce,le));return re(Ke),Tt(J[Ke-1])},Ut=function(le){return j(le===""?[]:[le])},Tt=function(le){var ce=y.get("jumpToPage");return ce&&ce(le.pageIndex),y.update("matchPosition",{matchIndex:le.matchIndex,pageIndex:le.pageIndex}),le},bt=function(le,ce,Ke){var Ce=D.current;if(!Ce)return Promise.resolve([]);var _e=Ce.numPages,Qe=le.map((function(at){return h(at,ce,Ke)}));return y.update("keyword",Qe),re(0),Q([]),new Promise((function(at,_t){var Pt=Pe.current.length===0?(function(){var gt=D.current;if(!gt)return Promise.resolve([]);var Rt=Array(gt.numPages).fill(0).map((function(Nt,Bt){return a.getPage(gt,Bt).then((function(rt){return rt.getTextContent()})).then((function(rt){var fn=rt.items.map((function(vt){return vt.str||""})).join("");return Promise.resolve({pageContent:fn,pageIndex:Bt})}))}));return Promise.all(Rt).then((function(Nt){return Nt.sort((function(Bt,rt){return Bt.pageIndex-rt.pageIndex})),Promise.resolve(Nt.map((function(Bt){return Bt.pageContent})))}))})().then((function(gt){return Pe.current=gt,Promise.resolve(gt)})):Promise.resolve(Pe.current);Pt.then((function(gt){var Rt=[];gt.forEach((function(Nt,Bt){pt()({pageIndex:Bt,numPages:_e})&&Qe.forEach((function(rt){for(var fn,vt=0;(fn=rt.regExp.exec(Nt))!==null;)Rt.push({keyword:rt.regExp,matchIndex:vt,pageIndex:Bt,pageText:Nt,startIndex:fn.index,endIndex:rt.regExp.lastIndex}),vt++}))})),Q(Rt),Rt.length>0&&(re(1),Tt(Rt[0])),at(Rt)}))}))};return t.useEffect((function(){Pe.current=[]}),[D.current]),{clearKeyword:function(){y.update("keyword",[o]),Ut(""),re(0),Q([]),te(!1),ft(!1)},changeMatchCase:function(le){te(le),x.length>0&&bt(x,le,it)},changeWholeWords:function(le){ft(le),x.length>0&&bt(x,Ae,le)},currentMatch:q,jumpToMatch:mt,jumpToNextMatch:function(){return mt(q+1)},jumpToPreviousMatch:function(){return mt(q-1)},keywords:x,matchCase:Ae,numberOfMatches:J.length,wholeWords:it,search:function(){return bt(x,Ae,it)},searchFor:bt,setKeywords:j,keyword:x.length===0?"":(S=x[0],S instanceof RegExp?S.source:typeof S=="string"?S:S.keyword),setKeyword:Ut,setTargetPages:function(le){y.update("targetPageFilter",le)}}},b=function(y){var S=y.children,L=y.store,N=v(L),D=t.useState(!1),M=D[0],x=D[1],j=function(U){return x(!0)};return t.useEffect((function(){return L.subscribe("doc",j),function(){L.unsubscribe("doc",j)}}),[]),S(s(s({},N),{isDocumentLoaded:M}))},_=function(y){var S=y.containerRef,L=y.store,N=t.useRef(!1),D=function(){N.current=!0},M=function(){N.current=!1},x=function(j){var U=S.current;U&&(j.shiftKey||j.altKey||j.key!=="f"||(a.isMac()?j.metaKey&&!j.ctrlKey:j.ctrlKey)&&(N.current||document.activeElement&&U.contains(document.activeElement))&&(j.preventDefault(),L.update("areShortcutsPressed",!0)))};return t.useEffect((function(){var j=S.current;if(j)return document.addEventListener("keydown",x),j.addEventListener("mouseenter",D),j.addEventListener("mouseleave",M),function(){document.removeEventListener("keydown",x),j.removeEventListener("mouseenter",D),j.removeEventListener("mouseleave",M)}}),[S.current]),t.createElement(t.Fragment,null)},C={left:0,top:8},E=function(y){var S=y.store,L=y.onToggle,N=t.useContext(a.LocalizationContext).l10n,D=t.useContext(a.ThemeContext).direction,M=t.useState(!1),x=M[0],j=M[1],U=t.useState(!1),J=U[0],Q=U[1],X=D===a.TextDirection.RightToLeft,q=v(S),re=q.clearKeyword,oe=q.changeMatchCase,Ae=q.changeWholeWords,te=q.currentMatch,Pe=q.jumpToNextMatch,Be=q.jumpToPreviousMatch,it=q.keyword,ft=q.matchCase,Je=q.numberOfMatches,pt=q.wholeWords,mt=q.search,Ut=q.setKeyword,Tt=function(Ce){j(!0),mt().then((function(_e){j(!1),Q(!0),Ce&&Ce()}))};t.useEffect((function(){var Ce=S.get("initialKeyword");Ce&&Ce.length===1&&it&&Tt((function(){S.update("initialKeyword",[])}))}),[]);var bt=N&&N.search?N.search.enterToSearch:"Enter to search",le=N&&N.search?N.search.previousMatch:"Previous match",ce=N&&N.search?N.search.nextMatch:"Next match",Ke=N&&N.search?N.search.close:"Close";return t.createElement("div",{className:"rpv-search__popover"},t.createElement("div",{className:"rpv-search__popover-input-counter"},t.createElement(a.TextBox,{ariaLabel:bt,autoFocus:!0,placeholder:bt,type:"text",value:it,onChange:function(Ce){Q(!1),Ut(Ce)},onKeyDown:function(Ce){Ce.key==="Enter"&&it&&(J?Pe():Tt())}}),t.createElement("div",{className:a.classNames({"rpv-search__popover-counter":!0,"rpv-search__popover-counter--ltr":!X,"rpv-search__popover-counter--rtl":X})},x&&t.createElement(a.Spinner,{testId:"search__popover-searching",size:"1rem"}),!x&&t.createElement("span",{"data-testid":"search__popover-num-matches"},te,"/",Je))),t.createElement("label",{className:"rpv-search__popover-label"},t.createElement("input",{className:"rpv-search__popover-label-checkbox","data-testid":"search__popover-match-case",checked:ft,type:"checkbox",onChange:function(Ce){Q(!1),oe(Ce.target.checked)}})," ",N&&N.search?N.search.matchCase:"Match case"),t.createElement("label",{className:"rpv-search__popover-label"},t.createElement("input",{className:"rpv-search__popover-label-checkbox",checked:pt,"data-testid":"search__popover-whole-words",type:"checkbox",onChange:function(Ce){Q(!1),Ae(Ce.target.checked)}})," ",N&&N.search?N.search.wholeWords:"Whole words"),t.createElement("div",{className:"rpv-search__popover-footer"},t.createElement("div",{className:"rpv-search__popover-footer-item"},t.createElement(a.Tooltip,{ariaControlsSuffix:"search-previous-match",position:X?a.Position.BottomRight:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaLabel:le,isDisabled:te<=1,onClick:Be},t.createElement(r,null)),content:function(){return le},offset:C})),t.createElement("div",{className:"rpv-search__popover-footer-item"},t.createElement(a.Tooltip,{ariaControlsSuffix:"search-next-match",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaLabel:ce,isDisabled:te>Je-1,onClick:Pe},t.createElement(n,null)),content:function(){return ce},offset:C})),t.createElement("div",{className:a.classNames({"rpv-search__popover-footer-button":!0,"rpv-search__popover-footer-button--ltr":!X,"rpv-search__popover-footer-button--rtl":X})},t.createElement(a.Button,{onClick:function(){L(),re()}},Ke))))},k=function(y){var S=y.children,L=y.onClick,N=t.useContext(a.LocalizationContext).l10n,D=N&&N.search?N.search.search:"Search";return S({icon:t.createElement(i,null),label:D,onClick:L})},H={left:0,top:8},T=function(y){var S=y.enableShortcuts,L=y.store,N=y.onClick,D=S?a.isMac()?"Meta+F":"Ctrl+F":"",M=function(x){x&&N()};return t.useEffect((function(){return L.subscribe("areShortcutsPressed",M),function(){L.unsubscribe("areShortcutsPressed",M)}}),[]),t.createElement(k,{onClick:N},(function(x){return t.createElement(a.Tooltip,{ariaControlsSuffix:"search-popover",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaKeyShortcuts:D,ariaLabel:x.label,testId:"search__popover-button",onClick:N},x.icon),content:function(){return x.label},offset:H})}))},A={left:0,top:8},B=function(y){var S=y.children,L=y.enableShortcuts,N=y.store,D=t.useContext(a.ThemeContext).direction===a.TextDirection.RightToLeft?a.Position.BottomRight:a.Position.BottomLeft,M=S||function(x){return t.createElement(T,s({enableShortcuts:L,store:N},x))};return t.createElement(a.Popover,{ariaControlsSuffix:"search",lockScroll:!1,position:D,target:function(x){return M({onClick:x})},content:function(x){return t.createElement(E,{store:N,onToggle:x})},offset:A,closeOnClickOutside:!1,closeOnEscape:!0})},z=function(y){return Array.isArray(y)?y.map((function(S){return h(S)})):[h(y)]};return ci.NextIcon=n,ci.PreviousIcon=r,ci.SearchIcon=i,ci.searchPlugin=function(y){var S=t.useMemo((function(){return Object.assign({},{enableShortcuts:!0,onHighlightKeyword:function(){}},y)}),[]),L=t.useMemo((function(){return a.createStore({initialKeyword:y&&y.keyword?Array.isArray(y.keyword)?y.keyword:[y.keyword]:[],keyword:y&&y.keyword?z(y.keyword):[o],matchPosition:{matchIndex:-1,pageIndex:-1},renderStatus:new Map})}),[]),N=v(L),D=N.clearKeyword,M=N.jumpToMatch,x=N.jumpToNextMatch,j=N.jumpToPreviousMatch,U=N.searchFor,J=N.setKeywords,Q=N.setTargetPages,X=function(q){return t.createElement(B,s({enableShortcuts:S.enableShortcuts},q,{store:L}))};return{install:function(q){var re=y&&y.keyword?Array.isArray(y.keyword)?y.keyword:[y.keyword]:[],oe=y&&y.keyword?z(y.keyword):[o];L.update("initialKeyword",re),L.update("jumpToDestination",q.jumpToDestination),L.update("jumpToPage",q.jumpToPage),L.update("keyword",oe)},renderPageLayer:function(q){return t.createElement(p,{key:q.pageIndex,numPages:q.doc.numPages,pageIndex:q.pageIndex,renderHighlights:y?.renderHighlights,store:L,onHighlightKeyword:S.onHighlightKeyword})},renderViewer:function(q){var re=q.slot;return re.subSlot&&(re.subSlot.children=t.createElement(t.Fragment,null,S.enableShortcuts&&t.createElement(_,{containerRef:q.containerRef,store:L}),re.subSlot.children)),re},uninstall:function(q){var re=L.get("renderStatus");re&&re.clear()},onDocumentLoad:function(q){L.update("doc",q.doc)},onTextLayerRender:function(q){var re=L.get("renderStatus");re&&(re=re.set(q.pageIndex,q),L.update("renderStatus",re))},Search:function(q){return t.createElement(b,s({},q,{store:L}))},ShowSearchPopover:X,ShowSearchPopoverButton:function(){return t.createElement(X,null,(function(q){return t.createElement(T,s({enableShortcuts:S.enableShortcuts,store:L},q))}))},clearHighlights:function(){D()},highlight:function(q){var re=Array.isArray(q)?q:[q];return J(re),U(re)},jumpToMatch:M,jumpToNextMatch:x,jumpToPreviousMatch:j,setTargetPages:Q}},ci}var Za;function ud(){if(Za)return us.exports;Za=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return us.exports=cd(),us.exports}var hs={exports:{}},Ri={},Ja;function hd(){if(Ja)return Ri;Ja=1;var a=Yt();function e(c){var d=Object.create(null);return c&&Object.keys(c).forEach((function(f){if(f!=="default"){var p=Object.getOwnPropertyDescriptor(c,f);Object.defineProperty(d,f,p.get?p:{enumerable:!0,get:function(){return c[f]}})}})),d.default=c,Object.freeze(d)}var t=e(Kt()),n=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:"M19.5,15.106l2.4-2.4a1,1,0,0,0,0-1.414l-2.4-2.4V5.5a1,1,0,0,0-1-1H15.106l-2.4-2.4a1,1,0,0,0-1.414,0l-2.4,2.4H5.5a1,1,0,0,0-1,1V8.894l-2.4,2.4a1,1,0,0,0,0,1.414l2.4,2.4V18.5a1,1,0,0,0,1,1H8.894l2.4,2.4a1,1,0,0,0,1.414,0l2.4-2.4H18.5a1,1,0,0,0,1-1Z"}),t.createElement("path",{d:"M10,6.349a6,6,0,0,1,0,11.3,6,6,0,1,0,0-11.3Z"}))},r=function(){return t.createElement(a.Icon,{size:16},t.createElement("path",{d:"M19.491,15.106l2.4-2.4a1,1,0,0,0,0-1.414l-2.4-2.4V5.5a1,1,0,0,0-1-1H15.1L12.7,2.1a1,1,0,0,0-1.414,0l-2.4,2.4H5.491a1,1,0,0,0-1,1V8.894l-2.4,2.4a1,1,0,0,0,0,1.414l2.4,2.4V18.5a1,1,0,0,0,1,1H8.885l2.4,2.4a1,1,0,0,0,1.414,0l2.4-2.4h3.394a1,1,0,0,0,1-1Z"}),t.createElement("path",{d:"M11.491,6c4,0,6,2.686,6,6s-2,6-6,6Z"}))},i=function(){return i=Object.assign||function(c){for(var d,f=1,p=arguments.length;f<p;f++)for(var g in d=arguments[f])Object.prototype.hasOwnProperty.call(d,g)&&(c[g]=d[g]);return c},i.apply(this,arguments)},s={left:0,top:8},o=function(c){var d=c.onClick,f=t.useContext(a.ThemeContext),p=t.useContext(a.LocalizationContext).l10n,g=f.currentTheme==="dark",h=p&&p.theme?g?p.theme.switchLightTheme:p.theme.switchDarkTheme:g?"Switch to the light theme":"Switch to the dark theme";return t.createElement(a.Tooltip,{ariaControlsSuffix:"theme-switch",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaLabel:h,testId:"theme__switch-button",onClick:d},g?t.createElement(r,null):t.createElement(n,null)),content:function(){return h},offset:s})},l=function(c){var d=c.children,f=t.useContext(a.ThemeContext);return(d||function(p){return t.createElement(o,{onClick:p.onClick})})({onClick:function(){return f.setCurrentTheme(f.currentTheme==="dark"?"light":"dark")}})},u=function(c){var d=c.onClick,f=t.useContext(a.ThemeContext),p=t.useContext(a.LocalizationContext).l10n,g=f.currentTheme==="dark",h=p&&p.theme?g?p.theme.switchLightTheme:p.theme.switchDarkTheme:g?"Switch to the light theme":"Switch to the dark theme";return t.createElement(a.MenuItem,{icon:g?t.createElement(r,null):t.createElement(n,null),testId:"theme__switch-menu",onClick:d},h)};return Ri.DarkIcon=n,Ri.LightIcon=r,Ri.themePlugin=function(){var c=function(d){return t.createElement(l,i({},d))};return{SwitchTheme:c,SwitchThemeButton:function(){return t.createElement(c,null,(function(d){return t.createElement(o,i({},d))}))},SwitchThemeMenuItem:function(d){return t.createElement(c,null,(function(f){return t.createElement(u,{onClick:function(){f.onClick(),d.onClick()}})}))}}},Ri}var Qa;function dd(){if(Qa)return hs.exports;Qa=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return hs.exports=hd(),hs.exports}var ds={exports:{}},Li={},eo;function fd(){if(eo)return Li;eo=1;var a=Yt();function e(y){var S=Object.create(null);return y&&Object.keys(y).forEach((function(L){if(L!=="default"){var N=Object.getOwnPropertyDescriptor(y,L);Object.defineProperty(S,L,N.get?N:{enumerable:!0,get:function(){return y[L]}})}})),S.default=y,Object.freeze(S)}var t=e(Kt()),n=function(){return t.createElement(a.Icon,{ignoreDirection:!0,size:16},t.createElement("path",{d:`M10.5,0.499c5.523,0,10,4.477,10,10s-4.477,10-10,10s-10-4.477-10-10S4.977,0.499,10.5,0.499z
            M23.5,23.499
            l-5.929-5.929
            M5.5,10.499h10
            M10.5,5.499v10`}))},r=function(){return t.createElement(a.Icon,{ignoreDirection:!0,size:16},t.createElement("path",{d:`M10.5,0.499c5.523,0,10,4.477,10,10s-4.477,10-10,10s-10-4.477-10-10S4.977,0.499,10.5,0.499z
            M23.5,23.499
            l-5.929-5.929
            M5.5,10.499h10`}))},i=function(){return i=Object.assign||function(y){for(var S,L=1,N=arguments.length;L<N;L++)for(var D in S=arguments[L])Object.prototype.hasOwnProperty.call(S,D)&&(y[D]=S[D]);return y},i.apply(this,arguments)},s=function(y){var S=t.useState(y.get("scale")||0),L=S[0],N=S[1],D=function(M){N(M)};return t.useEffect((function(){return y.subscribe("scale",D),function(){y.unsubscribe("scale",D)}}),[]),{scale:L}},o=function(y){var S=y.children,L=y.store;return(S||function(N){return t.createElement(t.Fragment,null,"".concat(Math.round(100*N.scale),"%"))})({scale:s(L).scale})},l={passive:!1},u=null,c=function(y){var S=y.pagesContainerRef,L=y.store,N=a.useDebounceCallback((function(M){var x=L.get("zoom");x&&x(M)}),40),D=function(M){if(M.ctrlKey){M.preventDefault();var x=M.target.getBoundingClientRect(),j=1-M.deltaY/100,U=M.clientX-x.left,J=M.clientY-x.top,Q=L.get("scale"),X=(u||(u=document.createElementNS("http://www.w3.org/2000/svg","svg"))).createSVGMatrix().translate(U,J).scale(j).translate(-U,-J).scale(Q);N(X.a)}};return a.useIsomorphicLayoutEffect((function(){var M=S.current;if(M)return M.addEventListener("wheel",D,l),function(){M.removeEventListener("wheel",D)}}),[]),t.createElement(t.Fragment,null)},d=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.3,1.5,1.7,1.9,2.1,2.4,2.7,3,3.3,3.7,4.1,4.6,5.1,5.7,6.3,7,7.7,8.5,9.4,10],f=function(y){return d.find((function(S){return S>y}))||y},p=function(y){var S=d.findIndex((function(L){return L>=y}));return S===-1||S===0?y:d[S-1]},g=function(y){var S=y.containerRef,L=y.store,N=function(D){if(!D.shiftKey&&!D.altKey&&(a.isMac()?D.metaKey:D.ctrlKey)){var M=S.current;if(M&&document.activeElement&&M.contains(document.activeElement)){var x=L.get("zoom");if(x){var j=L.get("scale")||1,U=1;switch(D.key){case"-":U=p(j);break;case"=":U=f(j);break;case"0":U=1;break;default:U=j}U!==j&&(D.preventDefault(),x(U))}}}};return t.useEffect((function(){if(S.current)return document.addEventListener("keydown",N),function(){document.removeEventListener("keydown",N)}}),[S.current]),t.createElement(t.Fragment,null)},h=[.5,.75,1,1.25,1.5,2,3,4],v={left:0,top:8},b=function(y){var S=y.levels,L=S===void 0?h:S,N=y.scale,D=y.onZoom,M=t.useContext(a.LocalizationContext).l10n,x=t.useContext(a.ThemeContext).direction===a.TextDirection.RightToLeft,j=M&&M.zoom?M.zoom.zoomDocument:"Zoom document";return t.createElement(a.Popover,{ariaControlsSuffix:"zoom",ariaHasPopup:"menu",position:a.Position.BottomCenter,target:function(U){return t.createElement(a.MinimalButton,{ariaLabel:j,testId:"zoom__popover-target",onClick:function(){U()}},t.createElement("span",{className:"rpv-zoom__popover-target"},t.createElement("span",{"data-testid":"zoom__popover-target-scale",className:a.classNames({"rpv-zoom__popover-target-scale":!0,"rpv-zoom__popover-target-scale--ltr":!x,"rpv-zoom__popover-target-scale--rtl":x})},Math.round(100*N),"%"),t.createElement("span",{className:"rpv-zoom__popover-target-arrow"})))},content:function(U){return t.createElement(a.Menu,null,Object.keys(a.SpecialZoomLevel).map((function(J){var Q=J;return t.createElement(a.MenuItem,{key:Q,onClick:function(){U(),D(Q)}},(function(X){switch(X){case a.SpecialZoomLevel.ActualSize:return M&&M.zoom?M.zoom.actualSize:"Actual size";case a.SpecialZoomLevel.PageFit:return M&&M.zoom?M.zoom.pageFit:"Page fit";case a.SpecialZoomLevel.PageWidth:return M&&M.zoom?M.zoom.pageWidth:"Page width"}})(Q))})),t.createElement(a.MenuDivider,null),L.map((function(J){return t.createElement(a.MenuItem,{key:J,onClick:function(){U(),D(J)}},"".concat(Math.round(100*J),"%"))})))},offset:v,closeOnClickOutside:!0,closeOnEscape:!0})},_=function(y){var S=y.children,L=y.levels,N=y.store;return(S||function(D){return t.createElement(b,{levels:L,scale:D.scale,onZoom:D.onZoom})})({scale:s(N).scale,onZoom:function(D){var M=N.get("zoom");M&&M(D)}})},C={left:0,top:8},E=function(y){var S=y.enableShortcuts,L=y.onClick,N=t.useContext(a.LocalizationContext).l10n,D=N&&N.zoom?N.zoom.zoomIn:"Zoom in",M=S?a.isMac()?"Meta+=":"Ctrl+=":"";return t.createElement(a.Tooltip,{ariaControlsSuffix:"zoom-in",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaKeyShortcuts:M,ariaLabel:D,testId:"zoom__in-button",onClick:L},t.createElement(n,null)),content:function(){return D},offset:C})},k=function(y){var S=y.children,L=y.enableShortcuts,N=y.store,D=s(N).scale;return(S||E)({enableShortcuts:L,onClick:function(){var M=N.get("zoom");M&&M(f(D))}})},H=function(y){var S=y.onClick,L=t.useContext(a.LocalizationContext).l10n,N=L&&L.zoom?L.zoom.zoomIn:"Zoom in";return t.createElement(a.MenuItem,{icon:t.createElement(n,null),testId:"zoom__in-menu",onClick:S},N)},T={left:0,top:8},A=function(y){var S=y.enableShortcuts,L=y.onClick,N=t.useContext(a.LocalizationContext).l10n,D=N&&N.zoom?N.zoom.zoomOut:"Zoom out",M=S?a.isMac()?"Meta+-":"Ctrl+-":"";return t.createElement(a.Tooltip,{ariaControlsSuffix:"zoom-out",position:a.Position.BottomCenter,target:t.createElement(a.MinimalButton,{ariaKeyShortcuts:M,ariaLabel:D,testId:"zoom__out-button",onClick:L},t.createElement(r,null)),content:function(){return D},offset:T})},B=function(y){var S=y.children,L=y.enableShortcuts,N=y.store,D=s(N).scale;return(S||A)({enableShortcuts:L,onClick:function(){var M=N.get("zoom");M&&M(p(D))}})},z=function(y){var S=y.onClick,L=t.useContext(a.LocalizationContext).l10n,N=L&&L.zoom?L.zoom.zoomOut:"Zoom out";return t.createElement(a.MenuItem,{icon:t.createElement(r,null),testId:"zoom__out-menu",onClick:S},N)};return Li.ZoomInIcon=n,Li.ZoomOutIcon=r,Li.zoomPlugin=function(y){var S=t.useMemo((function(){return Object.assign({},{enableShortcuts:!0},y)}),[]),L=t.useMemo((function(){return a.createStore({})}),[]),N=function(x){return t.createElement(k,i({enableShortcuts:S.enableShortcuts},x,{store:L}))},D=function(x){return t.createElement(B,i({enableShortcuts:S.enableShortcuts},x,{store:L}))},M=function(x){return t.createElement(_,i({},x,{store:L}))};return{renderViewer:function(x){var j=x.slot;if(!S.enableShortcuts)return j;var U={children:t.createElement(t.Fragment,null,t.createElement(g,{containerRef:x.containerRef,store:L}),t.createElement(c,{pagesContainerRef:x.pagesContainerRef,store:L}),j.children)};return i(i({},j),U)},install:function(x){L.update("zoom",x.zoom)},onViewerStateChange:function(x){return L.update("scale",x.scale),x},zoomTo:function(x){var j=L.get("zoom");j&&j(x)},CurrentScale:function(x){return t.createElement(o,i({},x,{store:L}))},ZoomIn:N,ZoomInButton:function(){return t.createElement(N,null,(function(x){return t.createElement(E,i({},x))}))},ZoomInMenuItem:function(x){return t.createElement(N,null,(function(j){return t.createElement(H,{onClick:function(){j.onClick(),x.onClick()}})}))},ZoomOut:D,ZoomOutButton:function(){return t.createElement(D,null,(function(x){return t.createElement(A,i({},x))}))},ZoomOutMenuItem:function(x){return t.createElement(D,null,(function(j){return t.createElement(z,{onClick:function(){j.onClick(),x.onClick()}})}))},Zoom:M,ZoomPopover:function(x){return t.createElement(M,null,(function(j){return t.createElement(b,i({levels:x?.levels},j))}))}}},Li}var to;function pd(){if(to)return ds.exports;to=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return ds.exports=fd(),ds.exports}var no;function gd(){if(no)return xi;no=1;var a=Yt(),e=Uh(),t=Kt(),n=Xh(),r=Yh(),i=Jh(),s=ed(),o=nd(),l=rd(),u=ad(),c=ld(),d=ud(),f=dd(),p=pd();function g(A){var B=Object.create(null);return A&&Object.keys(A).forEach((function(z){if(z!=="default"){var y=Object.getOwnPropertyDescriptor(A,z);Object.defineProperty(B,z,y.get?y:{enumerable:!0,get:function(){return A[z]}})}})),B.default=A,Object.freeze(B)}var h=g(t),v=function(){return h.createElement(a.Icon,{size:16},h.createElement("path",{d:`M12,0.5c1.381,0,2.5,1.119,2.5,2.5S13.381,5.5,12,5.5S9.5,4.381,9.5,3S10.619,0.5,12,0.5z
            M12,9.5
            c1.381,0,2.5,1.119,2.5,2.5s-1.119,2.5-2.5,2.5S9.5,13.381,9.5,12S10.619,9.5,12,9.5z
            M12,18.5c1.381,0,2.5,1.119,2.5,2.5
            s-1.119,2.5-2.5,2.5S9.5,22.381,9.5,21S10.619,18.5,12,18.5z`}))},b={left:0,top:8},_=function(A){var B=A.toolbarSlot,z=h.useContext(a.LocalizationContext).l10n,y=h.useContext(a.ThemeContext).direction===a.TextDirection.RightToLeft?a.Position.BottomLeft:a.Position.BottomRight,S=B.DownloadMenuItem,L=B.EnterFullScreenMenuItem,N=B.GoToFirstPageMenuItem,D=B.GoToLastPageMenuItem,M=B.GoToNextPageMenuItem,x=B.GoToPreviousPageMenuItem,j=B.OpenMenuItem,U=B.PrintMenuItem,J=B.RotateBackwardMenuItem,Q=B.RotateForwardMenuItem,X=B.ShowPropertiesMenuItem,q=B.SwitchScrollModeMenuItem,re=B.SwitchSelectionModeMenuItem,oe=B.SwitchViewModeMenuItem,Ae=B.SwitchThemeMenuItem;return h.createElement(a.Popover,{ariaControlsSuffix:"toolbar-more-actions",ariaHasPopup:"menu",position:y,target:function(te,Pe){var Be=z&&z.toolbar?z.toolbar.moreActions:"More actions";return h.createElement(a.Tooltip,{ariaControlsSuffix:"toolbar-more-actions",position:y,target:h.createElement(a.MinimalButton,{ariaLabel:Be,isSelected:Pe,testId:"toolbar__more-actions-popover-target",onClick:te},h.createElement(v,null)),content:function(){return Be},offset:b})},content:function(te){return h.createElement(a.Menu,null,h.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},h.createElement(Ae,{onClick:te})),h.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},h.createElement(L,{onClick:te})),h.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},h.createElement(j,null)),h.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},h.createElement(U,{onClick:te})),h.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},h.createElement(S,{onClick:te})),h.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},h.createElement(a.MenuDivider,null)),h.createElement(N,{onClick:te}),h.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},h.createElement(x,{onClick:te})),h.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},h.createElement(M,{onClick:te})),h.createElement(D,{onClick:te}),h.createElement(a.MenuDivider,null),h.createElement(Q,{onClick:te}),h.createElement(J,{onClick:te}),h.createElement(a.MenuDivider,null),h.createElement(re,{mode:e.SelectionMode.Text,onClick:te}),h.createElement(re,{mode:e.SelectionMode.Hand,onClick:te}),h.createElement(a.MenuDivider,null),h.createElement(q,{mode:a.ScrollMode.Page,onClick:te}),h.createElement(q,{mode:a.ScrollMode.Vertical,onClick:te}),h.createElement(q,{mode:a.ScrollMode.Horizontal,onClick:te}),h.createElement(q,{mode:a.ScrollMode.Wrapped,onClick:te}),h.createElement(a.MenuDivider,null),h.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-small"},h.createElement(oe,{mode:a.ViewMode.SinglePage,onClick:te})),h.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-small"},h.createElement(oe,{mode:a.ViewMode.DualPage,onClick:te})),h.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-small"},h.createElement(oe,{mode:a.ViewMode.DualPageWithCover,onClick:te})),h.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-small"},h.createElement(a.MenuDivider,null)),h.createElement(X,{onClick:te}))},offset:b,closeOnClickOutside:!0,closeOnEscape:!0})},C=function(){return C=Object.assign||function(A){for(var B,z=1,y=arguments.length;z<y;z++)for(var S in B=arguments[z])Object.prototype.hasOwnProperty.call(B,S)&&(A[S]=B[S]);return A},C.apply(this,arguments)},E=function(A){return function(B){var z=h.useMemo((function(){return A(B)}),[]),y=h.useContext(a.ThemeContext).direction===a.TextDirection.RightToLeft,S=z.CurrentPageInput,L=z.Download,N=z.EnterFullScreen,D=z.GoToNextPage,M=z.GoToPreviousPage,x=z.NumberOfPages,j=z.Open,U=z.Print,J=z.ShowSearchPopover,Q=z.SwitchTheme,X=z.Zoom,q=z.ZoomIn,re=z.ZoomOut;return h.createElement("div",{"data-testid":"toolbar",className:a.classNames({"rpv-toolbar":!0,"rpv-toolbar--rtl":y}),role:"toolbar","aria-orientation":"horizontal"},h.createElement("div",{className:"rpv-toolbar__left"},h.createElement("div",{className:"rpv-toolbar__item"},h.createElement(J,null)),h.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-small"},h.createElement("div",{className:"rpv-toolbar__item"},h.createElement(M,null))),h.createElement("div",{className:"rpv-toolbar__item"},h.createElement(S,null),h.createElement("span",{className:"rpv-toolbar__label"},h.createElement(x,null))),h.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-small"},h.createElement("div",{className:"rpv-toolbar__item"},h.createElement(D,null)))),h.createElement("div",{className:"rpv-toolbar__center"},h.createElement("div",{className:"rpv-toolbar__item"},h.createElement(re,null)),h.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-small"},h.createElement("div",{className:"rpv-toolbar__item"},h.createElement(X,null))),h.createElement("div",{className:"rpv-toolbar__item"},h.createElement(q,null))),h.createElement("div",{className:"rpv-toolbar__right"},h.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-medium"},h.createElement("div",{className:"rpv-toolbar__item"},h.createElement(Q,null))),h.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-medium"},h.createElement("div",{className:"rpv-toolbar__item"},h.createElement(N,null))),h.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-medium"},h.createElement("div",{className:"rpv-toolbar__item"},h.createElement(j,null))),h.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-medium"},h.createElement("div",{className:"rpv-toolbar__item"},h.createElement(L,null))),h.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-medium"},h.createElement("div",{className:"rpv-toolbar__item"},h.createElement(U,null))),h.createElement("div",{className:"rpv-toolbar__item"},h.createElement(_,{toolbarSlot:z}))))}},k=function(A){var B=A.NumberOfPages;return Object.assign({},A,{NumberOfPages:function(){return h.createElement(h.Fragment,null,"/ ",h.createElement(B,null))}})},H=function(A){return E(k)(A)},T=function(A){var B=A.children,z=A.slot;return(B||H)(z)};return xi.MoreActionsPopover=_,xi.MoreIcon=v,xi.toolbarPlugin=function(A){var B=n.fullScreenPlugin(A?A.fullScreenPlugin:{}),z=r.getFilePlugin(A?A.getFilePlugin:{}),y=i.openPlugin(A?A.openPlugin:{}),S=s.pageNavigationPlugin(A?A.pageNavigationPlugin:{}),L=o.printPlugin(A?A.printPlugin:{}),N=l.propertiesPlugin(),D=u.rotatePlugin(),M=c.scrollModePlugin(),x=d.searchPlugin(A?A.searchPlugin:{}),j=e.selectionModePlugin(A?A.selectionModePlugin:{}),U=f.themePlugin(),J=p.zoomPlugin(A?A.zoomPlugin:{}),Q=[B,z,y,S,L,N,D,M,x,j,U,J],X=h.useCallback((function(q){var re=B.EnterFullScreen,oe=B.EnterFullScreenMenuItem,Ae=z.Download,te=z.DownloadMenuItem,Pe=y.Open,Be=y.OpenMenuItem,it=S.CurrentPageInput,ft=S.CurrentPageLabel,Je=S.GoToFirstPage,pt=S.GoToFirstPageMenuItem,mt=S.GoToLastPage,Ut=S.GoToLastPageMenuItem,Tt=S.GoToNextPage,bt=S.GoToNextPageMenuItem,le=S.GoToPreviousPage,ce=S.GoToPreviousPageMenuItem,Ke=S.NumberOfPages,Ce=L.Print,_e=L.PrintMenuItem,Qe=N.ShowProperties,at=N.ShowPropertiesMenuItem,_t=D.Rotate,Pt=D.RotateBackwardMenuItem,gt=D.RotateForwardMenuItem,Rt=M.SwitchScrollMode,Nt=M.SwitchScrollModeMenuItem,Bt=M.SwitchViewMode,rt=M.SwitchViewModeMenuItem,fn=x.Search,vt=x.ShowSearchPopover,yn=j.SwitchSelectionMode,pn=j.SwitchSelectionModeMenuItem,Lt=U.SwitchTheme,It=U.SwitchThemeMenuItem,Qn=J.CurrentScale,Ge=J.Zoom,wt=J.ZoomIn,Vn=J.ZoomInMenuItem,Pn=J.ZoomOut,ei=J.ZoomOutMenuItem;return h.createElement(T,C({},q,{slot:{CurrentPageInput:it,CurrentPageLabel:ft,CurrentScale:Qn,Download:Ae,DownloadMenuItem:te,EnterFullScreen:re,EnterFullScreenMenuItem:oe,GoToFirstPage:Je,GoToFirstPageMenuItem:pt,GoToLastPage:mt,GoToLastPageMenuItem:Ut,GoToNextPage:Tt,GoToNextPageMenuItem:bt,GoToPreviousPage:le,GoToPreviousPageMenuItem:ce,NumberOfPages:Ke,Open:Pe,OpenMenuItem:Be,Print:Ce,PrintMenuItem:_e,Rotate:_t,RotateBackwardMenuItem:Pt,RotateForwardMenuItem:gt,Search:fn,ShowProperties:Qe,ShowPropertiesMenuItem:at,ShowSearchPopover:vt,SwitchScrollMode:Rt,SwitchScrollModeMenuItem:Nt,SwitchSelectionMode:yn,SwitchSelectionModeMenuItem:pn,SwitchViewMode:Bt,SwitchViewModeMenuItem:rt,SwitchTheme:Lt,SwitchThemeMenuItem:It,Zoom:Ge,ZoomIn:wt,ZoomInMenuItem:Vn,ZoomOut:Pn,ZoomOutMenuItem:ei}}))}),[]);return{fullScreenPluginInstance:B,getFilePluginInstance:z,openPluginInstance:y,pageNavigationPluginInstance:S,printPluginInstance:L,propertiesPluginInstance:N,rotatePluginInstance:D,scrollModePluginInstance:M,searchPluginInstance:x,selectionModePluginInstance:j,themePluginInstance:U,zoomPluginInstance:J,install:function(q){Q.forEach((function(re){re.install&&re.install(q)}))},renderPageLayer:function(q){return h.createElement(h.Fragment,null,Q.map((function(re,oe){return re.renderPageLayer?h.createElement(h.Fragment,{key:oe},re.renderPageLayer(q)):h.createElement(h.Fragment,{key:oe})})))},renderViewer:function(q){var re=q.slot;return Q.forEach((function(oe){oe.renderViewer&&(re=oe.renderViewer(C(C({},q),{slot:re})))})),re},uninstall:function(q){Q.forEach((function(re){re.uninstall&&re.uninstall(q)}))},onDocumentLoad:function(q){Q.forEach((function(re){re.onDocumentLoad&&re.onDocumentLoad(q)}))},onAnnotationLayerRender:function(q){Q.forEach((function(re){re.onAnnotationLayerRender&&re.onAnnotationLayerRender(q)}))},onTextLayerRender:function(q){Q.forEach((function(re){re.onTextLayerRender&&re.onTextLayerRender(q)}))},onViewerStateChange:function(q){var re=q;return Q.forEach((function(oe){oe.onViewerStateChange&&(re=oe.onViewerStateChange(re))})),re},renderDefaultToolbar:E,Toolbar:X}},xi}var io;function md(){if(io)return Qr.exports;io=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return Qr.exports=gd(),Qr.exports}var ro;function vd(){if(ro)return Gn;ro=1;var a=Yt(),e=Kt(),t=Hh(),n=Vh(),r=$h(),i=md();function s(h){var v=Object.create(null);return h&&Object.keys(h).forEach((function(b){if(b!=="default"){var _=Object.getOwnPropertyDescriptor(h,b);Object.defineProperty(v,b,_.get?_:{enumerable:!0,get:function(){return h[b]}})}})),v.default=h,Object.freeze(v)}var o=s(e),l=function(){return o.createElement(a.Icon,{size:16},o.createElement("path",{d:`M11.5,1.5h11c0.552,0,1,0.448,1,1v20c0,0.552-0.448,1-1,1h-21c-0.552,0-1-0.448-1-1v-20c0-0.552,0.448-1,1-1h3
            M11.5,10.5c0,0.55-0.3,0.661-0.659,0.248L8,7.5l-2.844,3.246c-0.363,0.414-0.659,0.3-0.659-0.247v-9c0-0.552,0.448-1,1-1h5
            c0.552,0,1,0.448,1,1L11.5,10.5z
            M14.5,6.499h6
            M14.5,10.499h6
            M3.5,14.499h17
            M3.5,18.499h16.497`}))},u=function(){return u=Object.assign||function(h){for(var v,b=1,_=arguments.length;b<_;b++)for(var C in v=arguments[b])Object.prototype.hasOwnProperty.call(v,C)&&(h[C]=v[C]);return h},u.apply(this,arguments)},c=function(){return o.createElement(a.Icon,{size:16},o.createElement("path",{d:`M7.618,15.345l8.666-8.666c0.78-0.812,2.071-0.838,2.883-0.058s0.838,2.071,0.058,2.883
            c-0.019,0.02-0.038,0.039-0.058,0.058L7.461,21.305c-1.593,1.593-4.175,1.592-5.767,0s-1.592-4.175,0-5.767c0,0,0,0,0,0
            L13.928,3.305c2.189-2.19,5.739-2.19,7.929-0.001s2.19,5.739,0,7.929l0,0L13.192,19.9`}))},d=function(){return o.createElement(a.Icon,{size:16},o.createElement("path",{d:`M10.5,9.5c0,0.552-0.448,1-1,1h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V9.5z
            M23.5,9.5c0,0.552-0.448,1-1,1h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V9.5z
            M10.5,22.5 c0,0.552-0.448,1-1,1h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V22.5z
            M23.5,22.5c0,0.552-0.448,1-1,1 h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V22.5z`}))},f={left:8,top:0},p={left:-8,top:0},g=function(h){var v=h.attachmentTabContent,b=h.bookmarkTabContent,_=h.store,C=h.thumbnailTabContent,E=h.tabs,k=o.useRef(),H=o.useContext(a.LocalizationContext).l10n,T=o.useState(_.get("isCurrentTabOpened")||!1),A=T[0],B=T[1],z=o.useState(Math.max(_.get("currentTab")||0,0)),y=z[0],S=z[1],L=o.useContext(a.ThemeContext).direction===a.TextDirection.RightToLeft,N=[{content:C,icon:o.createElement(d,null),title:H&&H.defaultLayout?H.defaultLayout.thumbnail:"Thumbnail"},{content:b,icon:o.createElement(l,null),title:H&&H.defaultLayout?H.defaultLayout.bookmark:"Bookmark"},{content:v,icon:o.createElement(c,null),title:H&&H.defaultLayout?H.defaultLayout.attachment:"Attachment"}],D=E?E(N):N,M=function(j){j>=0&&j<=D.length-1&&(_.update("isCurrentTabOpened",!0),S(j))},x=function(j){B(j)};return o.useEffect((function(){return _.subscribe("currentTab",M),_.subscribe("isCurrentTabOpened",x),function(){_.unsubscribe("currentTab",M),_.unsubscribe("isCurrentTabOpened",x)}}),[]),D.length===0?o.createElement(o.Fragment,null):o.createElement(o.Fragment,null,o.createElement("div",{"data-testid":"default-layout__sidebar",className:a.classNames({"rpv-default-layout__sidebar":!0,"rpv-default-layout__sidebar--opened":A,"rpv-default-layout__sidebar--ltr":!L,"rpv-default-layout__sidebar--rtl":L}),ref:k},o.createElement("div",{className:"rpv-default-layout__sidebar-tabs"},o.createElement("div",{className:"rpv-default-layout__sidebar-headers",role:"tablist","aria-orientation":"vertical"},D.map((function(j,U){return o.createElement("div",{"aria-controls":"rpv-default-layout__sidebar-content","aria-selected":y===U,key:U,className:"rpv-default-layout__sidebar-header",id:"rpv-default-layout__sidebar-tab-".concat(U),role:"tab"},o.createElement(a.Tooltip,{ariaControlsSuffix:"default-layout-sidebar-tab-".concat(U),position:L?a.Position.LeftCenter:a.Position.RightCenter,target:o.createElement(a.MinimalButton,{ariaLabel:j.title,isSelected:y===U,onClick:function(){return(function(J){if(y===J){_.update("isCurrentTabOpened",!_.get("isCurrentTabOpened"));var Q=k.current;Q&&Q.style.width&&Q.style.removeProperty("width")}else _.update("currentTab",J)})(U)}},j.icon),content:function(){return j.title},offset:L?p:f}))}))),o.createElement("div",{"aria-labelledby":"rpv-default-layout__sidebar-tab-".concat(y),id:"rpv-default-layout__sidebar-content",className:a.classNames({"rpv-default-layout__sidebar-content":!0,"rpv-default-layout__sidebar-content--opened":A,"rpv-default-layout__sidebar-content--ltr":!L,"rpv-default-layout__sidebar-content--rtl":L}),role:"tabpanel",tabIndex:-1},D[y].content))),A&&o.createElement(a.Splitter,{constrain:function(j){return j.firstHalfPercentage>=20&&j.firstHalfPercentage<=80}}))};return Gn.BookmarkIcon=l,Gn.FileIcon=c,Gn.ThumbnailIcon=d,Gn.defaultLayoutPlugin=function(h){var v=o.useMemo((function(){return a.createStore({isCurrentTabOpened:!1,currentTab:0})}),[]),b=t.attachmentPlugin(),_=n.bookmarkPlugin(),C=r.thumbnailPlugin(h?h.thumbnailPlugin:{}),E=i.toolbarPlugin(h?h.toolbarPlugin:{}),k=b.Attachments,H=_.Bookmarks,T=C.Thumbnails,A=E.Toolbar,B=h?h.sidebarTabs:function(y){return y},z=[b,_,C,E];return{attachmentPluginInstance:b,bookmarkPluginInstance:_,thumbnailPluginInstance:C,toolbarPluginInstance:E,activateTab:function(y){v.update("currentTab",y)},toggleTab:function(y){var S=v.get("currentTab");v.update("isCurrentTabOpened",!v.get("isCurrentTabOpened")),S!==y&&v.update("currentTab",y)},install:function(y){z.forEach((function(S){S.install&&S.install(y)}))},renderPageLayer:function(y){return o.createElement(o.Fragment,null,z.map((function(S,L){return S.renderPageLayer?o.createElement(o.Fragment,{key:L},S.renderPageLayer(y)):o.createElement(o.Fragment,{key:L},o.createElement(o.Fragment,null))})))},renderViewer:function(y){var S=y.slot;z.forEach((function(N){N.renderViewer&&(S=N.renderViewer(u(u({},y),{slot:S})))}));var L=S.subSlot&&S.subSlot.attrs?{className:S.subSlot.attrs.className,"data-testid":S.subSlot.attrs["data-testid"],ref:S.subSlot.attrs.ref,style:S.subSlot.attrs.style}:{};return S.children=o.createElement("div",{className:"rpv-default-layout__container"},o.createElement("div",{"data-testid":"default-layout__main",className:a.classNames({"rpv-default-layout__main":!0,"rpv-default-layout__main--rtl":y.themeContext.direction===a.TextDirection.RightToLeft})},o.createElement(g,{attachmentTabContent:o.createElement(k,null),bookmarkTabContent:o.createElement(H,null),store:v,thumbnailTabContent:o.createElement(T,null),tabs:B}),o.createElement("div",{className:"rpv-default-layout__body","data-testid":"default-layout__body"},o.createElement("div",{className:"rpv-default-layout__toolbar"},h&&h.renderToolbar?h.renderToolbar(A):o.createElement(A,null)),o.createElement("div",u({},L),S.subSlot.children))),S.children),S.subSlot.attrs={},S.subSlot.children=o.createElement(o.Fragment,null),S},uninstall:function(y){z.forEach((function(S){S.uninstall&&S.uninstall(y)}))},onDocumentLoad:function(y){z.forEach((function(S){S.onDocumentLoad&&S.onDocumentLoad(y)})),h&&h.setInitialTab&&h.setInitialTab(y.doc).then((function(S){v.update("currentTab",S),v.update("isCurrentTabOpened",!0)}))},onAnnotationLayerRender:function(y){z.forEach((function(S){S.onAnnotationLayerRender&&S.onAnnotationLayerRender(y)}))},onTextLayerRender:function(y){z.forEach((function(S){S.onTextLayerRender&&S.onTextLayerRender(y)}))},onViewerStateChange:function(y){var S=y;return z.forEach((function(L){L.onViewerStateChange&&(S=L.onViewerStateChange(S))})),S}}},Gn.setInitialTabFromPageMode=function(h){return new Promise((function(v,b){h.getPageMode().then((function(_){if(_)switch(_){case a.PageMode.Attachments:v(2);break;case a.PageMode.Bookmarks:v(1);break;case a.PageMode.Thumbnails:v(0);break;default:v(-1)}else v(-1)}))}))},Gn}var so;function bd(){if(so)return qr.exports;so=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return qr.exports=vd(),qr.exports}var _d=bd();const wd="https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.mjs";function Cd({open:a,onOpenChange:e,pdfUrl:t,fileName:n}){const[r,i]=Nr.useState(!0),[s,o]=Nr.useState(null),l=_d.defaultLayoutPlugin();return Nr.useEffect(()=>{a&&(i(!0),o(null))},[a]),St.jsx(zl,{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:42",open:a,onOpenChange:e,children:St.jsxs(Hl,{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:43",className:"max-w-6xl max-h-[95vh] h-[90vh] overflow-hidden flex flex-col p-0",children:[St.jsx(jl,{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:44",className:"px-5 md:px-7 pt-5 md:pt-6 pb-3 shrink-0 border-b",children:St.jsx("div",{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:45",className:"flex items-center justify-between",children:St.jsxs("div",{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:46",className:"flex items-center gap-3",children:[St.jsx("div",{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:47",className:"p-2 rounded-lg bg-muted",children:St.jsx(ia,{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:48",className:"h-5 w-5"})}),St.jsxs("div",{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:50",children:[St.jsx(Vl,{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:51",className:"text-base",children:"PDF Preview"}),St.jsx(Wl,{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:52",className:"text-xs",children:n||"Invoice PDF document"})]})]})})}),St.jsx($l,{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:60",className:"flex-1 overflow-hidden p-0",spacing:"compact",children:St.jsx("div",{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:61",className:"h-full flex flex-col",children:St.jsx(Ca.Worker,{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:62",workerUrl:wd,children:St.jsx(Ca.Viewer,{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:63",fileUrl:t,plugins:[l],onDocumentLoad:()=>{i(!1)},theme:"light"})})})}),r&&St.jsx("div",{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:76",className:"absolute inset-0 bg-background/80 flex items-center justify-center z-10",children:St.jsxs("div",{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:77",className:"flex flex-col items-center gap-3",children:[St.jsx(Gl,{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:78",className:"h-8 w-8 animate-spin text-primary"}),St.jsx("p",{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:79",className:"text-sm text-muted-foreground",children:"Loading PDF..."})]})}),s&&St.jsx("div",{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:85",className:"absolute inset-0 bg-background/90 flex items-center justify-center z-10",children:St.jsxs("div",{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:86",className:"flex flex-col items-center gap-3 text-center px-4",children:[St.jsx("div",{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:87",className:"p-3 rounded-full bg-destructive/10",children:St.jsx(ia,{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:88",className:"h-6 w-6 text-destructive"})}),St.jsx("p",{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:90",className:"text-sm text-destructive font-medium",children:s}),St.jsx("p",{"data-loc":"client/src/components/pdf/PDFViewerModal.tsx:91",className:"text-xs text-muted-foreground",children:"Please try downloading the PDF instead"})]})})]})})}export{Cd as P};
