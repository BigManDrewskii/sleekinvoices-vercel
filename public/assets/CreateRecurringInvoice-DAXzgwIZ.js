import{r as c,j as e}from"./vendor-react-BuVtq312.js";import{u as J,t as K,C as l,z as d,A as u,E as g,a as x,I as C,B as I,k as p}from"./index-hzFfJlKH.js";import{L as o}from"./label-DJDGx5UM.js";import{T as X}from"./textarea-CA7ezKjn.js";import{S as Z,a as $,b as ee,c as te,d as D}from"./select-BmfPitD4.js";import{P as ce}from"./PageLayout-D7c6YbGr.js";import{C as ae,L as re,I as se}from"./InvoiceFormCalculations-YZzX9-IS.js";import{a8 as ne,z as ie}from"./vendor-icons-CPPAmKDz.js";import"./vendor-data-DopHG4T0.js";import"./vendor-radix-DQBG9U-J.js";import"./Navigation-DKoTJDrW.js";import"./UserAvatar-DzPpP9tb.js";import"./ClientDialog-Ch_MRpgo.js";import"./checkbox-Cacebbmr.js";import"./typography-CdqW54LS.js";import"./vendor-date-B2OJh1lx.js";function Ne(){const[,R]=J(),[j,q]=c.useState(),[S,F]=c.useState("monthly"),[b,k]=c.useState(new Date().toISOString().split("T")[0]),[y,V]=c.useState(""),[T,E]=c.useState("INV"),[s,f]=c.useState([{id:crypto.randomUUID(),description:"",quantity:1,rate:0}]),[v,M]=c.useState(0),[m,U]=c.useState("percentage"),[i,z]=c.useState(0),[P,B]=c.useState(""),[A,O]=c.useState("Net 30"),n={invoiceNumberPrefix:c.useId(),startDate:c.useId(),endDate:c.useId(),paymentTerms:c.useId(),notes:c.useId()},N=K.recurringInvoices.create.useMutation(),h=c.useMemo(()=>{const t=s.reduce((G,L)=>G+L.quantity*L.rate,0);let a=0;i>0&&(m==="percentage"?a=t*i/100:a=i);const r=t-a,w=r*v/100,_=r+w;return{subtotal:t,discountAmount:a,taxAmount:w,total:_}},[s,v,m,i]),H=()=>{f([...s,{id:crypto.randomUUID(),description:"",quantity:1,rate:0}])},Q=t=>{if(s.length===1){p.error("At least one line item is required");return}f(s.filter((a,r)=>r!==t))},W=(t,a)=>{const r=[...s];r[t]=a,f(r)},Y=async t=>{if(t.preventDefault(),!j){p.error("Please select a client");return}if(s.some(a=>!a.description||a.quantity<=0||a.rate<=0)){p.error("Please fill in all line items");return}try{await N.mutateAsync({clientId:j,frequency:S,startDate:new Date(b),endDate:y?new Date(y):void 0,invoiceNumberPrefix:T,lineItems:s.map(({id:a,...r})=>r),taxRate:v,discountType:m,discountValue:i,notes:P,paymentTerms:A}),p.success("Recurring invoice created successfully"),R("/recurring-invoices")}catch{p.error("Failed to create recurring invoice")}};return e.jsx(ce,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:145",title:"Create Recurring Invoice",subtitle:"Set up automatic invoice generation",narrow:!0,headerActions:e.jsxs(I,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:150",variant:"ghost",onClick:()=>R("/recurring-invoices"),children:[e.jsx(ie,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:154",className:"w-4 h-4 mr-2"}),"Back"]}),children:e.jsxs("form",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:159",onSubmit:Y,className:"space-y-6",children:[e.jsxs(l,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:160",children:[e.jsxs(d,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:161",children:[e.jsx(u,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:162",children:"Schedule Settings"}),e.jsx(g,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:163",children:"Configure how often this invoice should be generated and sent"})]}),e.jsx(x,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:167",className:"space-y-4",children:e.jsxs("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:168",className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:169",className:"space-y-2",children:[e.jsx(o,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:170",htmlFor:"frequency",children:"Frequency"}),e.jsxs(Z,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:171",value:S,onValueChange:t=>F(t),children:[e.jsx($,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:175",children:e.jsx(ee,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:176",placeholder:"Select frequency"})}),e.jsxs(te,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:178",children:[e.jsx(D,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:179",value:"weekly",children:"Weekly"}),e.jsx(D,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:180",value:"monthly",children:"Monthly"}),e.jsx(D,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:181",value:"yearly",children:"Yearly"})]})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:186",className:"space-y-2",children:[e.jsx(o,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:187",htmlFor:n.invoiceNumberPrefix,children:"Invoice Number Prefix"}),e.jsx(C,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:190",id:n.invoiceNumberPrefix,value:T,onChange:t=>E(t.target.value),placeholder:"INV",required:!0})]}),e.jsxs("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:199",className:"space-y-2",children:[e.jsx(o,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:200",htmlFor:n.startDate,children:"Start Date"}),e.jsx(C,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:201",id:n.startDate,type:"date",value:b,onChange:t=>k(t.target.value),required:!0})]}),e.jsxs("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:210",className:"space-y-2",children:[e.jsx(o,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:211",htmlFor:n.endDate,children:"End Date (Optional)"}),e.jsx(C,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:212",id:n.endDate,type:"date",value:y,onChange:t=>V(t.target.value),placeholder:"Leave blank for no end date"})]})]})})]}),e.jsxs(l,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:224",children:[e.jsxs(d,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:225",children:[e.jsx(u,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:226",children:"Client"}),e.jsx(g,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:227",children:"Select the client who will receive these recurring invoices"})]}),e.jsx(x,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:231",children:e.jsx(ae,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:232",value:j??null,onChange:t=>q(t??void 0)})})]}),e.jsxs(l,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:239",children:[e.jsx(d,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:240",children:e.jsxs("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:241",className:"flex items-center justify-between",children:[e.jsxs("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:242",children:[e.jsx(u,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:243",children:"Line Items"}),e.jsx(g,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:244",children:"Products or services to include on each invoice"})]}),e.jsxs(I,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:248",type:"button",variant:"outline",size:"sm",onClick:H,children:[e.jsx(ne,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:254",className:"w-4 h-4 mr-2"}),"Add Item"]})]})}),e.jsxs(x,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:259",className:"space-y-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:260",className:"hidden md:grid grid-cols-12 gap-4 text-sm font-medium text-muted-foreground pb-2 border-b",children:[e.jsx("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:261",className:"col-span-5",children:"Description"}),e.jsx("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:262",className:"col-span-2",children:"Quantity"}),e.jsx("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:263",className:"col-span-2",children:"Rate"}),e.jsx("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:264",className:"col-span-2 text-right",children:"Amount"}),e.jsx("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:265",className:"col-span-1"})]}),e.jsx("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:268",className:"space-y-3",children:s.map((t,a)=>e.jsx(re,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:270",item:t,onChange:r=>W(a,r),onDelete:()=>Q(a),canDelete:s.length>1},t.id))})]})]}),e.jsxs(l,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:284",children:[e.jsxs(d,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:285",children:[e.jsx(u,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:286",children:"Totals"}),e.jsx(g,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:287",children:"Tax, discounts, and calculations for each invoice"})]}),e.jsx(x,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:291",children:e.jsx(se,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:292",subtotal:h.subtotal,taxRate:v,onTaxRateChange:M,discountType:m,onDiscountTypeChange:U,discountValue:i,onDiscountValueChange:z,discountAmount:h.discountAmount,taxAmount:h.taxAmount,total:h.total})})]}),e.jsxs(l,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:307",children:[e.jsxs(d,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:308",children:[e.jsx(u,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:309",children:"Additional Information"}),e.jsx(g,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:310",children:"Payment terms and notes to include on each invoice"})]}),e.jsxs(x,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:314",className:"space-y-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:315",className:"space-y-2",children:[e.jsx(o,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:316",htmlFor:n.paymentTerms,children:"Payment Terms"}),e.jsx(C,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:317",id:n.paymentTerms,value:A,onChange:t=>O(t.target.value),placeholder:"Net 30"})]}),e.jsxs("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:325",className:"space-y-2",children:[e.jsx(o,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:326",htmlFor:n.notes,children:"Notes"}),e.jsx(X,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:327",id:n.notes,value:P,onChange:t=>B(t.target.value),placeholder:"Additional notes for the invoice...",rows:3})]})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:338",className:"flex gap-3 pt-4",children:[e.jsx(I,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:339",type:"submit",disabled:N.isPending,children:N.isPending?"Creating...":"Create Recurring Invoice"}),e.jsx(I,{"data-loc":"client/src/pages/CreateRecurringInvoice.tsx:344",type:"button",variant:"outline",onClick:()=>R("/recurring-invoices"),children:"Cancel"})]})]})})}export{Ne as default};
