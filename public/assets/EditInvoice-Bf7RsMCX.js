import{j as e}from"./vendor-react-BuVtq312.js";import{b as y,u as j,y as b,t as n,k as l,g as N,L as m,B as p}from"./index-hzFfJlKH.js";import{N as D}from"./Navigation-DKoTJDrW.js";import{I as T}from"./PageSkeletons-DirSuB2s.js";import{g as L,I as S}from"./InvoiceForm-CZ6zX-SZ.js";import"./InvoiceFormCalculations-YZzX9-IS.js";import"./vendor-data-DopHG4T0.js";import"./vendor-radix-DQBG9U-J.js";import"./vendor-icons-CPPAmKDz.js";import"./UserAvatar-DzPpP9tb.js";import"./skeleton-QN8DVCY2.js";import"./PageLayout-D7c6YbGr.js";import"./label-DJDGx5UM.js";import"./textarea-CA7ezKjn.js";import"./select-BmfPitD4.js";import"./popover-BWvbcDDZ.js";import"./scroll-area-Dr7k8mI2.js";import"./CurrencySelector-CmxErqHw.js";import"./tabs-Bgk-_Zyf.js";import"./index.browser-OxPLOBIU.js";import"./ClientDialog-Ch_MRpgo.js";import"./checkbox-Cacebbmr.js";import"./typography-CdqW54LS.js";import"./vendor-date-B2OJh1lx.js";function _(){const{loading:u,isAuthenticated:c}=y(),[,o]=j(),x=b(),s=parseInt(x.id||"0"),{data:a,isLoading:v}=n.invoices.get.useQuery({id:s},{enabled:c&&s>0}),r=n.useUtils(),d=n.invoices.update.useMutation({onSuccess:()=>{l.success("Invoice updated successfully"),r.invoices.list.invalidate(),r.invoices.get.invalidate({id:s}),o(`/invoices/${s}`)},onError:t=>{l.error(t.message||"Failed to update invoice")}}),I=async(t,E)=>{d.mutate({id:s,clientId:t.clientId,status:E,issueDate:t.issueDate,dueDate:t.dueDate,lineItems:t.lineItems,taxRate:t.taxRate,discountType:t.discountType,discountValue:t.discountValue,notes:t.notes,paymentTerms:t.paymentTerms,templateId:t.templateId})};if(u||v)return e.jsx(T,{"data-loc":"client/src/pages/EditInvoice.tsx:62"});if(!c)return window.location.href=N(),null;if(!a)return e.jsx("div",{"data-loc":"client/src/pages/EditInvoice.tsx:72",className:"min-h-screen bg-background",children:e.jsxs("div",{"data-loc":"client/src/pages/EditInvoice.tsx:73",className:"container mx-auto px-4 md:px-6 py-12 md:py-16 text-center",children:[e.jsx("h1",{"data-loc":"client/src/pages/EditInvoice.tsx:74",className:"text-2xl font-bold text-foreground mb-4",children:"Invoice Not Found"}),e.jsx(m,{"data-loc":"client/src/pages/EditInvoice.tsx:77",href:"/invoices",children:e.jsx(p,{"data-loc":"client/src/pages/EditInvoice.tsx:78",children:"Back to Invoices"})})]})});const{invoice:i,lineItems:g}=a,h={clientId:i.clientId,issueDate:new Date(i.issueDate).toISOString().split("T")[0],dueDate:new Date(i.dueDate).toISOString().split("T")[0],taxRate:parseFloat(i.taxRate),discountType:i.discountType,discountValue:parseFloat(i.discountValue),notes:i.notes||"",paymentTerms:i.paymentTerms||"",currency:i.currency||"USD",templateId:i.templateId||null},f=g.map(t=>({...L(),description:t.description,quantity:parseFloat(t.quantity),rate:parseFloat(t.rate)}));return e.jsxs("div",{"data-loc":"client/src/pages/EditInvoice.tsx:108",className:"min-h-screen bg-background",children:[e.jsx(D,{"data-loc":"client/src/pages/EditInvoice.tsx:109"}),e.jsx("div",{"data-loc":"client/src/pages/EditInvoice.tsx:111",className:"container mx-auto px-4 py-8",children:e.jsxs("div",{"data-loc":"client/src/pages/EditInvoice.tsx:112",className:"max-w-4xl mx-auto",children:[e.jsxs("div",{"data-loc":"client/src/pages/EditInvoice.tsx:113",className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{"data-loc":"client/src/pages/EditInvoice.tsx:114",children:[e.jsx("h1",{"data-loc":"client/src/pages/EditInvoice.tsx:115",className:"text-3xl font-bold text-foreground",children:"Edit Invoice"}),e.jsxs("p",{"data-loc":"client/src/pages/EditInvoice.tsx:118",className:"text-muted-foreground",children:["Update invoice ",i.invoiceNumber]})]}),e.jsx(m,{"data-loc":"client/src/pages/EditInvoice.tsx:122",href:`/invoices/${s}`,children:e.jsx(p,{"data-loc":"client/src/pages/EditInvoice.tsx:123",variant:"outline",children:"Cancel"})})]}),e.jsx(S,{"data-loc":"client/src/pages/EditInvoice.tsx:127",mode:"edit",initialData:h,lineItems:f,invoiceNumber:i.invoiceNumber,onSubmit:I,onCancel:()=>o(`/invoices/${s}`),isLoading:d.isPending})]})})]})}export{_ as default};
